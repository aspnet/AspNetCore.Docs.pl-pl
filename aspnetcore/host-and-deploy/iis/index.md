---
title: ASP.NET Core hosta w systemie Windows z usługami IIS
author: rick-anderson
description: Dowiedz się, jak hostować ASP.NET Core aplikacje w systemie Windows Server Internet Information Services (IIS).
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 5/7/2020
no-loc:
- 'appsettings.json'
- 'ASP.NET Core Identity'
- 'cookie'
- 'Cookie'
- 'Blazor'
- 'Blazor Server'
- 'Blazor WebAssembly'
- 'Identity'
- "Let's Encrypt"
- 'Razor'
- 'SignalR'
uid: host-and-deploy/iis/index
ms.openlocfilehash: e4a94ca9e3607868f3eb25d88338e8156f7f5206
ms.sourcegitcommit: ca34c1ac578e7d3daa0febf1810ba5fc74f60bbf
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/30/2020
ms.locfileid: "93061525"
---
# <a name="host-aspnet-core-on-windows-with-iis"></a><span data-ttu-id="88a89-103">ASP.NET Core hosta w systemie Windows z usługami IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-103">Host ASP.NET Core on Windows with IIS</span></span>

::: moniker range=">= aspnetcore-5.0"

<span data-ttu-id="88a89-104">Internet Information Services (IIS) to elastyczny, bezpieczny i zarządzany serwer sieci Web do hostowania aplikacji sieci Web, w tym ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-104">Internet Information Services (IIS) is a flexible, secure and manageable Web Server for hosting web apps, including ASP.NET Core.</span></span>

## <a name="supported-platforms"></a><span data-ttu-id="88a89-105">Obsługiwane platformy</span><span class="sxs-lookup"><span data-stu-id="88a89-105">Supported platforms</span></span>

<span data-ttu-id="88a89-106">Obsługiwane są następujące systemy operacyjne:</span><span class="sxs-lookup"><span data-stu-id="88a89-106">The following operating systems are supported:</span></span>

* <span data-ttu-id="88a89-107">System Windows 7 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="88a89-107">Windows 7 or later</span></span>
* <span data-ttu-id="88a89-108">System Windows Server 2012 R2 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="88a89-108">Windows Server 2012 R2 or later</span></span>

<span data-ttu-id="88a89-109">Obsługiwane są aplikacje opublikowane dla wdrożenia 32-bitowego (x86) lub 64-bitowego (x64).</span><span class="sxs-lookup"><span data-stu-id="88a89-109">Apps published for 32-bit (x86) or 64-bit (x64) deployment are supported.</span></span> <span data-ttu-id="88a89-110">Wdróż aplikację 32-bitową z 32-bitową (x86) zestaw .NET Core SDK, chyba że aplikacja:</span><span class="sxs-lookup"><span data-stu-id="88a89-110">Deploy a 32-bit app with a 32-bit (x86) .NET Core SDK unless the app:</span></span>

* <span data-ttu-id="88a89-111">Wymagana jest większa przestrzeń adresów pamięci wirtualnej dla aplikacji 64-bitowej.</span><span class="sxs-lookup"><span data-stu-id="88a89-111">Requires the larger virtual memory address space available to a 64-bit app.</span></span>
* <span data-ttu-id="88a89-112">Wymaga większego rozmiaru stosu IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-112">Requires the larger IIS stack size.</span></span>
* <span data-ttu-id="88a89-113">Ma 64-bitowe zależności natywne.</span><span class="sxs-lookup"><span data-stu-id="88a89-113">Has 64-bit native dependencies.</span></span>

## <a name="install-the-aspnet-core-modulehosting-bundle"></a><span data-ttu-id="88a89-114">Instalowanie ASP.NET Core Module/Host</span><span class="sxs-lookup"><span data-stu-id="88a89-114">Install the ASP.NET Core Module/Hosting Bundle</span></span>

<span data-ttu-id="88a89-115">Pobierz instalatora przy użyciu następującego linku:</span><span class="sxs-lookup"><span data-stu-id="88a89-115">Download the installer using the following link:</span></span>

[<span data-ttu-id="88a89-116">Bieżący Instalator pakietu hostingu platformy .NET Core (Pobieranie bezpośrednie)</span><span class="sxs-lookup"><span data-stu-id="88a89-116">Current .NET Core Hosting Bundle installer (direct download)</span></span>](https://dotnet.microsoft.com/permalink/dotnetcore-current-windows-runtime-bundle-installer)

<span data-ttu-id="88a89-117">Aby uzyskać szczegółowe informacje na temat sposobu instalowania modułu ASP.NET Core lub instalowania różnych wersji, zobacz Instalowanie zestawu [hostingu platformy .NET Core](xref:host-and-deploy/iis/hosting-bundle).</span><span class="sxs-lookup"><span data-stu-id="88a89-117">For more details instructions on how to install the ASP.NET Core Module, or installing different versions, see [Install the .NET Core Hosting Bundle](xref:host-and-deploy/iis/hosting-bundle).</span></span>

## <a name="get-started"></a><span data-ttu-id="88a89-118">Rozpoczęcie pracy</span><span class="sxs-lookup"><span data-stu-id="88a89-118">Get started</span></span>

<span data-ttu-id="88a89-119">Aby rozpocząć pracę z witryną sieci Web w usługach IIS, zobacz nasz [Przewodnik wprowadzający](xref:tutorials/publish-to-iis).</span><span class="sxs-lookup"><span data-stu-id="88a89-119">For getting started with hosting a website on IIS, see our [getting started guide](xref:tutorials/publish-to-iis).</span></span>

<span data-ttu-id="88a89-120">Aby rozpocząć pracę z witryną sieci Web w usłudze Azure App Services, zapoznaj się z artykułem [wdrażanie do Azure App Service przewodnika](xref:host-and-deploy/azure-apps/index).</span><span class="sxs-lookup"><span data-stu-id="88a89-120">For getting started with hosting a website on Azure App Services, see our [deploying to Azure App Service guide](xref:host-and-deploy/azure-apps/index).</span></span>

## <a name="deployment-resources-for-iis-administrators"></a><span data-ttu-id="88a89-121">Zasoby wdrażania dla administratorów usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-121">Deployment resources for IIS administrators</span></span>

* [<span data-ttu-id="88a89-122">Dokumentacja usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-122">IIS documentation</span></span>](/iis)
* [<span data-ttu-id="88a89-123">Wprowadzenie z menedżerem usług IIS w usługach IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-123">Getting Started with the IIS Manager in IIS</span></span>](/iis/get-started/getting-started-with-iis/getting-started-with-the-iis-manager-in-iis-7-and-iis-8)
* [<span data-ttu-id="88a89-124">Wdrażanie aplikacji .NET Core</span><span class="sxs-lookup"><span data-stu-id="88a89-124">.NET Core application deployment</span></span>](/dotnet/core/deploying/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/directory-structure>
* <xref:host-and-deploy/iis/modules>
* <xref:test/troubleshoot-azure-iis>
* <xref:host-and-deploy/azure-iis-errors-reference>

## <a name="additional-resources"></a><span data-ttu-id="88a89-125">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="88a89-125">Additional resources</span></span>

* <xref:test/troubleshoot>
* <xref:index>
* [<span data-ttu-id="88a89-126">Oficjalna witryna programu Microsoft IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-126">The Official Microsoft IIS Site</span></span>](https://www.iis.net/)
* [<span data-ttu-id="88a89-127">Biblioteka zawartości technicznej systemu Windows Server</span><span class="sxs-lookup"><span data-stu-id="88a89-127">Windows Server technical content library</span></span>](/windows-server/windows-server)
* [<span data-ttu-id="88a89-128">Protokół HTTP/2 w usługach IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-128">HTTP/2 on IIS</span></span>](/iis/get-started/whats-new-in-iis-10/http2-on-iis)
* <xref:host-and-deploy/iis/transform-webconfig>

::: moniker-end

::: moniker range=">= aspnetcore-3.0 < aspnetcore-5.0"

<span data-ttu-id="88a89-129">Aby zapoznać się z samouczkiem dotyczącym publikowania aplikacji ASP.NET Core na serwerze usług IIS, zobacz <xref:tutorials/publish-to-iis> .</span><span class="sxs-lookup"><span data-stu-id="88a89-129">For a tutorial experience on publishing an ASP.NET Core app to an IIS server, see <xref:tutorials/publish-to-iis>.</span></span>

[<span data-ttu-id="88a89-130">Zainstaluj pakiet hostingu platformy .NET Core</span><span class="sxs-lookup"><span data-stu-id="88a89-130">Install the .NET Core Hosting Bundle</span></span>](#install-the-net-core-hosting-bundle)

## <a name="supported-operating-systems"></a><span data-ttu-id="88a89-131">Obsługiwane systemy operacyjne</span><span class="sxs-lookup"><span data-stu-id="88a89-131">Supported operating systems</span></span>

<span data-ttu-id="88a89-132">Obsługiwane są następujące systemy operacyjne:</span><span class="sxs-lookup"><span data-stu-id="88a89-132">The following operating systems are supported:</span></span>

* <span data-ttu-id="88a89-133">System Windows 7 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="88a89-133">Windows 7 or later</span></span>
* <span data-ttu-id="88a89-134">System Windows Server 2012 R2 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="88a89-134">Windows Server 2012 R2 or later</span></span>

<span data-ttu-id="88a89-135">[ SerwerHTTP.sys](xref:fundamentals/servers/httpsys) (znany wcześniej jako webListener) nie działa w konfiguracji zwrotnego serwera proxy z usługami IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-135">[HTTP.sys server](xref:fundamentals/servers/httpsys) (formerly called WebListener) doesn't work in a reverse proxy configuration with IIS.</span></span> <span data-ttu-id="88a89-136">Użyj [serwera Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="88a89-136">Use the [Kestrel server](xref:fundamentals/servers/kestrel).</span></span>

<span data-ttu-id="88a89-137">Aby uzyskać informacje na temat hostingu na platformie Azure, zobacz <xref:host-and-deploy/azure-apps/index> .</span><span class="sxs-lookup"><span data-stu-id="88a89-137">For information on hosting in Azure, see <xref:host-and-deploy/azure-apps/index>.</span></span>

<span data-ttu-id="88a89-138">Aby uzyskać wskazówki dotyczące rozwiązywania problemów, zobacz <xref:test/troubleshoot> .</span><span class="sxs-lookup"><span data-stu-id="88a89-138">For troubleshooting guidance, see <xref:test/troubleshoot>.</span></span>

## <a name="supported-platforms"></a><span data-ttu-id="88a89-139">Obsługiwane platformy</span><span class="sxs-lookup"><span data-stu-id="88a89-139">Supported platforms</span></span>

<span data-ttu-id="88a89-140">Obsługiwane są aplikacje opublikowane dla wdrożenia 32-bitowego (x86) lub 64-bitowego (x64).</span><span class="sxs-lookup"><span data-stu-id="88a89-140">Apps published for 32-bit (x86) or 64-bit (x64) deployment are supported.</span></span> <span data-ttu-id="88a89-141">Wdróż aplikację 32-bitową z 32-bitową (x86) zestaw .NET Core SDK, chyba że aplikacja:</span><span class="sxs-lookup"><span data-stu-id="88a89-141">Deploy a 32-bit app with a 32-bit (x86) .NET Core SDK unless the app:</span></span>

* <span data-ttu-id="88a89-142">Wymagana jest większa przestrzeń adresów pamięci wirtualnej dla aplikacji 64-bitowej.</span><span class="sxs-lookup"><span data-stu-id="88a89-142">Requires the larger virtual memory address space available to a 64-bit app.</span></span>
* <span data-ttu-id="88a89-143">Wymaga większego rozmiaru stosu IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-143">Requires the larger IIS stack size.</span></span>
* <span data-ttu-id="88a89-144">Ma 64-bitowe zależności natywne.</span><span class="sxs-lookup"><span data-stu-id="88a89-144">Has 64-bit native dependencies.</span></span>

<span data-ttu-id="88a89-145">Aplikacje opublikowane dla 32-bitowej (x86) muszą mieć włączone 32-bitowe dla ich pul aplikacji usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-145">Apps published for 32-bit (x86) must have 32-bit enabled for their IIS Application Pools.</span></span> <span data-ttu-id="88a89-146">Aby uzyskać więcej informacji, zobacz sekcję [Tworzenie witryny usług IIS](#create-the-iis-site) .</span><span class="sxs-lookup"><span data-stu-id="88a89-146">For more information, see the [Create the IIS site](#create-the-iis-site) section.</span></span>

<span data-ttu-id="88a89-147">Aby opublikować aplikację 64-bitową, należy użyć 64-bitowej (x64) zestaw .NET Core SDK.</span><span class="sxs-lookup"><span data-stu-id="88a89-147">Use a 64-bit (x64) .NET Core SDK to publish a 64-bit app.</span></span> <span data-ttu-id="88a89-148">64-bitowy środowisko uruchomieniowe musi być obecny w systemie hosta.</span><span class="sxs-lookup"><span data-stu-id="88a89-148">A 64-bit runtime must be present on the host system.</span></span>

## <a name="hosting-models"></a><span data-ttu-id="88a89-149">Modele hostingu</span><span class="sxs-lookup"><span data-stu-id="88a89-149">Hosting models</span></span>

### <a name="in-process-hosting-model"></a><span data-ttu-id="88a89-150">Model hostingu w procesie</span><span class="sxs-lookup"><span data-stu-id="88a89-150">In-process hosting model</span></span>

<span data-ttu-id="88a89-151">Korzystając z hostingu w procesie, aplikacja ASP.NET Core jest uruchamiana w tym samym procesie co proces roboczy usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-151">Using in-process hosting, an ASP.NET Core app runs in the same process as its IIS worker process.</span></span> <span data-ttu-id="88a89-152">Hosting w procesie zapewnia lepszą wydajność w porównaniu z obsługą hostingu, ponieważ żądania nie są kierowane do serwera proxy za pośrednictwem karty sprzężenia zwrotnego, czyli interfejsu sieciowego, który zwraca wychodzący ruch sieciowy z powrotem do tego samego komputera.</span><span class="sxs-lookup"><span data-stu-id="88a89-152">In-process hosting provides improved performance over out-of-process hosting because requests aren't proxied over the loopback adapter, a network interface that returns outgoing network traffic back to the same machine.</span></span> <span data-ttu-id="88a89-153">Usługi IIS obsługują zarządzanie procesami przy użyciu [usługi aktywacji procesów systemu Windows (was)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="88a89-153">IIS handles process management with the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="88a89-154">[Moduł ASP.NET Core](xref:host-and-deploy/aspnet-core-module):</span><span class="sxs-lookup"><span data-stu-id="88a89-154">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module):</span></span>

* <span data-ttu-id="88a89-155">Wykonuje inicjalizację aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-155">Performs app initialization.</span></span>
  * <span data-ttu-id="88a89-156">Ładuje [CoreCLR](/dotnet/standard/glossary#coreclr).</span><span class="sxs-lookup"><span data-stu-id="88a89-156">Loads the [CoreCLR](/dotnet/standard/glossary#coreclr).</span></span>
  * <span data-ttu-id="88a89-157">Wywołania `Program.Main` .</span><span class="sxs-lookup"><span data-stu-id="88a89-157">Calls `Program.Main`.</span></span>
* <span data-ttu-id="88a89-158">Obsługuje okres istnienia żądania natywnego usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-158">Handles the lifetime of the IIS native request.</span></span>

<span data-ttu-id="88a89-159">Na poniższym diagramie przedstawiono relację między usługami IIS, modułem ASP.NET Core i hostowaną w procesie aplikacją:</span><span class="sxs-lookup"><span data-stu-id="88a89-159">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted in-process:</span></span>

![Moduł ASP.NET Core w scenariuszu hostingu w procesie](index/_static/ancm-inprocess.png)

1. <span data-ttu-id="88a89-161">Żądanie dociera do sieci Web do sterownika HTTP.sys trybu jądra.</span><span class="sxs-lookup"><span data-stu-id="88a89-161">A request arrives from the web to the kernel-mode HTTP.sys driver.</span></span>
1. <span data-ttu-id="88a89-162">Sterownik kieruje natywne żądanie do usług IIS na skonfigurowanym porcie witryny sieci Web, zwykle 80 (HTTP) lub 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="88a89-162">The driver routes the native request to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span>
1. <span data-ttu-id="88a89-163">Moduł ASP.NET Core odbiera żądanie natywne i przekazuje go do serwera HTTP usług IIS ( `IISHttpServer` ).</span><span class="sxs-lookup"><span data-stu-id="88a89-163">The ASP.NET Core Module receives the native request and passes it to IIS HTTP Server (`IISHttpServer`).</span></span> <span data-ttu-id="88a89-164">Serwer HTTP IIS jest implementacją serwera w procesie dla usług IIS, która konwertuje żądanie z natywnego na zarządzane.</span><span class="sxs-lookup"><span data-stu-id="88a89-164">IIS HTTP Server is an in-process server implementation for IIS that converts the request from native to managed.</span></span>

<span data-ttu-id="88a89-165">Po przetworzeniu żądania przez serwer HTTP IIS:</span><span class="sxs-lookup"><span data-stu-id="88a89-165">After the IIS HTTP Server processes the request:</span></span>

1. <span data-ttu-id="88a89-166">Żądanie jest wysyłane do ASP.NET Core potoku oprogramowania pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="88a89-166">The request is sent to the ASP.NET Core middleware pipeline.</span></span>
1. <span data-ttu-id="88a89-167">Potok oprogramowania pośredniczącego obsługuje żądanie i przekazuje go jako `HttpContext` wystąpienie do logiki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-167">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span>
1. <span data-ttu-id="88a89-168">Odpowiedź aplikacji jest przesyłana z powrotem do usług IIS za pośrednictwem serwera HTTP IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-168">The app's response is passed back to IIS through IIS HTTP Server.</span></span>
1. <span data-ttu-id="88a89-169">Program IIS wysyła odpowiedź do klienta, który zainicjował żądanie.</span><span class="sxs-lookup"><span data-stu-id="88a89-169">IIS sends the response to the client that initiated the request.</span></span>

<span data-ttu-id="88a89-170">Hosting w procesie jest zgodą na istniejące aplikacje.</span><span class="sxs-lookup"><span data-stu-id="88a89-170">In-process hosting is opt-in for existing apps.</span></span> <span data-ttu-id="88a89-171">Szablony sieci Web ASP.NET Core korzystają z modelu hostingu w procesie.</span><span class="sxs-lookup"><span data-stu-id="88a89-171">The ASP.NET Core web templates use the in-process hosting model.</span></span>

<span data-ttu-id="88a89-172">`CreateDefaultBuilder` dodaje <xref:Microsoft.AspNetCore.Hosting.Server.IServer> wystąpienie przez wywołanie <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIIS%2A> metody w celu uruchomienia [CoreCLR](/dotnet/standard/glossary#coreclr) i hostowania aplikacji w procesie roboczym usług IIS ( `w3wp.exe` lub `iisexpress.exe` ).</span><span class="sxs-lookup"><span data-stu-id="88a89-172">`CreateDefaultBuilder` adds an <xref:Microsoft.AspNetCore.Hosting.Server.IServer> instance by calling the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIIS%2A> method to boot the [CoreCLR](/dotnet/standard/glossary#coreclr) and host the app inside of the IIS worker process (`w3wp.exe` or `iisexpress.exe`).</span></span> <span data-ttu-id="88a89-173">Testy wydajności wskazują, że hostowanie aplikacji platformy .NET Core w procesie zapewnia znacznie wyższą przepływność żądań w porównaniu z obsługą żądań proxy poza procesem i [Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="88a89-173">Performance tests indicate that hosting a .NET Core app in-process delivers significantly higher request throughput compared to hosting the app out-of-process and proxying requests to [Kestrel](xref:fundamentals/servers/kestrel).</span></span>

<span data-ttu-id="88a89-174">Aplikacje publikowane jako pojedynczy plik wykonywalny nie mogą zostać załadowane przez model hostingu w procesie.</span><span class="sxs-lookup"><span data-stu-id="88a89-174">Apps published as a single file executable can't be loaded by the in-process hosting model.</span></span>

### <a name="out-of-process-hosting-model"></a><span data-ttu-id="88a89-175">Model hostingu poza procesem</span><span class="sxs-lookup"><span data-stu-id="88a89-175">Out-of-process hosting model</span></span>

<span data-ttu-id="88a89-176">Ponieważ ASP.NET Core aplikacje działają w procesie innym niż proces roboczy usług IIS, moduł ASP.NET Core obsługuje zarządzanie procesami.</span><span class="sxs-lookup"><span data-stu-id="88a89-176">Because ASP.NET Core apps run in a process separate from the IIS worker process, the ASP.NET Core Module handles process management.</span></span> <span data-ttu-id="88a89-177">Moduł uruchamia proces dla aplikacji ASP.NET Core, gdy pierwsze żądanie zostanie odebrane i ponownie uruchomiony, jeśli zostanie zamknięty lub ulegnie awarii.</span><span class="sxs-lookup"><span data-stu-id="88a89-177">The module starts the process for the ASP.NET Core app when the first request arrives and restarts the app if it shuts down or crashes.</span></span> <span data-ttu-id="88a89-178">Jest to zasadniczo takie samo zachowanie jak w przypadku aplikacji uruchamianych w procesie, które są zarządzane przez [usługę aktywacji procesów systemu Windows (was)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="88a89-178">This is essentially the same behavior as seen with apps that run in-process that are managed by the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="88a89-179">Na poniższym diagramie przedstawiono relację między usługami IIS, modułem ASP.NET Core i hostowanym przez aplikację aplikacją:</span><span class="sxs-lookup"><span data-stu-id="88a89-179">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted out-of-process:</span></span>

![Moduł ASP.NET Core w scenariuszu hostingu poza procesem](index/_static/ancm-outofprocess.png)

1. <span data-ttu-id="88a89-181">Żądania docierają z sieci Web do sterownika HTTP.sys trybu jądra.</span><span class="sxs-lookup"><span data-stu-id="88a89-181">Requests arrive from the web to the kernel-mode HTTP.sys driver.</span></span>
1. <span data-ttu-id="88a89-182">Sterownik kieruje żądania do usług IIS na skonfigurowanym porcie witryny sieci Web.</span><span class="sxs-lookup"><span data-stu-id="88a89-182">The driver routes the requests to IIS on the website's configured port.</span></span> <span data-ttu-id="88a89-183">Skonfigurowany port jest zwykle 80 (HTTP) lub 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="88a89-183">The configured port is usually 80 (HTTP) or 443 (HTTPS).</span></span>
1. <span data-ttu-id="88a89-184">Moduł przekazuje żądania do Kestrel na losowo wybranym porcie dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-184">The module forwards the requests to Kestrel on a random port for the app.</span></span> <span data-ttu-id="88a89-185">Port losowy nie jest 80 lub 443.</span><span class="sxs-lookup"><span data-stu-id="88a89-185">The random port isn't 80 or 443.</span></span>

<!-- make this a bullet list -->
<span data-ttu-id="88a89-186">Moduł ASP.NET Core określa port za pośrednictwem zmiennej środowiskowej podczas uruchamiania.</span><span class="sxs-lookup"><span data-stu-id="88a89-186">The ASP.NET Core Module specifies the port via an environment variable at startup.</span></span> <span data-ttu-id="88a89-187"><xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration%2A>Rozszerzenie konfiguruje serwer do nasłuchiwania `http://localhost:{PORT}` .</span><span class="sxs-lookup"><span data-stu-id="88a89-187">The <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration%2A> extension configures the server to listen on `http://localhost:{PORT}`.</span></span> <span data-ttu-id="88a89-188">Dodatkowe sprawdzenia są wykonywane, a żądania, które nie pochodzą z modułu, są odrzucane.</span><span class="sxs-lookup"><span data-stu-id="88a89-188">Additional checks are performed, and requests that don't originate from the module are rejected.</span></span> <span data-ttu-id="88a89-189">Moduł nie obsługuje przekazywania HTTPS.</span><span class="sxs-lookup"><span data-stu-id="88a89-189">The module doesn't support HTTPS forwarding.</span></span> <span data-ttu-id="88a89-190">Żądania są przekazywane przez protokół HTTP nawet wtedy, gdy są odbierane przez usługi IIS przez protokół HTTPS.</span><span class="sxs-lookup"><span data-stu-id="88a89-190">Requests are forwarded over HTTP even if received by IIS over HTTPS.</span></span>

<span data-ttu-id="88a89-191">Po poKestrel przez program żądania z modułu żądanie zostanie przekazane do ASP.NET Core potoku programu pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="88a89-191">After Kestrel picks up the request from the module, the request is forwarded into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="88a89-192">Potok oprogramowania pośredniczącego obsługuje żądanie i przekazuje go jako `HttpContext` wystąpienie do logiki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-192">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="88a89-193">Oprogramowanie pośredniczące dodane przez integrację usług IIS aktualizuje schemat, zdalny adres IP i pathbase, aby można było przesłać żądanie do Kestrel.</span><span class="sxs-lookup"><span data-stu-id="88a89-193">Middleware added by IIS Integration updates the scheme, remote IP, and pathbase to account for forwarding the request to Kestrel.</span></span> <span data-ttu-id="88a89-194">Odpowiedź aplikacji jest przesyłana z powrotem do usług IIS, która przekazuje ją z powrotem do klienta HTTP, który zainicjował żądanie.</span><span class="sxs-lookup"><span data-stu-id="88a89-194">The app's response is passed back to IIS, which forwards it back to the HTTP client that initiated the request.</span></span>

<span data-ttu-id="88a89-195">Aby uzyskać wskazówki dotyczące konfiguracji modułu ASP.NET Core, zobacz <xref:host-and-deploy/aspnet-core-module> .</span><span class="sxs-lookup"><span data-stu-id="88a89-195">For ASP.NET Core Module configuration guidance, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

<span data-ttu-id="88a89-196">Aby uzyskać więcej informacji na temat hostingu, zobacz [host in ASP.NET Core](xref:fundamentals/index#host).</span><span class="sxs-lookup"><span data-stu-id="88a89-196">For more information on hosting, see [Host in ASP.NET Core](xref:fundamentals/index#host).</span></span>

## <a name="application-configuration"></a><span data-ttu-id="88a89-197">Konfiguracja aplikacji</span><span class="sxs-lookup"><span data-stu-id="88a89-197">Application configuration</span></span>

### <a name="enable-the-iisintegration-components"></a><span data-ttu-id="88a89-198">Włącz składniki IISIntegration</span><span class="sxs-lookup"><span data-stu-id="88a89-198">Enable the IISIntegration components</span></span>

<span data-ttu-id="88a89-199">Podczas kompilowania hosta w `CreateHostBuilder` ( `Program.cs` ), wywołaj, <xref:Microsoft.Extensions.Hosting.Host.CreateDefaultBuilder%2A> Aby włączyć integrację usług IIS:</span><span class="sxs-lookup"><span data-stu-id="88a89-199">When building a host in `CreateHostBuilder` (`Program.cs`), call <xref:Microsoft.Extensions.Hosting.Host.CreateDefaultBuilder%2A> to enable IIS integration:</span></span>

```csharp
public static IHostBuilder CreateHostBuilder(string[] args) =>
    Host.CreateDefaultBuilder(args)
        ...
```

<span data-ttu-id="88a89-200">Aby uzyskać więcej informacji na temat `CreateDefaultBuilder` , zobacz <xref:fundamentals/host/generic-host#default-builder-settings> .</span><span class="sxs-lookup"><span data-stu-id="88a89-200">For more information on `CreateDefaultBuilder`, see <xref:fundamentals/host/generic-host#default-builder-settings>.</span></span>

### <a name="iis-options"></a><span data-ttu-id="88a89-201">Opcje usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-201">IIS options</span></span>

<span data-ttu-id="88a89-202">**Model hostingu w procesie**</span><span class="sxs-lookup"><span data-stu-id="88a89-202">**In-process hosting model**</span></span>

<span data-ttu-id="88a89-203">Aby skonfigurować opcje serwera usług IIS, należy uwzględnić <xref:Microsoft.AspNetCore.Builder.IISServerOptions> w programie konfigurację usługi <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices%2A> .</span><span class="sxs-lookup"><span data-stu-id="88a89-203">To configure IIS Server options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISServerOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices%2A>.</span></span> <span data-ttu-id="88a89-204">Poniższy przykład wyłącza AutomaticAuthentication:</span><span class="sxs-lookup"><span data-stu-id="88a89-204">The following example disables AutomaticAuthentication:</span></span>

```csharp
services.Configure<IISServerOptions>(options => 
{
    options.AutomaticAuthentication = false;
});
```

| <span data-ttu-id="88a89-205">Opcja</span><span class="sxs-lookup"><span data-stu-id="88a89-205">Option</span></span>                         | <span data-ttu-id="88a89-206">Domyślne</span><span class="sxs-lookup"><span data-stu-id="88a89-206">Default</span></span> | <span data-ttu-id="88a89-207">Ustawienie</span><span class="sxs-lookup"><span data-stu-id="88a89-207">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="88a89-208">Jeśli `true` serwer usług IIS ustawi uwierzytelnienie `HttpContext.User` za pomocą [uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-208">If `true`, IIS Server sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="88a89-209">Jeśli `false` serwer zawiera tylko tożsamość dla `HttpContext.User` i reaguje na wyzwania, gdy zostanie jawnie zlecony przez `AuthenticationScheme` .</span><span class="sxs-lookup"><span data-stu-id="88a89-209">If `false`, the server only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="88a89-210">Aby program mógł działać, należy włączyć uwierzytelnianie systemu Windows `AutomaticAuthentication` .</span><span class="sxs-lookup"><span data-stu-id="88a89-210">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="88a89-211">Aby uzyskać więcej informacji, zobacz [uwierzytelnianie systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-211">For more information, see [Windows Authentication](xref:security/authentication/windowsauth).</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="88a89-212">Ustawia nazwę wyświetlaną pokazywaną użytkownikom na stronach logowania.</span><span class="sxs-lookup"><span data-stu-id="88a89-212">Sets the display name shown to users on login pages.</span></span> |
| `AllowSynchronousIO`           | `false` | <span data-ttu-id="88a89-213">Czy synchroniczna operacja we/wy jest dozwolona dla `HttpContext.Request` i `HttpContext.Response` .</span><span class="sxs-lookup"><span data-stu-id="88a89-213">Whether synchronous I/O is allowed for the `HttpContext.Request` and the `HttpContext.Response`.</span></span> |
| `MaxRequestBodySize`           | `30000000`  | <span data-ttu-id="88a89-214">Pobiera lub ustawia maksymalny rozmiar treści żądania dla `HttpRequest` .</span><span class="sxs-lookup"><span data-stu-id="88a89-214">Gets or sets the max request body size for the `HttpRequest`.</span></span> <span data-ttu-id="88a89-215">Należy zauważyć, że same usługi IIS mają limit, `maxAllowedContentLength` który zostanie przetworzony przed `MaxRequestBodySize` zestawem w `IISServerOptions` .</span><span class="sxs-lookup"><span data-stu-id="88a89-215">Note that IIS itself has the limit `maxAllowedContentLength` which will be processed before the `MaxRequestBodySize` set in the `IISServerOptions`.</span></span> <span data-ttu-id="88a89-216">Zmiana `MaxRequestBodySize` nie wpłynie na `maxAllowedContentLength` .</span><span class="sxs-lookup"><span data-stu-id="88a89-216">Changing the `MaxRequestBodySize` won't affect the `maxAllowedContentLength`.</span></span> <span data-ttu-id="88a89-217">Aby zwiększyć `maxAllowedContentLength` , Dodaj wpis w programie, `web.config` Aby ustawić `maxAllowedContentLength` wyższą wartość.</span><span class="sxs-lookup"><span data-stu-id="88a89-217">To increase `maxAllowedContentLength`, add an entry in the `web.config` to set `maxAllowedContentLength` to a higher value.</span></span> <span data-ttu-id="88a89-218">Aby uzyskać więcej informacji, zobacz [Konfiguracja](/iis/configuration/system.webServer/security/requestFiltering/requestLimits/#configuration).</span><span class="sxs-lookup"><span data-stu-id="88a89-218">For more details, see [Configuration](/iis/configuration/system.webServer/security/requestFiltering/requestLimits/#configuration).</span></span> |

<span data-ttu-id="88a89-219">**Model hostingu poza procesem**</span><span class="sxs-lookup"><span data-stu-id="88a89-219">**Out-of-process hosting model**</span></span>

<span data-ttu-id="88a89-220">Aby skonfigurować opcje usług IIS, należy uwzględnić <xref:Microsoft.AspNetCore.Builder.IISOptions> w programie konfigurację usługi <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices%2A> .</span><span class="sxs-lookup"><span data-stu-id="88a89-220">To configure IIS options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices%2A>.</span></span> <span data-ttu-id="88a89-221">Poniższy przykład uniemożliwia wypełnianie aplikacji `HttpContext.Connection.ClientCertificate` :</span><span class="sxs-lookup"><span data-stu-id="88a89-221">The following example prevents the app from populating `HttpContext.Connection.ClientCertificate`:</span></span>

```csharp
services.Configure<IISOptions>(options => 
{
    options.ForwardClientCertificate = false;
});
```

| <span data-ttu-id="88a89-222">Opcja</span><span class="sxs-lookup"><span data-stu-id="88a89-222">Option</span></span>                         | <span data-ttu-id="88a89-223">Domyślne</span><span class="sxs-lookup"><span data-stu-id="88a89-223">Default</span></span> | <span data-ttu-id="88a89-224">Ustawienie</span><span class="sxs-lookup"><span data-stu-id="88a89-224">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="88a89-225">Jeśli `true` [oprogramowanie pośredniczące integracji usług IIS](#enable-the-iisintegration-components) ustawi uwierzytelnienie `HttpContext.User` za pomocą [uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-225">If `true`, [IIS Integration Middleware](#enable-the-iisintegration-components) sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="88a89-226">Jeśli `false` oprogramowanie pośredniczące zapewnia tylko tożsamość `HttpContext.User` i reaguje na wyzwania, gdy zostanie jawnie zażądana przez program `AuthenticationScheme` .</span><span class="sxs-lookup"><span data-stu-id="88a89-226">If `false`, the middleware only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="88a89-227">Aby program mógł działać, należy włączyć uwierzytelnianie systemu Windows `AutomaticAuthentication` .</span><span class="sxs-lookup"><span data-stu-id="88a89-227">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="88a89-228">Aby uzyskać więcej informacji, zobacz temat [uwierzytelnianie systemu Windows](xref:security/authentication/windowsauth) .</span><span class="sxs-lookup"><span data-stu-id="88a89-228">For more information, see the [Windows Authentication](xref:security/authentication/windowsauth) topic.</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="88a89-229">Ustawia nazwę wyświetlaną pokazywaną użytkownikom na stronach logowania.</span><span class="sxs-lookup"><span data-stu-id="88a89-229">Sets the display name shown to users on login pages.</span></span> |
| `ForwardClientCertificate`     | `true`  | <span data-ttu-id="88a89-230">Jeśli `true` `MS-ASPNETCORE-CLIENTCERT` jest obecny nagłówek żądania, `HttpContext.Connection.ClientCertificate` zostanie wypełniony.</span><span class="sxs-lookup"><span data-stu-id="88a89-230">If `true` and the `MS-ASPNETCORE-CLIENTCERT` request header is present, the `HttpContext.Connection.ClientCertificate` is populated.</span></span> |

### <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="88a89-231">Scenariusze serwera proxy i modułu równoważenia obciążenia</span><span class="sxs-lookup"><span data-stu-id="88a89-231">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="88a89-232">[Oprogramowanie pośredniczące integracji usług IIS](#enable-the-iisintegration-components) i moduł ASP.NET Core są skonfigurowane do przesyłania dalej:</span><span class="sxs-lookup"><span data-stu-id="88a89-232">The [IIS Integration Middleware](#enable-the-iisintegration-components) and the ASP.NET Core Module are configured to forward the:</span></span>

* <span data-ttu-id="88a89-233">Schemat (HTTP/HTTPS).</span><span class="sxs-lookup"><span data-stu-id="88a89-233">Scheme (HTTP/HTTPS).</span></span>
* <span data-ttu-id="88a89-234">Zdalny adres IP, z którego pochodzi żądanie.</span><span class="sxs-lookup"><span data-stu-id="88a89-234">Remote IP address where the request originated.</span></span>

<span data-ttu-id="88a89-235">[Oprogramowanie pośredniczące integracji usług IIS](#enable-the-iisintegration-components) konfiguruje przekazane nagłówki pośredniczące.</span><span class="sxs-lookup"><span data-stu-id="88a89-235">The [IIS Integration Middleware](#enable-the-iisintegration-components) configures Forwarded Headers Middleware.</span></span>

<span data-ttu-id="88a89-236">W przypadku aplikacji hostowanych za dodatkowymi serwerami proxy i modułami równoważenia obciążenia może być wymagana dodatkowa konfiguracja.</span><span class="sxs-lookup"><span data-stu-id="88a89-236">Additional configuration might be required for apps hosted behind additional proxy servers and load balancers.</span></span> <span data-ttu-id="88a89-237">Aby uzyskać więcej informacji, zobacz [konfigurowanie ASP.NET Core do pracy z serwerami proxy i usługami równoważenia obciążenia](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="88a89-237">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

### <a name="webconfig-file"></a><span data-ttu-id="88a89-238">`web.config` rozszerzeniem</span><span class="sxs-lookup"><span data-stu-id="88a89-238">`web.config` file</span></span>

<span data-ttu-id="88a89-239">`web.config`Plik konfiguruje [moduł ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="88a89-239">The `web.config` file configures the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="88a89-240">Tworzenie, przekształcanie i publikowanie `web.config` pliku jest obsługiwane przez obiekt docelowy programu MSBuild (), `_TransformWebConfig` gdy projekt jest publikowany.</span><span class="sxs-lookup"><span data-stu-id="88a89-240">Creating, transforming, and publishing the `web.config` file is handled by an MSBuild target (`_TransformWebConfig`) when the project is published.</span></span> <span data-ttu-id="88a89-241">Ten element docelowy znajduje się w obiektach docelowych zestawu SDK sieci Web ( `Microsoft.NET.Sdk.Web` ).</span><span class="sxs-lookup"><span data-stu-id="88a89-241">This target is present in the Web SDK targets (`Microsoft.NET.Sdk.Web`).</span></span> <span data-ttu-id="88a89-242">Zestaw SDK jest ustawiany u góry pliku projektu:</span><span class="sxs-lookup"><span data-stu-id="88a89-242">The SDK is set at the top of the project file:</span></span>

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">
```

<span data-ttu-id="88a89-243">Jeśli `web.config` plik nie jest obecny w projekcie, plik zostanie utworzony z prawidłowym `processPath` i `arguments` w celu skonfigurowania modułu ASP.NET Core i przeniesiona do [publikowanych danych wyjściowych](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="88a89-243">If a `web.config` file isn't present in the project, the file is created with the correct `processPath` and `arguments` to configure the ASP.NET Core Module and moved to [published output](xref:host-and-deploy/directory-structure).</span></span>

<span data-ttu-id="88a89-244">Jeśli `web.config` plik jest obecny w projekcie, plik zostanie przekształcony z prawidłowym `processPath` i `arguments` skonfigurowanym modułem ASP.NET Core i przeniesiony do publikowanych danych wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="88a89-244">If a `web.config` file is present in the project, the file is transformed with the correct `processPath` and `arguments` to configure the ASP.NET Core Module and moved to published output.</span></span> <span data-ttu-id="88a89-245">Transformacja nie modyfikuje ustawień konfiguracji usług IIS w pliku.</span><span class="sxs-lookup"><span data-stu-id="88a89-245">The transformation doesn't modify IIS configuration settings in the file.</span></span>

<span data-ttu-id="88a89-246">`web.config`Plik może zapewnić dodatkowe ustawienia konfiguracji usług IIS kontrolujące aktywne moduły usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-246">The `web.config` file may provide additional IIS configuration settings that control active IIS modules.</span></span> <span data-ttu-id="88a89-247">Aby uzyskać informacje na temat modułów usług IIS, które mogą przetwarzać żądania z aplikacjami ASP.NET Core, zobacz temat [moduły usług IIS](xref:host-and-deploy/iis/modules) .</span><span class="sxs-lookup"><span data-stu-id="88a89-247">For information on IIS modules that are capable of processing requests with ASP.NET Core apps, see the [IIS modules](xref:host-and-deploy/iis/modules) topic.</span></span>

<span data-ttu-id="88a89-248">Aby uniemożliwić przekształcanie plików przez zestaw SDK sieci Web `web.config` , należy użyć `<IsTransformWebConfigDisabled>` właściwości w pliku projektu:</span><span class="sxs-lookup"><span data-stu-id="88a89-248">To prevent the Web SDK from transforming the `web.config` file, use the `<IsTransformWebConfigDisabled>` property in the project file:</span></span>

```xml
<PropertyGroup>
  <IsTransformWebConfigDisabled>true</IsTransformWebConfigDisabled>
</PropertyGroup>
```

<span data-ttu-id="88a89-249">Podczas wyłączania pliku zestawu SDK sieci Web przy użyciu programu `processPath` i `arguments` powinien zostać ręcznie ustawiony przez dewelopera.</span><span class="sxs-lookup"><span data-stu-id="88a89-249">When disabling the Web SDK from transforming the file, the `processPath` and `arguments` should be manually set by the developer.</span></span> <span data-ttu-id="88a89-250">Aby uzyskać więcej informacji, zobacz <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="88a89-250">For more information, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

### <a name="webconfig-file-location"></a><span data-ttu-id="88a89-251">`web.config` Lokalizacja pliku</span><span class="sxs-lookup"><span data-stu-id="88a89-251">`web.config` file location</span></span>

<span data-ttu-id="88a89-252">Aby prawidłowo skonfigurować [moduł ASP.NET Core](xref:host-and-deploy/aspnet-core-module) , `web.config` plik musi być obecny w ścieżce [katalogu głównego zawartości](xref:fundamentals/index#content-root) (zazwyczaj ścieżka podstawowa aplikacji) wdrożonej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-252">In order to set up the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) correctly, the `web.config` file must be present at the [content root](xref:fundamentals/index#content-root) path (typically the app base path) of the deployed app.</span></span> <span data-ttu-id="88a89-253">Ta sama lokalizacja jest taka sama jak ścieżka fizyczna witryny sieci Web dostarczana do usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-253">This is the same location as the website physical path provided to IIS.</span></span> <span data-ttu-id="88a89-254">`web.config`Plik jest wymagany w katalogu głównym aplikacji, aby umożliwić Publikowanie wielu aplikacji przy użyciu Web Deploy.</span><span class="sxs-lookup"><span data-stu-id="88a89-254">The `web.config` file is required at the root of the app to enable the publishing of multiple apps using Web Deploy.</span></span>

<span data-ttu-id="88a89-255">Poufne pliki znajdują się w ścieżce fizycznej aplikacji, takiej jak `{ASSEMBLY}.runtimeconfig.json` , `{ASSEMBLY}.xml` (Komentarze dokumentacji XML) i `{ASSEMBLY}.deps.json` , gdzie symbol zastępczy `{ASSEMBLY}` jest nazwą zestawu.</span><span class="sxs-lookup"><span data-stu-id="88a89-255">Sensitive files exist on the app's physical path, such as `{ASSEMBLY}.runtimeconfig.json`, `{ASSEMBLY}.xml` (XML Documentation comments), and `{ASSEMBLY}.deps.json`, where the placeholder `{ASSEMBLY}` is the assembly name.</span></span> <span data-ttu-id="88a89-256">Gdy `web.config` plik jest obecny, a lokacja jest uruchamiana normalnie, usługi IIS nie będą obsługiwały tych poufnych plików, jeśli są żądane.</span><span class="sxs-lookup"><span data-stu-id="88a89-256">When the `web.config` file is present and the site starts normally, IIS doesn't serve these sensitive files if they're requested.</span></span> <span data-ttu-id="88a89-257">Jeśli `web.config` brakuje pliku lub nie można skonfigurować lokacji do normalnego uruchamiania, usługi IIS mogą publicznie obsłużyć poufne pliki.</span><span class="sxs-lookup"><span data-stu-id="88a89-257">If the `web.config` file is missing, incorrectly named, or unable to configure the site for normal startup, IIS may serve sensitive files publicly.</span></span>

<span data-ttu-id="88a89-258">**`web.config`Plik musi być obecny we wdrożeniu przez cały czas, prawidłowo nazwany i można skonfigurować lokację pod kątem normalnego uruchamiania. Nigdy nie należy usuwać `web.config` pliku z wdrożenia produkcyjnego.**</span><span class="sxs-lookup"><span data-stu-id="88a89-258">**The `web.config` file must be present in the deployment at all times, correctly named, and able to configure the site for normal start up. Never remove the `web.config` file from a production deployment.**</span></span>

### <a name="transform-webconfig"></a><span data-ttu-id="88a89-259">Przekształcanie pliku web.config</span><span class="sxs-lookup"><span data-stu-id="88a89-259">Transform web.config</span></span>

<span data-ttu-id="88a89-260">Jeśli musisz przekształcić `web.config` przy publikowaniu, zobacz <xref:host-and-deploy/iis/transform-webconfig> .</span><span class="sxs-lookup"><span data-stu-id="88a89-260">If you need to transform `web.config` on publish, see <xref:host-and-deploy/iis/transform-webconfig>.</span></span> <span data-ttu-id="88a89-261">Może być konieczne przekształcenie `web.config` przy publikowaniu w celu ustawienia zmiennych środowiskowych na podstawie konfiguracji, profilu lub środowiska.</span><span class="sxs-lookup"><span data-stu-id="88a89-261">You might need to transform `web.config` on publish to set environment variables based on the configuration, profile, or environment.</span></span>

## <a name="iis-configuration"></a><span data-ttu-id="88a89-262">Konfiguracja usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-262">IIS configuration</span></span>

<span data-ttu-id="88a89-263">**Systemy operacyjne Windows Server**</span><span class="sxs-lookup"><span data-stu-id="88a89-263">**Windows Server operating systems**</span></span>

<span data-ttu-id="88a89-264">Włącz rolę serwera **serwera sieci Web (IIS)** i Ustanów usługi ról.</span><span class="sxs-lookup"><span data-stu-id="88a89-264">Enable the **Web Server (IIS)** server role and establish role services.</span></span>

1. <span data-ttu-id="88a89-265">Użyj kreatora **dodawania ról i funkcji** z menu **Zarządzaj** lub łącza w **Menedżer serwera** .</span><span class="sxs-lookup"><span data-stu-id="88a89-265">Use the **Add Roles and Features** wizard from the **Manage** menu or the link in **Server Manager** .</span></span> <span data-ttu-id="88a89-266">W kroku **role serwera** zaznacz pole wyboru **serwer sieci Web (IIS)** .</span><span class="sxs-lookup"><span data-stu-id="88a89-266">On the **Server Roles** step, check the box for **Web Server (IIS)** .</span></span>

   ![W kroku wybierz role serwera zostanie wybrana rola IIS serwera sieci Web.](index/_static/server-roles-ws2016.png)

1. <span data-ttu-id="88a89-268">Po wykonaniu **kroków krok po kroku** **usługi ról** są ładowane dla serwera sieci Web (IIS).</span><span class="sxs-lookup"><span data-stu-id="88a89-268">After the **Features** step, the **Role services** step loads for Web Server (IIS).</span></span> <span data-ttu-id="88a89-269">Wybierz żądane usługi roli IIS lub zaakceptuj domyślne usługi ról.</span><span class="sxs-lookup"><span data-stu-id="88a89-269">Select the IIS role services desired or accept the default role services provided.</span></span>

   ![Domyślne usługi ról są wybrane w kroku Wybierz usługi ról.](index/_static/role-services-ws2016.png)

   <span data-ttu-id="88a89-271">**Uwierzytelnianie systemu Windows (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-271">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="88a89-272">Aby włączyć uwierzytelnianie systemu Windows, rozwiń następujące węzły: **Zabezpieczenia serwera sieci Web**  >  **Security** .</span><span class="sxs-lookup"><span data-stu-id="88a89-272">To enable Windows Authentication, expand the following nodes: **Web Server** > **Security** .</span></span> <span data-ttu-id="88a89-273">Wybierz funkcję **uwierzytelniania systemu Windows** .</span><span class="sxs-lookup"><span data-stu-id="88a89-273">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="88a89-274">Aby uzyskać więcej informacji, zobacz [uwierzytelnianie `<windowsAuthentication>` systemu Windows](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) i [Konfigurowanie uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-274">For more information, see [Windows Authentication `<windowsAuthentication>`](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="88a89-275">**Obiekty WebSockets (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-275">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="88a89-276">Obiekty WebSockets są obsługiwane w ASP.NET Core 1,1 lub nowszych.</span><span class="sxs-lookup"><span data-stu-id="88a89-276">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="88a89-277">Aby włączyć obiekty WebSockets, rozwiń następujące węzły: projektowanie aplikacji **serwera sieci Web**  >  **Application Development** .</span><span class="sxs-lookup"><span data-stu-id="88a89-277">To enable WebSockets, expand the following nodes: **Web Server** > **Application Development** .</span></span> <span data-ttu-id="88a89-278">Wybierz funkcję **protokołu WebSocket** .</span><span class="sxs-lookup"><span data-stu-id="88a89-278">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="88a89-279">Aby uzyskać więcej informacji, zobacz [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="88a89-279">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="88a89-280">Przejdź do kroku **potwierdzenia** , aby zainstalować rolę i usługi serwera sieci Web.</span><span class="sxs-lookup"><span data-stu-id="88a89-280">Proceed through the **Confirmation** step to install the web server role and services.</span></span> <span data-ttu-id="88a89-281">Po zainstalowaniu roli **serwera sieci Web (IIS)** nie jest wymagane ponowne uruchomienie serwera ani usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-281">A server/IIS restart isn't required after installing the **Web Server (IIS)** role.</span></span>

<span data-ttu-id="88a89-282">**Systemy operacyjne Windows dla komputerów stacjonarnych**</span><span class="sxs-lookup"><span data-stu-id="88a89-282">**Windows desktop operating systems**</span></span>

<span data-ttu-id="88a89-283">Włącz **konsolę zarządzania usług IIS** i **usługi World Wide Web** .</span><span class="sxs-lookup"><span data-stu-id="88a89-283">Enable the **IIS Management Console** and **World Wide Web Services** .</span></span>

1. <span data-ttu-id="88a89-284">Przejdź do pozycji **Panel sterowania** > **programy** > **programy i funkcje** > **Włącz lub wyłącz funkcje systemu Windows** (po lewej stronie ekranu).</span><span class="sxs-lookup"><span data-stu-id="88a89-284">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>

1. <span data-ttu-id="88a89-285">Otwórz węzeł **Internet Information Services** .</span><span class="sxs-lookup"><span data-stu-id="88a89-285">Open the **Internet Information Services** node.</span></span> <span data-ttu-id="88a89-286">Otwórz węzeł **Narzędzia do zarządzania siecią Web** .</span><span class="sxs-lookup"><span data-stu-id="88a89-286">Open the **Web Management Tools** node.</span></span>

1. <span data-ttu-id="88a89-287">Zaznacz pole wyboru w obszarze **Konsola zarządzania usługami IIS** .</span><span class="sxs-lookup"><span data-stu-id="88a89-287">Check the box for **IIS Management Console** .</span></span>

1. <span data-ttu-id="88a89-288">Zaznacz pole wyboru **usług World Wide Web Services** .</span><span class="sxs-lookup"><span data-stu-id="88a89-288">Check the box for **World Wide Web Services** .</span></span>

1. <span data-ttu-id="88a89-289">Zaakceptuj domyślne funkcje **usług World Wide Web Services** lub Dostosuj funkcje usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-289">Accept the default features for **World Wide Web Services** or customize the IIS features.</span></span>

   <span data-ttu-id="88a89-290">**Uwierzytelnianie systemu Windows (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-290">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="88a89-291">Aby włączyć uwierzytelnianie systemu Windows, rozwiń następujące węzły: **World Wide Web usług**  >  **zabezpieczenia** .</span><span class="sxs-lookup"><span data-stu-id="88a89-291">To enable Windows Authentication, expand the following nodes: **World Wide Web Services** > **Security** .</span></span> <span data-ttu-id="88a89-292">Wybierz funkcję **uwierzytelniania systemu Windows** .</span><span class="sxs-lookup"><span data-stu-id="88a89-292">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="88a89-293">Aby uzyskać więcej informacji, zobacz [uwierzytelnianie \<windowsAuthentication> systemu Windows](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) i [Konfigurowanie uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-293">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="88a89-294">**Obiekty WebSockets (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-294">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="88a89-295">Obiekty WebSockets są obsługiwane w ASP.NET Core 1,1 lub nowszych.</span><span class="sxs-lookup"><span data-stu-id="88a89-295">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="88a89-296">Aby włączyć obiekty WebSockets, rozwiń następujące węzły: **World Wide Web Services**  >  **Application Development Features** .</span><span class="sxs-lookup"><span data-stu-id="88a89-296">To enable WebSockets, expand the following nodes: **World Wide Web Services** > **Application Development Features** .</span></span> <span data-ttu-id="88a89-297">Wybierz funkcję **protokołu WebSocket** .</span><span class="sxs-lookup"><span data-stu-id="88a89-297">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="88a89-298">Aby uzyskać więcej informacji, zobacz [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="88a89-298">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="88a89-299">Jeśli instalacja usług IIS wymaga ponownego uruchomienia, należy ponownie uruchomić system.</span><span class="sxs-lookup"><span data-stu-id="88a89-299">If the IIS installation requires a restart, restart the system.</span></span>

![Konsola zarządzania usługami IIS i usługi World Wide Web są wybrane w funkcjach systemu Windows.](index/_static/windows-features-win10.png)

## <a name="install-the-net-core-hosting-bundle"></a><span data-ttu-id="88a89-301">Zainstaluj pakiet hostingu platformy .NET Core</span><span class="sxs-lookup"><span data-stu-id="88a89-301">Install the .NET Core Hosting Bundle</span></span>

<span data-ttu-id="88a89-302">Zainstaluj *pakiet hostingu platformy .NET Core* w systemie hostingu.</span><span class="sxs-lookup"><span data-stu-id="88a89-302">Install the *.NET Core Hosting Bundle* on the hosting system.</span></span> <span data-ttu-id="88a89-303">Pakiet instaluje środowisko uruchomieniowe programu .NET Core, bibliotekę .NET Core i [moduł ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="88a89-303">The bundle installs the .NET Core Runtime, .NET Core Library, and the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="88a89-304">Moduł umożliwia uruchamianie aplikacji ASP.NET Core za pomocą usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-304">The module allows ASP.NET Core apps to run behind IIS.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="88a89-305">Jeśli pakiet hostingu jest zainstalowany przed usługami IIS, należy naprawić pakiet instalacyjny.</span><span class="sxs-lookup"><span data-stu-id="88a89-305">If the Hosting Bundle is installed before IIS, the bundle installation must be repaired.</span></span> <span data-ttu-id="88a89-306">Uruchom ponownie Instalatora pakietu hostingu po zainstalowaniu usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-306">Run the Hosting Bundle installer again after installing IIS.</span></span>
>
> <span data-ttu-id="88a89-307">Jeśli pakiet hostingu jest instalowany po zainstalowaniu 64-bitowej (x64) wersji programu .NET Core, prawdopodobnie brakuje zestawów SDK ([nie wykryto żadnych zestawów SDK dla platformy .NET Core](xref:test/troubleshoot#no-net-core-sdks-were-detected)).</span><span class="sxs-lookup"><span data-stu-id="88a89-307">If the Hosting Bundle is installed after installing the 64-bit (x64) version of .NET Core, SDKs might appear to be missing ([No .NET Core SDKs were detected](xref:test/troubleshoot#no-net-core-sdks-were-detected)).</span></span> <span data-ttu-id="88a89-308">Aby rozwiązać ten problem, zobacz <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle> .</span><span class="sxs-lookup"><span data-stu-id="88a89-308">To resolve the problem, see <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle>.</span></span>

### <a name="direct-download-current-version"></a><span data-ttu-id="88a89-309">Pobieranie bezpośrednie (aktualna wersja)</span><span class="sxs-lookup"><span data-stu-id="88a89-309">Direct download (current version)</span></span>

<span data-ttu-id="88a89-310">Pobierz instalatora przy użyciu następującego linku:</span><span class="sxs-lookup"><span data-stu-id="88a89-310">Download the installer using the following link:</span></span>

[<span data-ttu-id="88a89-311">Bieżący Instalator pakietu hostingu platformy .NET Core (Pobieranie bezpośrednie)</span><span class="sxs-lookup"><span data-stu-id="88a89-311">Current .NET Core Hosting Bundle installer (direct download)</span></span>](https://dotnet.microsoft.com/permalink/dotnetcore-current-windows-runtime-bundle-installer)

### <a name="earlier-versions-of-the-installer"></a><span data-ttu-id="88a89-312">Starsze wersje Instalatora</span><span class="sxs-lookup"><span data-stu-id="88a89-312">Earlier versions of the installer</span></span>

<span data-ttu-id="88a89-313">Aby uzyskać wcześniejszą wersję Instalatora:</span><span class="sxs-lookup"><span data-stu-id="88a89-313">To obtain an earlier version of the installer:</span></span>

1. <span data-ttu-id="88a89-314">Przejdź do strony [pobieranie platformy .NET Core](https://dotnet.microsoft.com/download/dotnet-core) .</span><span class="sxs-lookup"><span data-stu-id="88a89-314">Navigate to the [Download .NET Core](https://dotnet.microsoft.com/download/dotnet-core) page.</span></span>
1. <span data-ttu-id="88a89-315">Wybierz żądaną wersję programu .NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-315">Select the desired .NET Core version.</span></span>
1. <span data-ttu-id="88a89-316">W kolumnie **Uruchom aplikacje — środowisko uruchomieniowe** Znajdź wiersz żądanej wersji środowiska uruchomieniowego platformy .NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-316">In the **Run apps - Runtime** column, find the row of the .NET Core runtime version desired.</span></span>
1. <span data-ttu-id="88a89-317">Pobierz instalatora przy użyciu linku do **pakietu hostingu** .</span><span class="sxs-lookup"><span data-stu-id="88a89-317">Download the installer using the **Hosting Bundle** link.</span></span>

> [!WARNING]
> <span data-ttu-id="88a89-318">Niektóre Instalatory zawierają wersje wydania, które osiągnęły koniec cyklu życia (EOL) i nie są już obsługiwane przez firmę Microsoft.</span><span class="sxs-lookup"><span data-stu-id="88a89-318">Some installers contain release versions that have reached their end of life (EOL) and are no longer supported by Microsoft.</span></span> <span data-ttu-id="88a89-319">Aby uzyskać więcej informacji, zobacz [zasady pomocy technicznej](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span><span class="sxs-lookup"><span data-stu-id="88a89-319">For more information, see the [support policy](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span></span>

### <a name="install-the-hosting-bundle"></a><span data-ttu-id="88a89-320">Zainstaluj pakiet hostingu</span><span class="sxs-lookup"><span data-stu-id="88a89-320">Install the Hosting Bundle</span></span>

1. <span data-ttu-id="88a89-321">Uruchom Instalatora na serwerze.</span><span class="sxs-lookup"><span data-stu-id="88a89-321">Run the installer on the server.</span></span> <span data-ttu-id="88a89-322">Następujące parametry są dostępne podczas uruchamiania Instalatora z powłoki poleceń administratora:</span><span class="sxs-lookup"><span data-stu-id="88a89-322">The following parameters are available when running the installer from an administrator command shell:</span></span>

   * <span data-ttu-id="88a89-323">`OPT_NO_ANCM=1`: Pomiń Instalowanie modułu ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-323">`OPT_NO_ANCM=1`: Skip installing the ASP.NET Core Module.</span></span>
   * <span data-ttu-id="88a89-324">`OPT_NO_RUNTIME=1`: Pomiń Instalowanie środowiska uruchomieniowego platformy .NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-324">`OPT_NO_RUNTIME=1`: Skip installing the .NET Core runtime.</span></span> <span data-ttu-id="88a89-325">Używany, gdy serwer obsługuje tylko [wdrożenia samodzielne (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span><span class="sxs-lookup"><span data-stu-id="88a89-325">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="88a89-326">`OPT_NO_SHAREDFX=1`: Pomiń instalację ASP.NET Shared Framework (ASP.NET Runtime).</span><span class="sxs-lookup"><span data-stu-id="88a89-326">`OPT_NO_SHAREDFX=1`: Skip installing the ASP.NET Shared Framework (ASP.NET runtime).</span></span> <span data-ttu-id="88a89-327">Używany, gdy serwer obsługuje tylko [wdrożenia samodzielne (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span><span class="sxs-lookup"><span data-stu-id="88a89-327">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="88a89-328">`OPT_NO_X86=1`: Pomiń Instalowanie środowiska uruchomieniowego x86.</span><span class="sxs-lookup"><span data-stu-id="88a89-328">`OPT_NO_X86=1`: Skip installing x86 runtimes.</span></span> <span data-ttu-id="88a89-329">Użyj tego parametru, Jeśli wiesz, że nie będziesz hostować aplikacji 32-bitowych.</span><span class="sxs-lookup"><span data-stu-id="88a89-329">Use this parameter when you know that you won't be hosting 32-bit apps.</span></span> <span data-ttu-id="88a89-330">Jeśli w przyszłości będziesz hostować zarówno aplikacje 32-bitowe, jak i 64-bitowe, nie używaj tego parametru i zainstaluj oba środowiska uruchomieniowe.</span><span class="sxs-lookup"><span data-stu-id="88a89-330">If there's any chance that you will host both 32-bit and 64-bit apps in the future, don't use this parameter and install both runtimes.</span></span>
   * <span data-ttu-id="88a89-331">`OPT_NO_SHARED_CONFIG_CHECK=1`: Wyłącz sprawdzanie przy użyciu konfiguracji udostępnionej usług IIS, gdy konfiguracja udostępniona ( `applicationHost.config` ) znajduje się na tym samym komputerze, na którym zainstalowano program IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-331">`OPT_NO_SHARED_CONFIG_CHECK=1`: Disable the check for using an IIS Shared Configuration when the shared configuration (`applicationHost.config`) is on the same machine as the IIS installation.</span></span> <span data-ttu-id="88a89-332">*Dostępne tylko w przypadku ASP.NET Core 2,2 lub nowszych instalatorów pakietu do obsługi.*</span><span class="sxs-lookup"><span data-stu-id="88a89-332">*Only available for ASP.NET Core 2.2 or later Hosting Bundler installers.*</span></span> <span data-ttu-id="88a89-333">Aby uzyskać więcej informacji, zobacz <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span><span class="sxs-lookup"><span data-stu-id="88a89-333">For more information, see <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span></span>
1. <span data-ttu-id="88a89-334">Uruchom ponownie system lub wykonaj następujące polecenia w powłoce poleceń:</span><span class="sxs-lookup"><span data-stu-id="88a89-334">Restart the system or execute the following commands in a command shell:</span></span>

   ```console
   net stop was /y
   net start w3svc
   ```
   <span data-ttu-id="88a89-335">Ponowne uruchomienie usług IIS powoduje zmianę ścieżki systemowej, która jest zmienną środowiskową, wykonaną przez Instalatora.</span><span class="sxs-lookup"><span data-stu-id="88a89-335">Restarting IIS picks up a change to the system PATH, which is an environment variable, made by the installer.</span></span>

<span data-ttu-id="88a89-336">ASP.NET Core nie przyjmuje zachowania z przekazaniem do przodu dla wersji poprawki współużytkowanych pakietów platformy.</span><span class="sxs-lookup"><span data-stu-id="88a89-336">ASP.NET Core doesn't adopt roll-forward behavior for patch releases of shared framework packages.</span></span> <span data-ttu-id="88a89-337">Po uaktualnieniu udostępnionej platformy, instalując nowy pakiet hostingu, ponownie uruchom system lub wykonaj następujące polecenia w powłoce poleceń:</span><span class="sxs-lookup"><span data-stu-id="88a89-337">After upgrading the shared framework by installing a new hosting bundle, restart the system or execute the following commands in a command shell:</span></span>

```console
net stop was /y
net start w3svc
```

> [!NOTE]
> <span data-ttu-id="88a89-338">Aby uzyskać informacje na temat konfiguracji udostępnionej usług IIS, zobacz [ASP.NET Core Module z udostępnioną konfiguracją usług IIS](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span><span class="sxs-lookup"><span data-stu-id="88a89-338">For information on IIS Shared Configuration, see [ASP.NET Core Module with IIS Shared Configuration](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span></span>

## <a name="install-web-deploy-when-publishing-with-visual-studio"></a><span data-ttu-id="88a89-339">Zainstaluj Web Deploy przy publikowaniu w programie Visual Studio</span><span class="sxs-lookup"><span data-stu-id="88a89-339">Install Web Deploy when publishing with Visual Studio</span></span>

<span data-ttu-id="88a89-340">Podczas wdrażania aplikacji na serwerach z [Web Deploy](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later)Zainstaluj najnowszą wersję Web Deploy na serwerze.</span><span class="sxs-lookup"><span data-stu-id="88a89-340">When deploying apps to servers with [Web Deploy](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later), install the latest version of Web Deploy on the server.</span></span> <span data-ttu-id="88a89-341">Aby zainstalować Web Deploy, należy użyć [Instalatora platformy sieci Web (Instalatora WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) lub uzyskać instalatora bezpośrednio z [Centrum pobierania Microsoft](https://www.microsoft.com/download/details.aspx?id=43717).</span><span class="sxs-lookup"><span data-stu-id="88a89-341">To install Web Deploy, use the [Web Platform Installer (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) or obtain an installer directly from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=43717).</span></span> <span data-ttu-id="88a89-342">Preferowaną metodą jest użycie Instalatora WebPI.</span><span class="sxs-lookup"><span data-stu-id="88a89-342">The preferred method is to use WebPI.</span></span> <span data-ttu-id="88a89-343">Instalatora WebPI oferuje autonomiczną konfigurację i konfigurację dla dostawców hostingu.</span><span class="sxs-lookup"><span data-stu-id="88a89-343">WebPI offers a standalone setup and a configuration for hosting providers.</span></span>

## <a name="create-the-iis-site"></a><span data-ttu-id="88a89-344">Tworzenie witryny usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-344">Create the IIS site</span></span>

1. <span data-ttu-id="88a89-345">W systemie hostingu Utwórz folder, który będzie zawierać opublikowane foldery i pliki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-345">On the hosting system, create a folder to contain the app's published folders and files.</span></span> <span data-ttu-id="88a89-346">W poniższym kroku ścieżka folderu jest dostarczana do usług IIS jako ścieżka fizyczna do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-346">In a following step, the folder's path is provided to IIS as the physical path to the app.</span></span> <span data-ttu-id="88a89-347">Aby uzyskać więcej informacji na temat folderu wdrożenia aplikacji i układu pliku, zobacz <xref:host-and-deploy/directory-structure> .</span><span class="sxs-lookup"><span data-stu-id="88a89-347">For more information on an app's deployment folder and file layout, see <xref:host-and-deploy/directory-structure>.</span></span>

1. <span data-ttu-id="88a89-348">W Menedżerze usług IIS Otwórz węzeł serwera w panelu **połączenia** .</span><span class="sxs-lookup"><span data-stu-id="88a89-348">In IIS Manager, open the server's node in the **Connections** panel.</span></span> <span data-ttu-id="88a89-349">Kliknij prawym przyciskiem myszy folder **sitess** .</span><span class="sxs-lookup"><span data-stu-id="88a89-349">Right-click the **Sites** folder.</span></span> <span data-ttu-id="88a89-350">Wybierz pozycję **Dodaj witrynę internetową** z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="88a89-350">Select **Add Website** from the contextual menu.</span></span>

1. <span data-ttu-id="88a89-351">Podaj **nazwę lokacji** i ustaw **ścieżkę fizyczną** folderu wdrożenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-351">Provide a **Site name** and set the **Physical path** to the app's deployment folder.</span></span> <span data-ttu-id="88a89-352">Podaj konfigurację **powiązania** i Utwórz witrynę sieci Web, wybierając **przycisk OK** :</span><span class="sxs-lookup"><span data-stu-id="88a89-352">Provide the **Binding** configuration and create the website by selecting **OK** :</span></span>

   ![Podaj nazwę lokacji, ścieżkę fizyczną i nazwę hosta w kroku Dodaj witrynę sieci Web.](index/_static/add-website-ws2016.png)

   > [!WARNING]
   > <span data-ttu-id="88a89-354">`http://*:80/` `http://+:80` **Nie** należy używać powiązań z symbolami wieloznacznymi (i) najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="88a89-354">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="88a89-355">Powiązania z symbolami wieloznacznymi najwyższego poziomu mogą otwierać aplikację pod kątem luk w zabezpieczeniach.</span><span class="sxs-lookup"><span data-stu-id="88a89-355">Top-level wildcard bindings can open up your app to security vulnerabilities.</span></span> <span data-ttu-id="88a89-356">Dotyczy to zarówno silnych, jak i słabych symboli wieloznacznych.</span><span class="sxs-lookup"><span data-stu-id="88a89-356">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="88a89-357">Używaj jawnych nazw hostów zamiast symboli wieloznacznych.</span><span class="sxs-lookup"><span data-stu-id="88a89-357">Use explicit host names rather than wildcards.</span></span> <span data-ttu-id="88a89-358">Powiązanie symboli wieloznacznych z poddomeną (na przykład `*.mysub.com` ) nie ma tego ryzyka bezpieczeństwa, jeśli kontrolujesz całą domenę nadrzędną (w przeciwieństwie do `*.com` , która jest narażona).</span><span class="sxs-lookup"><span data-stu-id="88a89-358">Subdomain wildcard binding (for example, `*.mysub.com`) doesn't have this security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="88a89-359">Aby uzyskać więcej informacji, zobacz [sekcję rfc7230-5,4](https://tools.ietf.org/html/rfc7230#section-5.4) .</span><span class="sxs-lookup"><span data-stu-id="88a89-359">See [rfc7230 section-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) for more information.</span></span>

1. <span data-ttu-id="88a89-360">W węźle serwera wybierz pozycję **Pule aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-360">Under the server's node, select **Application Pools** .</span></span>

1. <span data-ttu-id="88a89-361">Kliknij prawym przyciskiem myszy pulę aplikacji lokacji i wybierz pozycję **Ustawienia podstawowe** z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="88a89-361">Right-click the site's app pool and select **Basic Settings** from the contextual menu.</span></span>

1. <span data-ttu-id="88a89-362">W oknie **Edytowanie puli aplikacji** Ustaw **wersję środowiska .NET CLR** na **Brak kodu zarządzanego** :</span><span class="sxs-lookup"><span data-stu-id="88a89-362">In the **Edit Application Pool** window, set the **.NET CLR version** to **No Managed Code** :</span></span>

   ![Nie ustawiaj kodu zarządzanego dla wersji środowiska .NET CLR.](index/_static/edit-apppool-ws2016.png)

    <span data-ttu-id="88a89-364">ASP.NET Core działa w osobnym procesie i zarządza środowiskiem uruchomieniowym.</span><span class="sxs-lookup"><span data-stu-id="88a89-364">ASP.NET Core runs in a separate process and manages the runtime.</span></span> <span data-ttu-id="88a89-365">ASP.NET Core nie polega na ładowaniu programu Desktop CLR (.NET CLR).</span><span class="sxs-lookup"><span data-stu-id="88a89-365">ASP.NET Core doesn't rely on loading the desktop CLR (.NET CLR).</span></span> <span data-ttu-id="88a89-366">Podstawowe środowisko uruchomieniowe języka wspólnego (CoreCLR) dla platformy .NET Core jest uruchamiane w celu hostowania aplikacji w procesie roboczym.</span><span class="sxs-lookup"><span data-stu-id="88a89-366">The Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process.</span></span> <span data-ttu-id="88a89-367">Ustawienie **wersji środowiska .NET CLR** na **Brak kodu zarządzanego** jest opcjonalne, ale zalecane.</span><span class="sxs-lookup"><span data-stu-id="88a89-367">Setting the **.NET CLR version** to **No Managed Code** is optional but recommended.</span></span>

1. <span data-ttu-id="88a89-368">*ASP.NET Core 2,2 lub nowszy* :</span><span class="sxs-lookup"><span data-stu-id="88a89-368">*ASP.NET Core 2.2 or later* :</span></span>

   * <span data-ttu-id="88a89-369">W przypadku 32-bitowego (x86) [wdrożenia](/dotnet/core/deploying/#self-contained-deployments-scd) opublikowanego z 32-bitowym zestawem SDK, który korzysta z [modelu hostingu w procesie](#in-process-hosting-model), należy włączyć pulę aplikacji dla 32-bitowego.</span><span class="sxs-lookup"><span data-stu-id="88a89-369">For a 32-bit (x86) [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd) published with a 32-bit SDK that uses the [in-process hosting model](#in-process-hosting-model), enable the Application Pool for 32-bit.</span></span> <span data-ttu-id="88a89-370">W Menedżerze usług IIS przejdź do **pul aplikacji** na pasku bocznym **połączenia** .</span><span class="sxs-lookup"><span data-stu-id="88a89-370">In IIS Manager, navigate to **Application Pools** in the **Connections** sidebar.</span></span> <span data-ttu-id="88a89-371">Wybierz pulę aplikacji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-371">Select the app's Application Pool.</span></span> <span data-ttu-id="88a89-372">Na pasku bocznym **Akcje** wybierz pozycję **Ustawienia zaawansowane** .</span><span class="sxs-lookup"><span data-stu-id="88a89-372">In the **Actions** sidebar, select **Advanced Settings** .</span></span> <span data-ttu-id="88a89-373">Ustaw dla opcji **Włącz aplikacje 32-bitowe** `True` .</span><span class="sxs-lookup"><span data-stu-id="88a89-373">Set **Enable 32-Bit Applications** to `True`.</span></span> 

   * <span data-ttu-id="88a89-374">W przypadku [wdrożenia](/dotnet/core/deploying/#self-contained-deployments-scd) z systemem 64-bitowym (x64), które używa [modelu hostingu w procesie](#in-process-hosting-model), wyłącz pulę aplikacji dla procesów 32-bitowych (x86).</span><span class="sxs-lookup"><span data-stu-id="88a89-374">For a 64-bit (x64) [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd) that uses the [in-process hosting model](#in-process-hosting-model), disable the app pool for 32-bit (x86) processes.</span></span> <span data-ttu-id="88a89-375">W Menedżerze usług IIS przejdź do **pul aplikacji** na pasku bocznym **połączenia** .</span><span class="sxs-lookup"><span data-stu-id="88a89-375">In IIS Manager, navigate to **Application Pools** in the **Connections** sidebar.</span></span> <span data-ttu-id="88a89-376">Wybierz pulę aplikacji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-376">Select the app's Application Pool.</span></span> <span data-ttu-id="88a89-377">Na pasku bocznym **Akcje** wybierz pozycję **Ustawienia zaawansowane** .</span><span class="sxs-lookup"><span data-stu-id="88a89-377">In the **Actions** sidebar, select **Advanced Settings** .</span></span> <span data-ttu-id="88a89-378">Ustaw dla opcji **Włącz aplikacje 32-bitowe** `False` .</span><span class="sxs-lookup"><span data-stu-id="88a89-378">Set **Enable 32-Bit Applications** to `False`.</span></span> 

1. <span data-ttu-id="88a89-379">Potwierdź, że tożsamość modelu procesu ma odpowiednie uprawnienia.</span><span class="sxs-lookup"><span data-stu-id="88a89-379">Confirm the process model identity has the proper permissions.</span></span>

   <span data-ttu-id="88a89-380">Jeśli domyślna tożsamość puli aplikacji ( **model procesów**  >  **Identity** ) została zmieniona z **ApplicationPool Identity** na inną tożsamość, sprawdź, czy Nowa tożsamość ma wymagane uprawnienia dostępu do folderu, bazy danych i innych wymaganych zasobów aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-380">If the default identity of the app pool ( **Process Model** > **Identity** ) is changed from **ApplicationPoolIdentity** to another identity, verify that the new identity has the required permissions to access the app's folder, database, and other required resources.</span></span> <span data-ttu-id="88a89-381">Na przykład Pula aplikacji wymaga dostępu do odczytu i zapisu do folderów, w których aplikacja odczytuje i zapisuje pliki.</span><span class="sxs-lookup"><span data-stu-id="88a89-381">For example, the app pool requires read and write access to folders where the app reads and writes files.</span></span>

<span data-ttu-id="88a89-382">**Konfiguracja uwierzytelniania systemu Windows (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-382">**Windows Authentication configuration (Optional)**</span></span>  
<span data-ttu-id="88a89-383">Aby uzyskać więcej informacji, zobacz [Konfigurowanie uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-383">For more information, see [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

## <a name="deploy-the-app"></a><span data-ttu-id="88a89-384">Wdrażanie aplikacji</span><span class="sxs-lookup"><span data-stu-id="88a89-384">Deploy the app</span></span>

<span data-ttu-id="88a89-385">Wdróż aplikację w folderze **ścieżki fizycznej** usług IIS, który został ustanowiony w sekcji [Tworzenie witryny usług IIS](#create-the-iis-site) .</span><span class="sxs-lookup"><span data-stu-id="88a89-385">Deploy the app to the IIS **Physical path** folder that was established in the [Create the IIS site](#create-the-iis-site) section.</span></span> <span data-ttu-id="88a89-386">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) jest zalecanym mechanizmem wdrażania, ale istnieje kilka opcji przeniesienia aplikacji z `publish` folderu projektu do folderu wdrożenia systemu hostingu.</span><span class="sxs-lookup"><span data-stu-id="88a89-386">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) is the recommended mechanism for deployment, but several options exist for moving the app from the project's `publish` folder to the hosting system's deployment folder.</span></span>

### <a name="web-deploy-with-visual-studio"></a><span data-ttu-id="88a89-387">Web Deploy z programem Visual Studio</span><span class="sxs-lookup"><span data-stu-id="88a89-387">Web Deploy with Visual Studio</span></span>

<span data-ttu-id="88a89-388">Aby dowiedzieć się, jak utworzyć profil publikowania do użytku z usługą Web Deploy, zobacz temat [Profile publikacji programu Visual Studio dla wdrożenia aplikacji ASP.NET Core](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) .</span><span class="sxs-lookup"><span data-stu-id="88a89-388">See the [Visual Studio publish profiles for ASP.NET Core app deployment](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) topic to learn how to create a publish profile for use with Web Deploy.</span></span> <span data-ttu-id="88a89-389">Jeśli dostawca hostingu udostępnia profil publikowania lub obsługę tworzenia aplikacji, pobierz swój profil i zaimportuj go za pomocą okna dialogowego **publikowania** programu Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="88a89-389">If the hosting provider provides a Publish Profile or support for creating one, download their profile and import it using the Visual Studio **Publish** dialog:</span></span>

![Strona okna dialogowego publikowanie](index/_static/pub-dialog.png)

### <a name="web-deploy-outside-of-visual-studio"></a><span data-ttu-id="88a89-391">Web Deploy poza programem Visual Studio</span><span class="sxs-lookup"><span data-stu-id="88a89-391">Web Deploy outside of Visual Studio</span></span>

<span data-ttu-id="88a89-392">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) można również użyć poza programem Visual Studio z wiersza polecenia.</span><span class="sxs-lookup"><span data-stu-id="88a89-392">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) can also be used outside of Visual Studio from the command line.</span></span> <span data-ttu-id="88a89-393">Aby uzyskać więcej informacji, zobacz [Narzędzie do wdrażania w sieci Web](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span><span class="sxs-lookup"><span data-stu-id="88a89-393">For more information, see [Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span></span>

### <a name="alternatives-to-web-deploy"></a><span data-ttu-id="88a89-394">Alternatywy dla Web Deploy</span><span class="sxs-lookup"><span data-stu-id="88a89-394">Alternatives to Web Deploy</span></span>

<span data-ttu-id="88a89-395">Użyj dowolnej z kilku metod, aby przenieść aplikację do systemu hostingu, takich jak ręczna kopia, [xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy)lub [PowerShell](/powershell/).</span><span class="sxs-lookup"><span data-stu-id="88a89-395">Use any of several methods to move the app to the hosting system, such as manual copy, [Xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy), or [PowerShell](/powershell/).</span></span>

<span data-ttu-id="88a89-396">Aby uzyskać więcej informacji na ASP.NET Core wdrażania usług IIS, zobacz sekcję [zasoby wdrażania dla administratorów usług IIS](#deployment-resources-for-iis-administrators) .</span><span class="sxs-lookup"><span data-stu-id="88a89-396">For more information on ASP.NET Core deployment to IIS, see the [Deployment resources for IIS administrators](#deployment-resources-for-iis-administrators) section.</span></span>

## <a name="browse-the-website"></a><span data-ttu-id="88a89-397">Przeglądanie witryny sieci Web</span><span class="sxs-lookup"><span data-stu-id="88a89-397">Browse the website</span></span>

<span data-ttu-id="88a89-398">Po wdrożeniu aplikacji w systemie hostingu należy wysłać żądanie do jednej z publicznych punktów końcowych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-398">After the app is deployed to the hosting system, make a request to one of the app's public endpoints.</span></span>

<span data-ttu-id="88a89-399">W poniższym przykładzie lokacja jest powiązana z **nazwą hosta** usług IIS `www.mysite.com` na **porcie** `80` .</span><span class="sxs-lookup"><span data-stu-id="88a89-399">In the following example, the site is bound to an IIS **Host name** of `www.mysite.com` on **Port** `80`.</span></span> <span data-ttu-id="88a89-400">Zostanie wysłane żądanie `http://www.mysite.com` :</span><span class="sxs-lookup"><span data-stu-id="88a89-400">A request is made to `http://www.mysite.com`:</span></span>

![Przeglądarka Microsoft Edge załadowała stronę startową usług IIS.](index/_static/browsewebsite.png)

## <a name="locked-deployment-files"></a><span data-ttu-id="88a89-402">Zablokowane pliki wdrożenia</span><span class="sxs-lookup"><span data-stu-id="88a89-402">Locked deployment files</span></span>

<span data-ttu-id="88a89-403">Pliki w folderze wdrożenia są zablokowane, gdy aplikacja jest uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="88a89-403">Files in the deployment folder are locked when the app is running.</span></span> <span data-ttu-id="88a89-404">Nie można zastąpić zablokowanych plików podczas wdrażania.</span><span class="sxs-lookup"><span data-stu-id="88a89-404">Locked files can't be overwritten during deployment.</span></span> <span data-ttu-id="88a89-405">Aby zwolnić zablokowane pliki we wdrożeniu, Zatrzymaj pulę aplikacji, korzystając z **jednej** z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="88a89-405">To release locked files in a deployment, stop the app pool using **one** of the following approaches:</span></span>

* <span data-ttu-id="88a89-406">Użyj Web Deploy i Reference `Microsoft.NET.Sdk.Web` w pliku projektu.</span><span class="sxs-lookup"><span data-stu-id="88a89-406">Use Web Deploy and reference `Microsoft.NET.Sdk.Web` in the project file.</span></span> <span data-ttu-id="88a89-407">`app_offline.htm`Plik jest umieszczany w katalogu głównym katalogu aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="88a89-407">An `app_offline.htm` file is placed at the root of the web app directory.</span></span> <span data-ttu-id="88a89-408">Gdy plik jest obecny, moduł ASP.NET Core prawidłowo zamyka aplikację i udostępnia `app_offline.htm` plik podczas wdrażania.</span><span class="sxs-lookup"><span data-stu-id="88a89-408">When the file is present, the ASP.NET Core Module gracefully shuts down the app and serves the `app_offline.htm` file during the deployment.</span></span> <span data-ttu-id="88a89-409">Aby uzyskać więcej informacji, zobacz [Informacje o konfiguracji modułu ASP.NET Core](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span><span class="sxs-lookup"><span data-stu-id="88a89-409">For more information, see the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span></span>
* <span data-ttu-id="88a89-410">Ręcznie Zatrzymaj pulę aplikacji w Menedżerze usług IIS na serwerze.</span><span class="sxs-lookup"><span data-stu-id="88a89-410">Manually stop the app pool in the IIS Manager on the server.</span></span>
* <span data-ttu-id="88a89-411">Użyj programu PowerShell do porzucenia `app_offline.htm` (wymaga programu PowerShell 5 lub nowszego):</span><span class="sxs-lookup"><span data-stu-id="88a89-411">Use PowerShell to drop `app_offline.htm` (requires PowerShell 5 or later):</span></span>

  ```powershell
  $pathToApp = 'PATH_TO_APP'

  # Stop the AppPool
  New-Item -Path $pathToApp app_offline.htm

  # Provide script commands here to deploy the app

  # Restart the AppPool
  Remove-Item -Path $pathToApp app_offline.htm
  ```

## <a name="data-protection"></a><span data-ttu-id="88a89-412">Ochrona danych</span><span class="sxs-lookup"><span data-stu-id="88a89-412">Data protection</span></span>

<span data-ttu-id="88a89-413">[Stos ochrony danych ASP.NET Core](xref:security/data-protection/introduction) jest używany przez kilka ASP.NET Core [middlewares](xref:fundamentals/middleware/index), w tym oprogramowanie pośredniczące używane podczas uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="88a89-413">The [ASP.NET Core Data Protection stack](xref:security/data-protection/introduction) is used by several ASP.NET Core [middlewares](xref:fundamentals/middleware/index), including middleware used in authentication.</span></span> <span data-ttu-id="88a89-414">Nawet jeśli interfejsy API ochrony danych nie są wywoływane przez kod użytkownika, należy skonfigurować ochronę danych przy użyciu skryptu wdrożenia lub w kodzie użytkownika, aby utworzyć trwały [Magazyn kluczy](xref:security/data-protection/implementation/key-management)kryptograficznych.</span><span class="sxs-lookup"><span data-stu-id="88a89-414">Even if Data Protection APIs aren't called by user code, data protection should be configured with a deployment script or in user code to create a persistent cryptographic [key store](xref:security/data-protection/implementation/key-management).</span></span> <span data-ttu-id="88a89-415">Jeśli ochrona danych nie jest skonfigurowana, klucze są przechowywane w pamięci i usuwane po ponownym uruchomieniu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-415">If data protection isn't configured, the keys are held in memory and discarded when the app restarts.</span></span>

<span data-ttu-id="88a89-416">Jeśli pierścień kluczy jest przechowywany w pamięci po ponownym uruchomieniu aplikacji:</span><span class="sxs-lookup"><span data-stu-id="88a89-416">If the key ring is stored in memory when the app restarts:</span></span>

* <span data-ttu-id="88a89-417">cookieTokeny uwierzytelniania na podstawie wszystkich są unieważnione.</span><span class="sxs-lookup"><span data-stu-id="88a89-417">All cookie-based authentication tokens are invalidated.</span></span> 
* <span data-ttu-id="88a89-418">Użytkownicy muszą ponownie zalogować się przy następnym żądaniu.</span><span class="sxs-lookup"><span data-stu-id="88a89-418">Users are required to sign in again on their next request.</span></span> 
* <span data-ttu-id="88a89-419">Nie można już odszyfrować żadnych danych chronionych za pomocą dzwonka klucza.</span><span class="sxs-lookup"><span data-stu-id="88a89-419">Any data protected with the key ring can no longer be decrypted.</span></span> <span data-ttu-id="88a89-420">Może to obejmować [tokeny CSRF](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) i [ASP.NET Core MVC TempData cookie s](xref:fundamentals/app-state#tempdata).</span><span class="sxs-lookup"><span data-stu-id="88a89-420">This may include [CSRF tokens](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) and [ASP.NET Core MVC TempData cookies](xref:fundamentals/app-state#tempdata).</span></span>

<span data-ttu-id="88a89-421">Aby skonfigurować ochronę danych w ramach usług IIS w celu utrwalenia pierścienia kluczy, należy użyć **jednej** z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="88a89-421">To configure data protection under IIS to persist the key ring, use **one** of the following approaches:</span></span>

* <span data-ttu-id="88a89-422">**Tworzenie kluczy rejestru ochrony danych**</span><span class="sxs-lookup"><span data-stu-id="88a89-422">**Create Data Protection Registry Keys**</span></span>

  <span data-ttu-id="88a89-423">Klucze ochrony danych używane przez aplikacje ASP.NET Core są przechowywane w rejestrze zewnętrznym dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-423">Data protection keys used by ASP.NET Core apps are stored in the registry external to the apps.</span></span> <span data-ttu-id="88a89-424">Aby utrzymać klucze dla danej aplikacji, należy utworzyć klucze rejestru dla puli aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-424">To persist the keys for a given app, create registry keys for the app pool.</span></span>

  <span data-ttu-id="88a89-425">W przypadku autonomicznych, nieopartych na webfarmie instalacji usług IIS [skrypt ochrony danych Provision-AutoGenKeys.ps1 programu PowerShell](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) może być używany dla każdej puli aplikacji używanej w aplikacji ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-425">For standalone, non-webfarm IIS installations, the [Data Protection Provision-AutoGenKeys.ps1 PowerShell script](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) can be used for each app pool used with an ASP.NET Core app.</span></span> <span data-ttu-id="88a89-426">Ten skrypt tworzy klucz rejestru w rejestrze HKLM, który jest dostępny tylko dla konta procesu roboczego puli aplikacji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-426">This script creates a registry key in the HKLM registry that's accessible only to the worker process account of the app's app pool.</span></span> <span data-ttu-id="88a89-427">Klucze są szyfrowane przy użyciu funkcji DPAPI z kluczem dla całego komputera.</span><span class="sxs-lookup"><span data-stu-id="88a89-427">Keys are encrypted at rest using DPAPI with a machine-wide key.</span></span>

  <span data-ttu-id="88a89-428">W scenariuszach farmy sieci Web aplikacja może być skonfigurowana pod kątem używania ścieżki UNC do przechowywania tego dzwonka klucza ochrony danych.</span><span class="sxs-lookup"><span data-stu-id="88a89-428">In web farm scenarios, an app can be configured to use a UNC path to store its data protection key ring.</span></span> <span data-ttu-id="88a89-429">Domyślnie klucze ochrony danych nie są szyfrowane.</span><span class="sxs-lookup"><span data-stu-id="88a89-429">By default, the data protection keys aren't encrypted.</span></span> <span data-ttu-id="88a89-430">Upewnij się, że uprawnienia do pliku dla udziału sieciowego są ograniczone do konta systemu Windows, w którym jest uruchamiana aplikacja.</span><span class="sxs-lookup"><span data-stu-id="88a89-430">Ensure that the file permissions for the network share are limited to the Windows account the app runs under.</span></span> <span data-ttu-id="88a89-431">Certyfikat x509 może służyć do ochrony kluczy w spoczynku.</span><span class="sxs-lookup"><span data-stu-id="88a89-431">An X509 certificate can be used to protect keys at rest.</span></span> <span data-ttu-id="88a89-432">Rozważ zastosowanie mechanizmu umożliwiającego użytkownikom przekazywanie certyfikatów: Umieść certyfikaty w zaufanym magazynie certyfikatów użytkownika i upewnij się, że są one dostępne na wszystkich komputerach, na których działa aplikacja użytkownika.</span><span class="sxs-lookup"><span data-stu-id="88a89-432">Consider a mechanism to allow users to upload certificates: Place certificates into the user's trusted certificate store and ensure they're available on all machines where the user's app runs.</span></span> <span data-ttu-id="88a89-433">Szczegóły można znaleźć w temacie [Konfigurowanie ochrony danych ASP.NET Core](xref:security/data-protection/configuration/overview) .</span><span class="sxs-lookup"><span data-stu-id="88a89-433">See [Configure ASP.NET Core Data Protection](xref:security/data-protection/configuration/overview) for details.</span></span>

* <span data-ttu-id="88a89-434">**Konfigurowanie puli aplikacji usług IIS w celu załadowania profilu użytkownika**</span><span class="sxs-lookup"><span data-stu-id="88a89-434">**Configure the IIS Application Pool to load the user profile**</span></span>

  <span data-ttu-id="88a89-435">To ustawienie znajduje się w sekcji **model procesów** w obszarze **Ustawienia zaawansowane** dla puli aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-435">This setting is in the **Process Model** section under the **Advanced Settings** for the app pool.</span></span> <span data-ttu-id="88a89-436">Ustaw **Załaduj profil użytkownika** na `True` .</span><span class="sxs-lookup"><span data-stu-id="88a89-436">Set **Load User Profile** to `True`.</span></span> <span data-ttu-id="88a89-437">Po ustawieniu opcji `True` klucze są przechowywane w katalogu profilu użytkownika i chronione przy użyciu funkcji DPAPI z kluczem specyficznym dla konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="88a89-437">When set to `True`, keys are stored in the user profile directory and protected using DPAPI with a key specific to the user account.</span></span> <span data-ttu-id="88a89-438">Klucze są utrwalane w folderze *% LocalAppData%/ASP.NET/dataprotection-Keys* .</span><span class="sxs-lookup"><span data-stu-id="88a89-438">Keys are persisted to the *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys* folder.</span></span>

  <span data-ttu-id="88a89-439">[Atrybut setProfileEnvironment](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) puli aplikacji również musi być włączony.</span><span class="sxs-lookup"><span data-stu-id="88a89-439">The app pool's [setProfileEnvironment attribute](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) must also be enabled.</span></span> <span data-ttu-id="88a89-440">Wartość domyślna `setProfileEnvironment` to `true` .</span><span class="sxs-lookup"><span data-stu-id="88a89-440">The default value of `setProfileEnvironment` is `true`.</span></span> <span data-ttu-id="88a89-441">W niektórych scenariuszach (na przykład system operacyjny Windows) `setProfileEnvironment` jest ustawiony na `false` .</span><span class="sxs-lookup"><span data-stu-id="88a89-441">In some scenarios (for example, Windows OS), `setProfileEnvironment` is set to `false`.</span></span> <span data-ttu-id="88a89-442">Jeśli klucze nie są przechowywane w katalogu profilu użytkownika zgodnie z oczekiwaniami:</span><span class="sxs-lookup"><span data-stu-id="88a89-442">If keys aren't stored in the user profile directory as expected:</span></span>

  1. <span data-ttu-id="88a89-443">Przejdź do folderu *% windir%/system32/inetsrv/config*</span><span class="sxs-lookup"><span data-stu-id="88a89-443">Navigate to the *%windir%/system32/inetsrv/config* folder.</span></span>
  1. <span data-ttu-id="88a89-444">Otwórz plik *applicationHost.config* .</span><span class="sxs-lookup"><span data-stu-id="88a89-444">Open the *applicationHost.config* file.</span></span>
  1. <span data-ttu-id="88a89-445">Znajdź `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` element.</span><span class="sxs-lookup"><span data-stu-id="88a89-445">Locate the `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` element.</span></span>
  1. <span data-ttu-id="88a89-446">Upewnij się, że `setProfileEnvironment` atrybut nie istnieje, który jest wartością domyślną `true` , lub jawnie ustaw wartość atrybutu na `true` .</span><span class="sxs-lookup"><span data-stu-id="88a89-446">Confirm that the `setProfileEnvironment` attribute isn't present, which defaults the value to `true`, or explicitly set the attribute's value to `true`.</span></span>

* <span data-ttu-id="88a89-447">**Używanie systemu plików jako magazynu kluczy**</span><span class="sxs-lookup"><span data-stu-id="88a89-447">**Use the file system as a key ring store**</span></span>

  <span data-ttu-id="88a89-448">Dostosuj kod aplikacji, [tak aby używał systemu plików jako magazynu kluczy](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="88a89-448">Adjust the app code to [use the file system as a key ring store](xref:security/data-protection/configuration/overview).</span></span> <span data-ttu-id="88a89-449">Użyj certyfikatu x509 do ochrony pierścienia kluczy i upewnij się, że certyfikat jest certyfikatem zaufanym.</span><span class="sxs-lookup"><span data-stu-id="88a89-449">Use an X509 certificate to protect the key ring and ensure the certificate is a trusted certificate.</span></span> <span data-ttu-id="88a89-450">Jeśli certyfikat jest podpisany z podpisem własnym, umieść certyfikat w zaufanym magazynie głównym.</span><span class="sxs-lookup"><span data-stu-id="88a89-450">If the certificate is self-signed, place the certificate in the Trusted Root store.</span></span>

  <span data-ttu-id="88a89-451">W przypadku korzystania z usług IIS w kolektywie serwerów sieci Web:</span><span class="sxs-lookup"><span data-stu-id="88a89-451">When using IIS in a web farm:</span></span>

  * <span data-ttu-id="88a89-452">Użyj udziału plików, do którego mają dostęp wszystkie maszyny.</span><span class="sxs-lookup"><span data-stu-id="88a89-452">Use a file share that all machines can access.</span></span>
  * <span data-ttu-id="88a89-453">Wdróż certyfikat x509 na każdym komputerze.</span><span class="sxs-lookup"><span data-stu-id="88a89-453">Deploy an X509 certificate to each machine.</span></span> <span data-ttu-id="88a89-454">Konfigurowanie [ochrony danych w kodzie](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="88a89-454">Configure [data protection in code](xref:security/data-protection/configuration/overview).</span></span>

* <span data-ttu-id="88a89-455">**Ustawianie zasad dla całej maszyny na potrzeby ochrony danych**</span><span class="sxs-lookup"><span data-stu-id="88a89-455">**Set a machine-wide policy for data protection**</span></span>

  <span data-ttu-id="88a89-456">System ochrony danych ma ograniczoną obsługę ustawiania domyślnych [zasad komputera](xref:security/data-protection/configuration/machine-wide-policy) dla wszystkich aplikacji korzystających z interfejsów API ochrony danych.</span><span class="sxs-lookup"><span data-stu-id="88a89-456">The data protection system has limited support for setting a default [machine-wide policy](xref:security/data-protection/configuration/machine-wide-policy) for all apps that consume the Data Protection APIs.</span></span> <span data-ttu-id="88a89-457">Aby uzyskać więcej informacji, zobacz <xref:security/data-protection/introduction>.</span><span class="sxs-lookup"><span data-stu-id="88a89-457">For more information, see <xref:security/data-protection/introduction>.</span></span>

## <a name="virtual-directories"></a><span data-ttu-id="88a89-458">Katalogi wirtualne</span><span class="sxs-lookup"><span data-stu-id="88a89-458">Virtual Directories</span></span>

<span data-ttu-id="88a89-459">[Katalogi wirtualne usług IIS](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) nie są obsługiwane w aplikacjach ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-459">[IIS Virtual Directories](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) aren't supported with ASP.NET Core apps.</span></span> <span data-ttu-id="88a89-460">Aplikacja może być hostowana jako [podaplikacja](#sub-applications).</span><span class="sxs-lookup"><span data-stu-id="88a89-460">An app can be hosted as a [sub-application](#sub-applications).</span></span>

## <a name="sub-applications"></a><span data-ttu-id="88a89-461">Aplikacje podrzędne</span><span class="sxs-lookup"><span data-stu-id="88a89-461">Sub-applications</span></span>

<span data-ttu-id="88a89-462">Aplikacja ASP.NET Core może być hostowana jako [podaplikacja usług IIS (podrzędna)](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span><span class="sxs-lookup"><span data-stu-id="88a89-462">An ASP.NET Core app can be hosted as an [IIS sub-application (sub-app)](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span></span> <span data-ttu-id="88a89-463">Ścieżka aplikacji podrzędnej jest częścią adresu URL aplikacji głównej.</span><span class="sxs-lookup"><span data-stu-id="88a89-463">The sub-app's path becomes part of the root app's URL.</span></span>

<span data-ttu-id="88a89-464">Linki do zasobów statycznych w aplikacji podrzędnej powinny używać notacji z ukośnikiem ( `~/` ).</span><span class="sxs-lookup"><span data-stu-id="88a89-464">Static asset links within the sub-app should use tilde-slash (`~/`) notation.</span></span> <span data-ttu-id="88a89-465">Notacja "ukośnik" wyzwala [pomocnika tagów](xref:mvc/views/tag-helpers/intro) , aby dołączyć pathbase podaplikacji do renderowanego linku względnego.</span><span class="sxs-lookup"><span data-stu-id="88a89-465">Tilde-slash notation triggers a [Tag Helper](xref:mvc/views/tag-helpers/intro) to prepend the sub-app's pathbase to the rendered relative link.</span></span> <span data-ttu-id="88a89-466">W przypadku aplikacji podrzędnej w `/subapp_path` programie obraz połączony z programem `src="~/image.png"` jest renderowany jako `src="/subapp_path/image.png"` .</span><span class="sxs-lookup"><span data-stu-id="88a89-466">For a sub-app at `/subapp_path`, an image linked with `src="~/image.png"` is rendered as `src="/subapp_path/image.png"`.</span></span> <span data-ttu-id="88a89-467">Oprogramowanie pośredniczące aplikacji głównej nie przetwarza żądania pliku statycznego.</span><span class="sxs-lookup"><span data-stu-id="88a89-467">The root app's Static File Middleware doesn't process the static file request.</span></span> <span data-ttu-id="88a89-468">Żądanie jest przetwarzane przez oprogramowanie pośredniczące plików statycznych aplikacji podrzędnej.</span><span class="sxs-lookup"><span data-stu-id="88a89-468">The request is processed by the sub-app's Static File Middleware.</span></span>

<span data-ttu-id="88a89-469">Jeśli atrybut statycznego zasobu `src` jest ustawiony na ścieżkę bezwzględną (na przykład `src="/image.png"` ), link jest renderowany bez pathbase podaplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-469">If a static asset's `src` attribute is set to an absolute path (for example, `src="/image.png"`), the link is rendered without the sub-app's pathbase.</span></span> <span data-ttu-id="88a89-470">Oprogramowanie pośredniczące pliku statycznego aplikacji głównej próbuje obsłużyć zasób z poziomu [głównego katalogu sieci Web](xref:fundamentals/index#web-root)aplikacji głównej, co spowoduje, że odpowiedź na *404 nie zostanie znaleziona* , chyba że statyczny zasób jest dostępny z poziomu aplikacji głównej.</span><span class="sxs-lookup"><span data-stu-id="88a89-470">The root app's Static File Middleware attempts to serve the asset from the root app's [web root](xref:fundamentals/index#web-root), which results in a *404 - Not Found* response unless the static asset is available from the root app.</span></span>

<span data-ttu-id="88a89-471">Aby hostować aplikację ASP.NET Core jako aplikację podrzędną w innej aplikacji ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="88a89-471">To host an ASP.NET Core app as a sub-app under another ASP.NET Core app:</span></span>

1. <span data-ttu-id="88a89-472">Ustanów pulę aplikacji dla aplikacji podrzędnej.</span><span class="sxs-lookup"><span data-stu-id="88a89-472">Establish an app pool for the sub-app.</span></span> <span data-ttu-id="88a89-473">Ustaw **wersję środowiska .NET CLR** na **Brak kodu zarządzanego** , ponieważ podstawowe środowisko uruchomieniowe języka wspólnego (CoreCLR) dla platformy .NET Core jest uruchomione w celu hostowania aplikacji w procesie roboczym, a nie na pulpicie CLR (.NET CLR).</span><span class="sxs-lookup"><span data-stu-id="88a89-473">Set the **.NET CLR Version** to **No Managed Code** because the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process, not the desktop CLR (.NET CLR).</span></span>

1. <span data-ttu-id="88a89-474">Dodaj lokację główną w Menedżerze usług IIS przy użyciu aplikacji podrzędnej w folderze w lokacji głównej.</span><span class="sxs-lookup"><span data-stu-id="88a89-474">Add the root site in IIS Manager with the sub-app in a folder under the root site.</span></span>

1. <span data-ttu-id="88a89-475">Kliknij prawym przyciskiem myszy folder subapp w Menedżerze usług IIS, a następnie wybierz polecenie **Konwertuj na aplikację** .</span><span class="sxs-lookup"><span data-stu-id="88a89-475">Right-click the sub-app folder in IIS Manager and select **Convert to Application** .</span></span>

1. <span data-ttu-id="88a89-476">W oknie dialogowym **Dodawanie aplikacji** Użyj przycisku **Wybierz** dla **puli aplikacji** , aby przypisać pulę aplikacji utworzoną dla aplikacji podrzędnej.</span><span class="sxs-lookup"><span data-stu-id="88a89-476">In the **Add Application** dialog, use the **Select** button for the **Application Pool** to assign the app pool that you created for the sub-app.</span></span> <span data-ttu-id="88a89-477">Wybierz pozycję **OK** .</span><span class="sxs-lookup"><span data-stu-id="88a89-477">Select **OK** .</span></span>

<span data-ttu-id="88a89-478">Przypisanie oddzielnej puli aplikacji do aplikacji podrzędnej jest wymagane w przypadku korzystania z modelu hostingu w procesie.</span><span class="sxs-lookup"><span data-stu-id="88a89-478">The assignment of a separate app pool to the sub-app is a requirement when using the in-process hosting model.</span></span>

<span data-ttu-id="88a89-479">Aby uzyskać więcej informacji na temat modelu hostingu w procesie i konfigurowania modułu ASP.NET Core, zobacz <xref:host-and-deploy/aspnet-core-module> .</span><span class="sxs-lookup"><span data-stu-id="88a89-479">For more information on the in-process hosting model and configuring the ASP.NET Core Module, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

## <a name="configuration-of-iis-with-webconfig"></a><span data-ttu-id="88a89-480">Konfiguracja usług IIS z web.config</span><span class="sxs-lookup"><span data-stu-id="88a89-480">Configuration of IIS with web.config</span></span>

<span data-ttu-id="88a89-481">Na konfigurację usług IIS wpływa `<system.webServer>` sekcja *web.config* dla scenariuszy usług IIS, które są funkcjonalne dla ASP.NET Core aplikacji za pomocą modułu ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-481">IIS configuration is influenced by the `<system.webServer>` section of *web.config* for IIS scenarios that are functional for ASP.NET Core apps with the ASP.NET Core Module.</span></span> <span data-ttu-id="88a89-482">Na przykład konfiguracja usług IIS jest funkcjonalna dla kompresji dynamicznej.</span><span class="sxs-lookup"><span data-stu-id="88a89-482">For example, IIS configuration is functional for dynamic compression.</span></span> <span data-ttu-id="88a89-483">Jeśli usługi IIS są skonfigurowane na poziomie serwera do korzystania z kompresji dynamicznej, `<urlCompression>` element w pliku *web.config* aplikacji może go wyłączyć dla aplikacji ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-483">If IIS is configured at the server level to use dynamic compression, the `<urlCompression>` element in the app's *web.config* file can disable it for an ASP.NET Core app.</span></span>

<span data-ttu-id="88a89-484">Aby uzyskać więcej informacji, zobacz następujące tematy:</span><span class="sxs-lookup"><span data-stu-id="88a89-484">For more information, see the following topics:</span></span>

* [<span data-ttu-id="88a89-485">Dokumentacja konfiguracyjna programu \<system.webServer></span><span class="sxs-lookup"><span data-stu-id="88a89-485">Configuration reference for \<system.webServer></span></span>](/iis/configuration/system.webServer/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/iis/modules>

<span data-ttu-id="88a89-486">Aby ustawić zmienne środowiskowe dla poszczególnych aplikacji działających w pulach izolowanych aplikacji (obsługiwanych w przypadku usług IIS 10,0 lub nowszych), zobacz sekcję *polecenieAppCmd.exe* w temacie [ \<environmentVariables> zmienne środowiskowe](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) w dokumentacji dotyczącej usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-486">To set environment variables for individual apps running in isolated app pools (supported for IIS 10.0 or later), see the *AppCmd.exe command* section of the [Environment Variables \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) topic in the IIS reference documentation.</span></span>

## <a name="configuration-sections-of-webconfig"></a><span data-ttu-id="88a89-487">Sekcje konfiguracji web.config</span><span class="sxs-lookup"><span data-stu-id="88a89-487">Configuration sections of web.config</span></span>

<span data-ttu-id="88a89-488">Sekcje konfiguracyjne aplikacji ASP.NET 4. x w *web.config* nie są używane przez aplikacje ASP.NET Core do konfiguracji:</span><span class="sxs-lookup"><span data-stu-id="88a89-488">Configuration sections of ASP.NET 4.x apps in *web.config* aren't used by ASP.NET Core apps for configuration:</span></span>

* `<system.web>`
* `<appSettings>`
* `<connectionStrings>`
* `<location>`

<span data-ttu-id="88a89-489">Aplikacje ASP.NET Core są konfigurowane przy użyciu innych dostawców konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="88a89-489">ASP.NET Core apps are configured using other configuration providers.</span></span> <span data-ttu-id="88a89-490">Aby uzyskać więcej informacji, zobacz [Konfiguracja](xref:fundamentals/configuration/index).</span><span class="sxs-lookup"><span data-stu-id="88a89-490">For more information, see [Configuration](xref:fundamentals/configuration/index).</span></span>

## <a name="application-pools"></a><span data-ttu-id="88a89-491">Pule aplikacji</span><span class="sxs-lookup"><span data-stu-id="88a89-491">Application Pools</span></span>

<span data-ttu-id="88a89-492">Izolacja puli aplikacji jest określana przez model hostingu:</span><span class="sxs-lookup"><span data-stu-id="88a89-492">App pool isolation is determined by the hosting model:</span></span>

* <span data-ttu-id="88a89-493">Hosting w procesie: aplikacje muszą być uruchamiane w oddzielnych pulach aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-493">In-process hosting: Apps are required to run in separate app pools.</span></span>
* <span data-ttu-id="88a89-494">Hosting poza procesem: zalecamy izolowanie aplikacji od siebie, uruchamiając każdą aplikację w jej własnej puli aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-494">Out-of-process hosting: We recommend isolating the apps from each other by running each app in its own app pool.</span></span>

<span data-ttu-id="88a89-495">Okno dialogowe **Dodaj witrynę sieci Web** usług IIS domyślnie umożliwia pojedynczej puli aplikacji na aplikację.</span><span class="sxs-lookup"><span data-stu-id="88a89-495">The IIS **Add Website** dialog defaults to a single app pool per app.</span></span> <span data-ttu-id="88a89-496">Po podaniu **nazwy witryny** tekst zostanie automatycznie przeniesiony do pola tekstowego **Pula aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-496">When a **Site name** is provided, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="88a89-497">Nowa pula aplikacji jest tworzona przy użyciu nazwy lokacji, gdy zostanie dodana lokacja.</span><span class="sxs-lookup"><span data-stu-id="88a89-497">A new app pool is created using the site name when the site is added.</span></span>

## <a name="application-pool-no-locidentity"></a><span data-ttu-id="88a89-498">Pula aplikacji Identity</span><span class="sxs-lookup"><span data-stu-id="88a89-498">Application Pool Identity</span></span>

<span data-ttu-id="88a89-499">Konto tożsamości puli aplikacji umożliwia uruchamianie aplikacji na unikatowym koncie bez konieczności tworzenia domen ani kont lokalnych oraz zarządzania nimi.</span><span class="sxs-lookup"><span data-stu-id="88a89-499">An app pool identity account allows an app to run under a unique account without having to create and manage domains or local accounts.</span></span> <span data-ttu-id="88a89-500">W przypadku usług IIS 8,0 lub nowszych proces roboczy administratora usług IIS tworzy konto wirtualne o nazwie nowej puli aplikacji i domyślnie uruchamia procesy robocze puli aplikacji w ramach tego konta.</span><span class="sxs-lookup"><span data-stu-id="88a89-500">On IIS 8.0 or later, the IIS Admin Worker Process (WAS) creates a virtual account with the name of the new app pool and runs the app pool's worker processes under this account by default.</span></span> <span data-ttu-id="88a89-501">W konsoli zarządzania usługami IIS w obszarze **Ustawienia zaawansowane** dla puli aplikacji upewnij się, że **Identity** ustawiono opcję Użyj **ApplicationPool Identity** :</span><span class="sxs-lookup"><span data-stu-id="88a89-501">In the IIS Management Console under **Advanced Settings** for the app pool, ensure that the **Identity** is set to use **ApplicationPoolIdentity** :</span></span>

![Okno dialogowe Zaawansowane ustawienia puli aplikacji](index/_static/apppool-identity.png)

<span data-ttu-id="88a89-503">Proces zarządzania usługami IIS tworzy Bezpieczny identyfikator z nazwą puli aplikacji w systemie zabezpieczeń systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="88a89-503">The IIS management process creates a secure identifier with the name of the app pool in the Windows Security System.</span></span> <span data-ttu-id="88a89-504">Zasoby mogą być zabezpieczone przy użyciu tej tożsamości.</span><span class="sxs-lookup"><span data-stu-id="88a89-504">Resources can be secured using this identity.</span></span> <span data-ttu-id="88a89-505">Jednak ta tożsamość nie jest kontem użytkownika rzeczywistego i nie jest wyświetlana w konsoli zarządzania użytkownikami systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="88a89-505">However, this identity isn't a real user account and doesn't show up in the Windows User Management Console.</span></span>

<span data-ttu-id="88a89-506">Jeśli proces roboczy usług IIS wymaga podwyższonego poziomu dostępu do aplikacji, Zmodyfikuj listę Access Control (ACL) dla katalogu zawierającego aplikację:</span><span class="sxs-lookup"><span data-stu-id="88a89-506">If the IIS worker process requires elevated access to the app, modify the Access Control List (ACL) for the directory containing the app:</span></span>

1. <span data-ttu-id="88a89-507">Otwórz Eksploratora Windows i przejdź do katalogu.</span><span class="sxs-lookup"><span data-stu-id="88a89-507">Open Windows Explorer and navigate to the directory.</span></span>

1. <span data-ttu-id="88a89-508">Kliknij prawym przyciskiem myszy katalog i wybierz polecenie **Właściwości** .</span><span class="sxs-lookup"><span data-stu-id="88a89-508">Right-click on the directory and select **Properties** .</span></span>

1. <span data-ttu-id="88a89-509">Na karcie **zabezpieczenia** wybierz przycisk **Edytuj** , a następnie przycisk **Dodaj** .</span><span class="sxs-lookup"><span data-stu-id="88a89-509">Under the **Security** tab, select the **Edit** button and then the **Add** button.</span></span>

1. <span data-ttu-id="88a89-510">Wybierz przycisk **lokalizacje** i upewnij się, że wybrano system.</span><span class="sxs-lookup"><span data-stu-id="88a89-510">Select the **Locations** button and make sure the system is selected.</span></span>

1. <span data-ttu-id="88a89-511">Wprowadź `IIS AppPool\{APP POOL NAME}` , gdzie symbol zastępczy `{APP POOL NAME}` jest nazwą puli aplikacji, w polu **Wprowadź nazwy obiektów do wybrania** .</span><span class="sxs-lookup"><span data-stu-id="88a89-511">Enter `IIS AppPool\{APP POOL NAME}`, where the placeholder `{APP POOL NAME}` is the app pool name, in **Enter the object names to select** area.</span></span> <span data-ttu-id="88a89-512">Wybierz przycisk **Sprawdź nazwy** .</span><span class="sxs-lookup"><span data-stu-id="88a89-512">Select the **Check Names** button.</span></span> <span data-ttu-id="88a89-513">W polu *Domyślna pula aplikacji* Sprawdź nazwy używane przez program `IIS AppPool\DefaultAppPool` .</span><span class="sxs-lookup"><span data-stu-id="88a89-513">For the *DefaultAppPool* check the names using `IIS AppPool\DefaultAppPool`.</span></span> <span data-ttu-id="88a89-514">Po wybraniu przycisku **Sprawdź nazwy** `DefaultAppPool` w obszarze nazwy obiektów jest wskazywana wartość.</span><span class="sxs-lookup"><span data-stu-id="88a89-514">When the **Check Names** button is selected, a value of `DefaultAppPool` is indicated in the object names area.</span></span> <span data-ttu-id="88a89-515">Nie można wprowadzić nazwy puli aplikacji bezpośrednio w obszarze nazw obiektów.</span><span class="sxs-lookup"><span data-stu-id="88a89-515">It isn't possible to enter the app pool name directly into the object names area.</span></span> <span data-ttu-id="88a89-516">Użyj `IIS AppPool\{APP POOL NAME}` formatu, gdzie symbol zastępczy `{APP POOL NAME}` jest nazwą puli aplikacji, podczas sprawdzania nazwy obiektu.</span><span class="sxs-lookup"><span data-stu-id="88a89-516">Use the `IIS AppPool\{APP POOL NAME}` format, where the placeholder `{APP POOL NAME}` is the app pool name, when checking for the object name.</span></span>

   ![Okno dialogowe Wybieranie użytkowników lub grup dla folderu aplikacji: Nazwa puli aplikacji "domyślna pula" jest dołączana do "puli aplikacji IIS \" w obszarze nazw obiektów przed wybraniem pozycji" Sprawdź nazwy ".](index/_static/select-users-or-groups-1.png)

1. <span data-ttu-id="88a89-518">Wybierz pozycję **OK** .</span><span class="sxs-lookup"><span data-stu-id="88a89-518">Select **OK** .</span></span>

   ![Okno dialogowe Wybieranie użytkowników lub grup dla folderu aplikacji: po wybraniu pozycji "Sprawdź nazwy" w obszarze nazwy obiektów zostanie wyświetlona nazwa obiektu "domyślna pula aplikacji".](index/_static/select-users-or-groups-2.png)

1. <span data-ttu-id="88a89-520">&amp;Uprawnienia do wykonywania odczytu powinny być przyznawane domyślnie.</span><span class="sxs-lookup"><span data-stu-id="88a89-520">Read &amp; execute permissions should be granted by default.</span></span> <span data-ttu-id="88a89-521">Podaj dodatkowe uprawnienia zgodnie z wymaganiami.</span><span class="sxs-lookup"><span data-stu-id="88a89-521">Provide additional permissions as needed.</span></span>

<span data-ttu-id="88a89-522">Dostęp można także udzielić w wierszu polecenia przy użyciu narzędzia **icacls** .</span><span class="sxs-lookup"><span data-stu-id="88a89-522">Access can also be granted at a command prompt using the **ICACLS** tool.</span></span> <span data-ttu-id="88a89-523">Korzystając z `DefaultAppPool` przykładu, używane jest następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="88a89-523">Using the `DefaultAppPool` as an example, the following command is used:</span></span>

```console
ICACLS C:\sites\MyWebApp /grant "IIS AppPool\DefaultAppPool":F
```

<span data-ttu-id="88a89-524">Aby uzyskać więcej informacji, zobacz temat [icacls](/windows-server/administration/windows-commands/icacls) .</span><span class="sxs-lookup"><span data-stu-id="88a89-524">For more information, see the [icacls](/windows-server/administration/windows-commands/icacls) topic.</span></span>

## <a name="http2-support"></a><span data-ttu-id="88a89-525">Obsługa protokołu HTTP/2</span><span class="sxs-lookup"><span data-stu-id="88a89-525">HTTP/2 support</span></span>

<span data-ttu-id="88a89-526">[Protokół HTTP/2](https://httpwg.org/specs/rfc7540.html) jest obsługiwany z ASP.NET Core w następujących scenariuszach wdrażania usług IIS:</span><span class="sxs-lookup"><span data-stu-id="88a89-526">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is supported with ASP.NET Core in the following IIS deployment scenarios:</span></span>

* <span data-ttu-id="88a89-527">W procesie</span><span class="sxs-lookup"><span data-stu-id="88a89-527">In-process</span></span>
  * <span data-ttu-id="88a89-528">Windows Server 2016/Windows 10 lub nowszy; Program IIS 10 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="88a89-528">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="88a89-529">Połączenie TLS 1,2 lub nowsze</span><span class="sxs-lookup"><span data-stu-id="88a89-529">TLS 1.2 or later connection</span></span>
* <span data-ttu-id="88a89-530">Pozaprocesowe</span><span class="sxs-lookup"><span data-stu-id="88a89-530">Out-of-process</span></span>
  * <span data-ttu-id="88a89-531">Windows Server 2016/Windows 10 lub nowszy; Program IIS 10 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="88a89-531">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="88a89-532">Połączenia z serwerem granicznym dostępnym publicznie korzystają z protokołu HTTP/2, ale połączenie zwrotnego serwera proxy z [serwerem Kestrel](xref:fundamentals/servers/kestrel) korzysta z protokołu HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="88a89-532">Public-facing edge server connections use HTTP/2, but the reverse proxy connection to the [Kestrel server](xref:fundamentals/servers/kestrel) uses HTTP/1.1.</span></span>
  * <span data-ttu-id="88a89-533">Połączenie TLS 1,2 lub nowsze</span><span class="sxs-lookup"><span data-stu-id="88a89-533">TLS 1.2 or later connection</span></span>

<span data-ttu-id="88a89-534">W przypadku wdrożenia w procesie podczas ustanawiania połączenia HTTP/2 [`HttpRequest.Protocol`](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) Raporty `HTTP/2` .</span><span class="sxs-lookup"><span data-stu-id="88a89-534">For an in-process deployment when an HTTP/2 connection is established, [`HttpRequest.Protocol`](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/2`.</span></span> <span data-ttu-id="88a89-535">W przypadku wdrożenia poza procesem w przypadku ustanowienia połączenia HTTP/2 [`HttpRequest.Protocol`](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) Raporty `HTTP/1.1` .</span><span class="sxs-lookup"><span data-stu-id="88a89-535">For an out-of-process deployment when an HTTP/2 connection is established, [`HttpRequest.Protocol`](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/1.1`.</span></span>

<span data-ttu-id="88a89-536">Aby uzyskać więcej informacji na temat modeli hostingu w procesie i poza procesami, zobacz <xref:host-and-deploy/aspnet-core-module> .</span><span class="sxs-lookup"><span data-stu-id="88a89-536">For more information on the in-process and out-of-process hosting models, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

<span data-ttu-id="88a89-537">Protokół HTTP/2 jest domyślnie włączony.</span><span class="sxs-lookup"><span data-stu-id="88a89-537">HTTP/2 is enabled by default.</span></span> <span data-ttu-id="88a89-538">Połączenia powracają do protokołu HTTP/1.1, jeśli połączenie HTTP/2 nie zostało ustanowione.</span><span class="sxs-lookup"><span data-stu-id="88a89-538">Connections fall back to HTTP/1.1 if an HTTP/2 connection isn't established.</span></span> <span data-ttu-id="88a89-539">Aby uzyskać więcej informacji na temat konfiguracji protokołu HTTP/2 z wdrożeniami usług IIS, zobacz [http/2 w usługach IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span><span class="sxs-lookup"><span data-stu-id="88a89-539">For more information on HTTP/2 configuration with IIS deployments, see [HTTP/2 on IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span></span>

## <a name="cors-preflight-requests"></a><span data-ttu-id="88a89-540">Żądania inspekcji wstępnej CORS</span><span class="sxs-lookup"><span data-stu-id="88a89-540">CORS preflight requests</span></span>

<span data-ttu-id="88a89-541">*Ta sekcja dotyczy tylko ASP.NET Core aplikacji przeznaczonych dla .NET Framework.*</span><span class="sxs-lookup"><span data-stu-id="88a89-541">*This section only applies to ASP.NET Core apps that target the .NET Framework.*</span></span>

<span data-ttu-id="88a89-542">W przypadku aplikacji ASP.NET Core, która jest przeznaczona dla .NET Framework, żądania opcji nie są domyślnie przesyłane do aplikacji w usługach IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-542">For an ASP.NET Core app that targets the .NET Framework, OPTIONS requests aren't passed to the app by default in IIS.</span></span> <span data-ttu-id="88a89-543">Aby dowiedzieć się, jak skonfigurować obsługę usług IIS w programie w `web.config` celu przekazywania żądań opcji, zobacz [Włączanie żądań między źródłami w programie ASP.NET Web API 2: jak działa mechanizm CORS](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span><span class="sxs-lookup"><span data-stu-id="88a89-543">To learn how to configure the app's IIS handlers in `web.config` to pass OPTIONS requests, see [Enable cross-origin requests in ASP.NET Web API 2: How CORS Works](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span></span>

## <a name="application-initialization-module-and-idle-timeout"></a><span data-ttu-id="88a89-544">Moduł inicjalizacji aplikacji i limit czasu bezczynności</span><span class="sxs-lookup"><span data-stu-id="88a89-544">Application Initialization Module and Idle Timeout</span></span>

<span data-ttu-id="88a89-545">Hostowane w usługach IIS przez moduł ASP.NET Core w wersji 2:</span><span class="sxs-lookup"><span data-stu-id="88a89-545">When hosted in IIS by the ASP.NET Core Module version 2:</span></span>

* <span data-ttu-id="88a89-546">[Moduł inicjalizacji aplikacji](#application-initialization-module): hostowana [w procesie](#in-process-hosting-model) lub [poza procesem](#out-of-process-hosting-model) aplikacja może zostać skonfigurowana do automatycznego uruchamiania na potrzeby ponownego uruchomienia procesu roboczego lub ponownego uruchomienia serwera.</span><span class="sxs-lookup"><span data-stu-id="88a89-546">[Application Initialization Module](#application-initialization-module): App's hosted [in-process](#in-process-hosting-model) or [out-of-process](#out-of-process-hosting-model) can be configured to start automatically on a worker process restart or server restart.</span></span>
* <span data-ttu-id="88a89-547">[Limit czasu bezczynności](#idle-timeout): hostowana [w trakcie](#in-process-hosting-model) działania aplikacji można skonfigurować w taki sposób, aby nie przekroczyć limitu czasu podczas okresów braku aktywności.</span><span class="sxs-lookup"><span data-stu-id="88a89-547">[Idle Timeout](#idle-timeout): App's hosted [in-process](#in-process-hosting-model) can be configured not to timeout during periods of inactivity.</span></span>

### <a name="application-initialization-module"></a><span data-ttu-id="88a89-548">Moduł inicjalizacji aplikacji</span><span class="sxs-lookup"><span data-stu-id="88a89-548">Application Initialization Module</span></span>

<span data-ttu-id="88a89-549">*Dotyczy aplikacji hostowanych w procesie i pozaprocesowe.*</span><span class="sxs-lookup"><span data-stu-id="88a89-549">*Applies to apps hosted in-process and out-of-process.*</span></span>

<span data-ttu-id="88a89-550">[Inicjowanie aplikacji IIS](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization) to funkcja usług IIS, która wysyła do aplikacji żądanie HTTP, gdy pula aplikacji zostanie uruchomiona lub zostanie odtworzona.</span><span class="sxs-lookup"><span data-stu-id="88a89-550">[IIS Application Initialization](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization) is an IIS feature that sends an HTTP request to the app when the app pool starts or is recycled.</span></span> <span data-ttu-id="88a89-551">Żądanie wyzwala uruchomienie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-551">The request triggers the app to start.</span></span> <span data-ttu-id="88a89-552">Domyślnie usługi IIS wysyłają żądanie do głównego adresu URL aplikacji ( `/` ) w celu zainicjowania aplikacji (zobacz [dodatkowe zasoby](#application-initialization-module-and-idle-timeout-additional-resources) , aby uzyskać więcej informacji na temat konfiguracji).</span><span class="sxs-lookup"><span data-stu-id="88a89-552">By default, IIS issues a request to the app's root URL (`/`) to initialize the app (see the [additional resources](#application-initialization-module-and-idle-timeout-additional-resources) for more details on configuration).</span></span>

<span data-ttu-id="88a89-553">Upewnij się, że funkcja inicjowania roli inicjalizacji aplikacji IIS jest włączona:</span><span class="sxs-lookup"><span data-stu-id="88a89-553">Confirm that the IIS Application Initialization role feature in enabled:</span></span>

<span data-ttu-id="88a89-554">Na komputerach z systemem Windows 7 lub nowszym w przypadku lokalnego korzystania z usług IIS:</span><span class="sxs-lookup"><span data-stu-id="88a89-554">On Windows 7 or later desktop systems when using IIS locally:</span></span>

1. <span data-ttu-id="88a89-555">Przejdź do pozycji **Panel sterowania** > **programy** > **programy i funkcje** > **Włącz lub wyłącz funkcje systemu Windows** (po lewej stronie ekranu).</span><span class="sxs-lookup"><span data-stu-id="88a89-555">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>
1. <span data-ttu-id="88a89-556">Otwórz **Internet Information Services** > **World Wide Web Services** > **funkcje projektowania aplikacji** Internet Information Services World Wide Web Services.</span><span class="sxs-lookup"><span data-stu-id="88a89-556">Open **Internet Information Services** > **World Wide Web Services** > **Application Development Features** .</span></span>
1. <span data-ttu-id="88a89-557">Zaznacz pole wyboru dla **inicjowania aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-557">Select the check box for **Application Initialization** .</span></span>

<span data-ttu-id="88a89-558">W systemie Windows Server 2008 R2 lub nowszym:</span><span class="sxs-lookup"><span data-stu-id="88a89-558">On Windows Server 2008 R2 or later:</span></span>

1. <span data-ttu-id="88a89-559">Otwórz **Kreatora dodawania ról i funkcji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-559">Open the **Add Roles and Features Wizard** .</span></span>
1. <span data-ttu-id="88a89-560">W panelu **Wybierz usługi ról** Otwórz węzeł **Programowanie aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-560">In the **Select role services** panel, open the **Application Development** node.</span></span>
1. <span data-ttu-id="88a89-561">Zaznacz pole wyboru dla **inicjowania aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-561">Select the check box for **Application Initialization** .</span></span>

<span data-ttu-id="88a89-562">Użyj jednego z poniższych metod, aby włączyć moduł inicjowania aplikacji dla lokacji:</span><span class="sxs-lookup"><span data-stu-id="88a89-562">Use either of the following approaches to enable the Application Initialization Module for the site:</span></span>

* <span data-ttu-id="88a89-563">Za pomocą Menedżera usług IIS:</span><span class="sxs-lookup"><span data-stu-id="88a89-563">Using IIS Manager:</span></span>

  1. <span data-ttu-id="88a89-564">W panelu **połączenia** wybierz pozycję **Pule aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-564">Select **Application Pools** in the **Connections** panel.</span></span>
  1. <span data-ttu-id="88a89-565">Kliknij prawym przyciskiem myszy pulę aplikacji aplikacji na liście i wybierz pozycję **Ustawienia zaawansowane** .</span><span class="sxs-lookup"><span data-stu-id="88a89-565">Right-click the app's app pool in the list and select **Advanced Settings** .</span></span>
  1. <span data-ttu-id="88a89-566">Domyślny **tryb uruchamiania** to **OnDemand** .</span><span class="sxs-lookup"><span data-stu-id="88a89-566">The default **Start Mode** is **OnDemand** .</span></span> <span data-ttu-id="88a89-567">Ustaw **tryb uruchamiania** na **AlwaysRunning** .</span><span class="sxs-lookup"><span data-stu-id="88a89-567">Set the **Start Mode** to **AlwaysRunning** .</span></span> <span data-ttu-id="88a89-568">Wybierz pozycję **OK** .</span><span class="sxs-lookup"><span data-stu-id="88a89-568">Select **OK** .</span></span>
  1. <span data-ttu-id="88a89-569">Otwórz węzeł **Lokacje** w panelu **połączenia** .</span><span class="sxs-lookup"><span data-stu-id="88a89-569">Open the **Sites** node in the **Connections** panel.</span></span>
  1. <span data-ttu-id="88a89-570">Kliknij prawym przyciskiem myszy aplikację i wybierz pozycję Zarządzaj ustawieniami zaawansowanymi **witryny sieci Web** > **Advanced Settings** .</span><span class="sxs-lookup"><span data-stu-id="88a89-570">Right-click the app and select **Manage Website** > **Advanced Settings** .</span></span>
  1. <span data-ttu-id="88a89-571">Domyślnym ustawieniem **wstępnego ładowania** jest **wartość false** .</span><span class="sxs-lookup"><span data-stu-id="88a89-571">The default **Preload Enabled** setting is **False** .</span></span> <span data-ttu-id="88a89-572">Ustaw dla opcji **wstępnego ładowania** **wartość true** .</span><span class="sxs-lookup"><span data-stu-id="88a89-572">Set **Preload Enabled** to **True** .</span></span> <span data-ttu-id="88a89-573">Wybierz pozycję **OK** .</span><span class="sxs-lookup"><span data-stu-id="88a89-573">Select **OK** .</span></span>

* <span data-ttu-id="88a89-574">Przy użyciu `web.config` , Dodaj `<applicationInitialization>` element z `doAppInitAfterRestart` ustawionym do `true` `<system.webServer>` elementów w pliku web.config"aplikacji:</span><span class="sxs-lookup"><span data-stu-id="88a89-574">Using `web.config`, add the `<applicationInitialization>` element with `doAppInitAfterRestart` set to `true` to the `<system.webServer>` elements in the app's web.config\` file:</span></span>

  ```xml
  <?xml version="1.0" encoding="utf-8"?>
  <configuration>
    <location path="." inheritInChildApplications="false">
      <system.webServer>
        <applicationInitialization doAppInitAfterRestart="true" />
      </system.webServer>
    </location>
  </configuration>
  ```

### <a name="idle-timeout"></a><span data-ttu-id="88a89-575">Limit czasu bezczynności</span><span class="sxs-lookup"><span data-stu-id="88a89-575">Idle Timeout</span></span>

<span data-ttu-id="88a89-576">*Dotyczy tylko aplikacji hostowanych w procesie.*</span><span class="sxs-lookup"><span data-stu-id="88a89-576">*Only applies to apps hosted in-process.*</span></span>

<span data-ttu-id="88a89-577">Aby zapobiec przekroczeniu przez aplikację, należy ustawić limit czasu bezczynności puli aplikacji przy użyciu Menedżera usług IIS:</span><span class="sxs-lookup"><span data-stu-id="88a89-577">To prevent the app from idling, set the app pool's idle timeout using IIS Manager:</span></span>

1. <span data-ttu-id="88a89-578">W panelu **połączenia** wybierz pozycję **Pule aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-578">Select **Application Pools** in the **Connections** panel.</span></span>
1. <span data-ttu-id="88a89-579">Kliknij prawym przyciskiem myszy pulę aplikacji aplikacji na liście i wybierz pozycję **Ustawienia zaawansowane** .</span><span class="sxs-lookup"><span data-stu-id="88a89-579">Right-click the app's app pool in the list and select **Advanced Settings** .</span></span>
1. <span data-ttu-id="88a89-580">Domyślny **limit czasu bezczynności (w minutach)** wynosi **20** minut.</span><span class="sxs-lookup"><span data-stu-id="88a89-580">The default **Idle Time-out (minutes)** is **20** minutes.</span></span> <span data-ttu-id="88a89-581">Ustaw **limit czasu bezczynności (w minutach)** na **0** (zero).</span><span class="sxs-lookup"><span data-stu-id="88a89-581">Set the **Idle Time-out (minutes)** to **0** (zero).</span></span> <span data-ttu-id="88a89-582">Wybierz pozycję **OK** .</span><span class="sxs-lookup"><span data-stu-id="88a89-582">Select **OK** .</span></span>
1. <span data-ttu-id="88a89-583">Odtwórz proces roboczy.</span><span class="sxs-lookup"><span data-stu-id="88a89-583">Recycle the worker process.</span></span>

<span data-ttu-id="88a89-584">Aby zapobiec przekroczeniu limitu [czasu hostowanych przez aplikacje](#out-of-process-hosting-model) aplikacji, użyj jednej z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="88a89-584">To prevent apps hosted [out-of-process](#out-of-process-hosting-model) from timing out, use either of the following approaches:</span></span>

* <span data-ttu-id="88a89-585">Wyślij polecenie ping do aplikacji z zewnętrznej usługi, aby było ono uruchomione.</span><span class="sxs-lookup"><span data-stu-id="88a89-585">Ping the app from an external service in order to keep it running.</span></span>
* <span data-ttu-id="88a89-586">Jeśli aplikacja obsługuje tylko usługi w tle, należy unikać hostingu usług IIS i używać [usługi systemu Windows do hostowania aplikacji ASP.NET Core](xref:host-and-deploy/windows-service).</span><span class="sxs-lookup"><span data-stu-id="88a89-586">If the app only hosts background services, avoid IIS hosting and use a [Windows Service to host the ASP.NET Core app](xref:host-and-deploy/windows-service).</span></span>

### <a name="application-initialization-module-and-idle-timeout-additional-resources"></a><span data-ttu-id="88a89-587">Dodatkowe zasoby dotyczące modułu inicjalizacji aplikacji i limitu czasu bezczynności</span><span class="sxs-lookup"><span data-stu-id="88a89-587">Application Initialization Module and Idle Timeout additional resources</span></span>

* [<span data-ttu-id="88a89-588">Inicjowanie aplikacji usług IIS 8,0</span><span class="sxs-lookup"><span data-stu-id="88a89-588">IIS 8.0 Application Initialization</span></span>](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization)
* <span data-ttu-id="88a89-589">[Inicjowanie \<applicationInitialization> aplikacji ](/iis/configuration/system.webserver/applicationinitialization/).</span><span class="sxs-lookup"><span data-stu-id="88a89-589">[Application Initialization \<applicationInitialization>](/iis/configuration/system.webserver/applicationinitialization/).</span></span>
* <span data-ttu-id="88a89-590">[Ustawienia modelu procesów dla \<processModel> puli aplikacji ](/iis/configuration/system.applicationhost/applicationpools/add/processmodel).</span><span class="sxs-lookup"><span data-stu-id="88a89-590">[Process Model Settings for an Application Pool \<processModel>](/iis/configuration/system.applicationhost/applicationpools/add/processmodel).</span></span>

## <a name="deployment-resources-for-iis-administrators"></a><span data-ttu-id="88a89-591">Zasoby wdrażania dla administratorów usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-591">Deployment resources for IIS administrators</span></span>

* [<span data-ttu-id="88a89-592">Dokumentacja usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-592">IIS documentation</span></span>](/iis)
* [<span data-ttu-id="88a89-593">Wprowadzenie z menedżerem usług IIS w usługach IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-593">Getting Started with the IIS Manager in IIS</span></span>](/iis/get-started/getting-started-with-iis/getting-started-with-the-iis-manager-in-iis-7-and-iis-8)
* [<span data-ttu-id="88a89-594">Wdrażanie aplikacji .NET Core</span><span class="sxs-lookup"><span data-stu-id="88a89-594">.NET Core application deployment</span></span>](/dotnet/core/deploying/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/directory-structure>
* <xref:host-and-deploy/iis/modules>
* <xref:test/troubleshoot-azure-iis>
* <xref:host-and-deploy/azure-iis-errors-reference>

## <a name="additional-resources"></a><span data-ttu-id="88a89-595">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="88a89-595">Additional resources</span></span>

* <xref:test/troubleshoot>
* <xref:index>
* [<span data-ttu-id="88a89-596">Oficjalna witryna programu Microsoft IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-596">The Official Microsoft IIS Site</span></span>](https://www.iis.net/)
* [<span data-ttu-id="88a89-597">Biblioteka zawartości technicznej systemu Windows Server</span><span class="sxs-lookup"><span data-stu-id="88a89-597">Windows Server technical content library</span></span>](/windows-server/windows-server)
* [<span data-ttu-id="88a89-598">Protokół HTTP/2 w usługach IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-598">HTTP/2 on IIS</span></span>](/iis/get-started/whats-new-in-iis-10/http2-on-iis)
* <xref:host-and-deploy/iis/transform-webconfig>

::: moniker-end

::: moniker range="= aspnetcore-2.2"

<span data-ttu-id="88a89-599">Aby zapoznać się z samouczkiem dotyczącym publikowania aplikacji ASP.NET Core na serwerze usług IIS, zobacz <xref:tutorials/publish-to-iis> .</span><span class="sxs-lookup"><span data-stu-id="88a89-599">For a tutorial experience on publishing an ASP.NET Core app to an IIS server, see <xref:tutorials/publish-to-iis>.</span></span>

[<span data-ttu-id="88a89-600">Zainstaluj pakiet hostingu platformy .NET Core</span><span class="sxs-lookup"><span data-stu-id="88a89-600">Install the .NET Core Hosting Bundle</span></span>](#install-the-net-core-hosting-bundle)

## <a name="supported-operating-systems"></a><span data-ttu-id="88a89-601">Obsługiwane systemy operacyjne</span><span class="sxs-lookup"><span data-stu-id="88a89-601">Supported operating systems</span></span>

<span data-ttu-id="88a89-602">Obsługiwane są następujące systemy operacyjne:</span><span class="sxs-lookup"><span data-stu-id="88a89-602">The following operating systems are supported:</span></span>

* <span data-ttu-id="88a89-603">System Windows 7 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="88a89-603">Windows 7 or later</span></span>
* <span data-ttu-id="88a89-604">Windows Server 2008 R2 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="88a89-604">Windows Server 2008 R2 or later</span></span>

<span data-ttu-id="88a89-605">[ SerwerHTTP.sys](xref:fundamentals/servers/httpsys) (znany wcześniej jako webListener) nie działa w konfiguracji zwrotnego serwera proxy z usługami IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-605">[HTTP.sys server](xref:fundamentals/servers/httpsys) (formerly called WebListener) doesn't work in a reverse proxy configuration with IIS.</span></span> <span data-ttu-id="88a89-606">Użyj [serwera Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="88a89-606">Use the [Kestrel server](xref:fundamentals/servers/kestrel).</span></span>

<span data-ttu-id="88a89-607">Aby uzyskać informacje na temat hostingu na platformie Azure, zobacz <xref:host-and-deploy/azure-apps/index> .</span><span class="sxs-lookup"><span data-stu-id="88a89-607">For information on hosting in Azure, see <xref:host-and-deploy/azure-apps/index>.</span></span>

<span data-ttu-id="88a89-608">Aby uzyskać wskazówki dotyczące rozwiązywania problemów, zobacz <xref:test/troubleshoot> .</span><span class="sxs-lookup"><span data-stu-id="88a89-608">For troubleshooting guidance, see <xref:test/troubleshoot>.</span></span>

## <a name="supported-platforms"></a><span data-ttu-id="88a89-609">Obsługiwane platformy</span><span class="sxs-lookup"><span data-stu-id="88a89-609">Supported platforms</span></span>

<span data-ttu-id="88a89-610">Obsługiwane są aplikacje opublikowane dla wdrożenia 32-bitowego (x86) lub 64-bitowego (x64).</span><span class="sxs-lookup"><span data-stu-id="88a89-610">Apps published for 32-bit (x86) or 64-bit (x64) deployment are supported.</span></span> <span data-ttu-id="88a89-611">Wdróż aplikację 32-bitową z 32-bitową (x86) zestaw .NET Core SDK, chyba że aplikacja:</span><span class="sxs-lookup"><span data-stu-id="88a89-611">Deploy a 32-bit app with a 32-bit (x86) .NET Core SDK unless the app:</span></span>

* <span data-ttu-id="88a89-612">Wymagana jest większa przestrzeń adresów pamięci wirtualnej dla aplikacji 64-bitowej.</span><span class="sxs-lookup"><span data-stu-id="88a89-612">Requires the larger virtual memory address space available to a 64-bit app.</span></span>
* <span data-ttu-id="88a89-613">Wymaga większego rozmiaru stosu IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-613">Requires the larger IIS stack size.</span></span>
* <span data-ttu-id="88a89-614">Ma 64-bitowe zależności natywne.</span><span class="sxs-lookup"><span data-stu-id="88a89-614">Has 64-bit native dependencies.</span></span>

<span data-ttu-id="88a89-615">Aby opublikować aplikację 64-bitową, należy użyć 64-bitowej (x64) zestaw .NET Core SDK.</span><span class="sxs-lookup"><span data-stu-id="88a89-615">Use a 64-bit (x64) .NET Core SDK to publish a 64-bit app.</span></span> <span data-ttu-id="88a89-616">64-bitowy środowisko uruchomieniowe musi być obecny w systemie hosta.</span><span class="sxs-lookup"><span data-stu-id="88a89-616">A 64-bit runtime must be present on the host system.</span></span>

## <a name="hosting-models"></a><span data-ttu-id="88a89-617">Modele hostingu</span><span class="sxs-lookup"><span data-stu-id="88a89-617">Hosting models</span></span>

### <a name="in-process-hosting-model"></a><span data-ttu-id="88a89-618">Model hostingu w procesie</span><span class="sxs-lookup"><span data-stu-id="88a89-618">In-process hosting model</span></span>

<span data-ttu-id="88a89-619">Korzystając z hostingu w procesie, aplikacja ASP.NET Core jest uruchamiana w tym samym procesie co proces roboczy usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-619">Using in-process hosting, an ASP.NET Core app runs in the same process as its IIS worker process.</span></span> <span data-ttu-id="88a89-620">Hosting w procesie zapewnia lepszą wydajność w porównaniu z obsługą hostingu poza procesem, ponieważ:</span><span class="sxs-lookup"><span data-stu-id="88a89-620">In-process hosting provides improved performance over out-of-process hosting because:</span></span>

* <span data-ttu-id="88a89-621">Żądania nie są przekazywane za pośrednictwem karty sprzężenia zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="88a89-621">Requests aren't proxied over the loopback adapter.</span></span> <span data-ttu-id="88a89-622">Karta sprzężenia zwrotnego jest interfejsem sieciowym, który zwraca wychodzący ruch sieciowy z powrotem do tego samego komputera.</span><span class="sxs-lookup"><span data-stu-id="88a89-622">A loopback adapter is a network interface that returns outgoing network traffic back to the same machine.</span></span>

<span data-ttu-id="88a89-623">Usługi IIS obsługują zarządzanie procesami przy użyciu [usługi aktywacji procesów systemu Windows (was)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="88a89-623">IIS handles process management with the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="88a89-624">[Moduł ASP.NET Core](xref:host-and-deploy/aspnet-core-module):</span><span class="sxs-lookup"><span data-stu-id="88a89-624">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module):</span></span>

* <span data-ttu-id="88a89-625">Wykonuje inicjalizację aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-625">Performs app initialization.</span></span>
  * <span data-ttu-id="88a89-626">Ładuje [CoreCLR](/dotnet/standard/glossary#coreclr).</span><span class="sxs-lookup"><span data-stu-id="88a89-626">Loads the [CoreCLR](/dotnet/standard/glossary#coreclr).</span></span>
  * <span data-ttu-id="88a89-627">Wywołania `Program.Main` .</span><span class="sxs-lookup"><span data-stu-id="88a89-627">Calls `Program.Main`.</span></span>
* <span data-ttu-id="88a89-628">Obsługuje okres istnienia żądania natywnego usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-628">Handles the lifetime of the IIS native request.</span></span>

<span data-ttu-id="88a89-629">Model hostingu w procesie nie jest obsługiwany w przypadku aplikacji ASP.NET Core przeznaczonych dla .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="88a89-629">The in-process hosting model isn't supported for ASP.NET Core apps that target the .NET Framework.</span></span>

<span data-ttu-id="88a89-630">Na poniższym diagramie przedstawiono relację między usługami IIS, modułem ASP.NET Core i hostowaną w procesie aplikacją:</span><span class="sxs-lookup"><span data-stu-id="88a89-630">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted in-process:</span></span>

![Moduł ASP.NET Core w scenariuszu hostingu w procesie](index/_static/ancm-inprocess.png)

<span data-ttu-id="88a89-632">Żądanie dociera do sieci Web do sterownika HTTP.sys trybu jądra.</span><span class="sxs-lookup"><span data-stu-id="88a89-632">A request arrives from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="88a89-633">Sterownik kieruje natywne żądanie do usług IIS na skonfigurowanym porcie witryny sieci Web, zwykle 80 (HTTP) lub 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="88a89-633">The driver routes the native request to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="88a89-634">Moduł ASP.NET Core odbiera żądanie natywne i przekazuje go do serwera HTTP usług IIS ( `IISHttpServer` ).</span><span class="sxs-lookup"><span data-stu-id="88a89-634">The ASP.NET Core Module receives the native request and passes it to IIS HTTP Server (`IISHttpServer`).</span></span> <span data-ttu-id="88a89-635">Serwer HTTP IIS jest implementacją serwera w procesie dla usług IIS, która konwertuje żądanie z natywnego na zarządzane.</span><span class="sxs-lookup"><span data-stu-id="88a89-635">IIS HTTP Server is an in-process server implementation for IIS that converts the request from native to managed.</span></span>

<span data-ttu-id="88a89-636">Po przetworzeniu żądania przez serwer HTTP IIS żądanie jest wypychane do potoku ASP.NET Core pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="88a89-636">After the IIS HTTP Server processes the request, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="88a89-637">Potok oprogramowania pośredniczącego obsługuje żądanie i przekazuje go jako `HttpContext` wystąpienie do logiki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-637">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="88a89-638">Odpowiedź aplikacji jest przesyłana z powrotem do usług IIS za pośrednictwem serwera HTTP IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-638">The app's response is passed back to IIS through IIS HTTP Server.</span></span> <span data-ttu-id="88a89-639">Program IIS wysyła odpowiedź do klienta, który zainicjował żądanie.</span><span class="sxs-lookup"><span data-stu-id="88a89-639">IIS sends the response to the client that initiated the request.</span></span>

<span data-ttu-id="88a89-640">Hosting w procesie jest nieobecny w przypadku istniejących aplikacji, ale w przypadku wszystkich scenariuszy z usługami w ramach programu z obsługą IIS Express usług w toku są domyślnie obsługiwane [nowe](/dotnet/core/tools/dotnet-new) szablony.</span><span class="sxs-lookup"><span data-stu-id="88a89-640">In-process hosting is opt-in for existing apps, but [dotnet new](/dotnet/core/tools/dotnet-new) templates default to the in-process hosting model for all IIS and IIS Express scenarios.</span></span>

<span data-ttu-id="88a89-641">`CreateDefaultBuilder` dodaje <xref:Microsoft.AspNetCore.Hosting.Server.IServer> wystąpienie przez wywołanie <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIIS%2A> metody w celu uruchomienia [CoreCLR](/dotnet/standard/glossary#coreclr) i hostowania aplikacji w procesie roboczym usług IIS ( *w3wp.exe* lub *iisexpress.exe* ).</span><span class="sxs-lookup"><span data-stu-id="88a89-641">`CreateDefaultBuilder` adds an <xref:Microsoft.AspNetCore.Hosting.Server.IServer> instance by calling the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIIS%2A> method to boot the [CoreCLR](/dotnet/standard/glossary#coreclr) and host the app inside of the IIS worker process ( *w3wp.exe* or *iisexpress.exe* ).</span></span> <span data-ttu-id="88a89-642">Testy wydajności wskazują, że hostowanie aplikacji platformy .NET Core w procesie zapewnia znacznie wyższą przepływność żądań w porównaniu z obsługą żądań serwera proxy poza procesem i serwerem [Kestrel](xref:fundamentals/servers/kestrel) .</span><span class="sxs-lookup"><span data-stu-id="88a89-642">Performance tests indicate that hosting a .NET Core app in-process delivers significantly higher request throughput compared to hosting the app out-of-process and proxying requests to [Kestrel](xref:fundamentals/servers/kestrel) server.</span></span>

### <a name="out-of-process-hosting-model"></a><span data-ttu-id="88a89-643">Model hostingu poza procesem</span><span class="sxs-lookup"><span data-stu-id="88a89-643">Out-of-process hosting model</span></span>

<span data-ttu-id="88a89-644">Ponieważ ASP.NET Core aplikacje działają w procesie innym niż proces roboczy usług IIS, moduł ASP.NET Core obsługuje zarządzanie procesami.</span><span class="sxs-lookup"><span data-stu-id="88a89-644">Because ASP.NET Core apps run in a process separate from the IIS worker process, the ASP.NET Core Module handles process management.</span></span> <span data-ttu-id="88a89-645">Moduł uruchamia proces dla aplikacji ASP.NET Core, gdy pierwsze żądanie zostanie odebrane i ponownie uruchomiony, jeśli zostanie zamknięty lub ulegnie awarii.</span><span class="sxs-lookup"><span data-stu-id="88a89-645">The module starts the process for the ASP.NET Core app when the first request arrives and restarts the app if it shuts down or crashes.</span></span> <span data-ttu-id="88a89-646">Jest to zasadniczo takie samo zachowanie jak w przypadku aplikacji uruchamianych w procesie, które są zarządzane przez [usługę aktywacji procesów systemu Windows (was)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="88a89-646">This is essentially the same behavior as seen with apps that run in-process that are managed by the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="88a89-647">Na poniższym diagramie przedstawiono relację między usługami IIS, modułem ASP.NET Core i hostowanym przez aplikację aplikacją:</span><span class="sxs-lookup"><span data-stu-id="88a89-647">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted out-of-process:</span></span>

![Moduł ASP.NET Core w scenariuszu hostingu poza procesem](index/_static/ancm-outofprocess.png)

<span data-ttu-id="88a89-649">Żądania docierają z sieci Web do sterownika HTTP.sys trybu jądra.</span><span class="sxs-lookup"><span data-stu-id="88a89-649">Requests arrive from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="88a89-650">Sterownik kieruje żądania do usług IIS na skonfigurowanym porcie witryny sieci Web, zwykle 80 (HTTP) lub 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="88a89-650">The driver routes the requests to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="88a89-651">Moduł przekazuje żądania do Kestrel na losowo wybranym porcie dla aplikacji, która nie jest portem 80 lub 443.</span><span class="sxs-lookup"><span data-stu-id="88a89-651">The module forwards the requests to Kestrel on a random port for the app, which isn't port 80 or 443.</span></span>

<span data-ttu-id="88a89-652">Moduł określa port za pośrednictwem zmiennej środowiskowej podczas uruchamiania, a <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> rozszerzenie konfiguruje serwer do nasłuchiwania `http://localhost:{PORT}` .</span><span class="sxs-lookup"><span data-stu-id="88a89-652">The module specifies the port via an environment variable at startup, and the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> extension configures the server to listen on `http://localhost:{PORT}`.</span></span> <span data-ttu-id="88a89-653">Dodatkowe sprawdzenia są wykonywane, a żądania, które nie pochodzą z modułu, są odrzucane.</span><span class="sxs-lookup"><span data-stu-id="88a89-653">Additional checks are performed, and requests that don't originate from the module are rejected.</span></span> <span data-ttu-id="88a89-654">Moduł nie obsługuje przekazywania HTTPS, dlatego żądania są przekazywane przez protokół HTTP nawet wtedy, gdy są odbierane przez usługę IIS przez protokół HTTPS.</span><span class="sxs-lookup"><span data-stu-id="88a89-654">The module doesn't support HTTPS forwarding, so requests are forwarded over HTTP even if received by IIS over HTTPS.</span></span>

<span data-ttu-id="88a89-655">Po podaniu przez Kestrel żądania z modułu żądanie jest wypychane do potoku ASP.NET Core pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="88a89-655">After Kestrel picks up the request from the module, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="88a89-656">Potok oprogramowania pośredniczącego obsługuje żądanie i przekazuje go jako `HttpContext` wystąpienie do logiki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-656">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="88a89-657">Oprogramowanie pośredniczące dodane przez integrację usług IIS aktualizuje schemat, zdalny adres IP i pathbase, aby można było przesłać żądanie do Kestrel.</span><span class="sxs-lookup"><span data-stu-id="88a89-657">Middleware added by IIS Integration updates the scheme, remote IP, and pathbase to account for forwarding the request to Kestrel.</span></span> <span data-ttu-id="88a89-658">Odpowiedź aplikacji jest przesyłana z powrotem do usług IIS, która wypycha ją z powrotem do klienta HTTP, który zainicjował żądanie.</span><span class="sxs-lookup"><span data-stu-id="88a89-658">The app's response is passed back to IIS, which pushes it back out to the HTTP client that initiated the request.</span></span>

<span data-ttu-id="88a89-659">Aby uzyskać wskazówki dotyczące konfiguracji modułu ASP.NET Core, zobacz <xref:host-and-deploy/aspnet-core-module> .</span><span class="sxs-lookup"><span data-stu-id="88a89-659">For ASP.NET Core Module configuration guidance, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

<span data-ttu-id="88a89-660">Aby uzyskać więcej informacji na temat hostingu, zobacz [host in ASP.NET Core](xref:fundamentals/index#host).</span><span class="sxs-lookup"><span data-stu-id="88a89-660">For more information on hosting, see [Host in ASP.NET Core](xref:fundamentals/index#host).</span></span>

## <a name="application-configuration"></a><span data-ttu-id="88a89-661">Konfiguracja aplikacji</span><span class="sxs-lookup"><span data-stu-id="88a89-661">Application configuration</span></span>

### <a name="enable-the-iisintegration-components"></a><span data-ttu-id="88a89-662">Włącz składniki IISIntegration</span><span class="sxs-lookup"><span data-stu-id="88a89-662">Enable the IISIntegration components</span></span>

<span data-ttu-id="88a89-663">Podczas kompilowania hosta w `CreateWebHostBuilder` ( *program.cs* ), wywołaj, <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder%2A> Aby włączyć integrację usług IIS:</span><span class="sxs-lookup"><span data-stu-id="88a89-663">When building a host in `CreateWebHostBuilder` ( *Program.cs* ), call <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder%2A> to enable IIS integration:</span></span>

```csharp
public static IWebHostBuilder CreateWebHostBuilder(string[] args) =>
    WebHost.CreateDefaultBuilder(args)
        ...
```

<span data-ttu-id="88a89-664">Aby uzyskać więcej informacji na temat `CreateDefaultBuilder` , zobacz <xref:fundamentals/host/web-host#set-up-a-host> .</span><span class="sxs-lookup"><span data-stu-id="88a89-664">For more information on `CreateDefaultBuilder`, see <xref:fundamentals/host/web-host#set-up-a-host>.</span></span>

### <a name="iis-options"></a><span data-ttu-id="88a89-665">Opcje usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-665">IIS options</span></span>

<span data-ttu-id="88a89-666">**Model hostingu w procesie**</span><span class="sxs-lookup"><span data-stu-id="88a89-666">**In-process hosting model**</span></span>

<span data-ttu-id="88a89-667">Aby skonfigurować opcje serwera usług IIS, należy uwzględnić <xref:Microsoft.AspNetCore.Builder.IISServerOptions> w programie konfigurację usługi <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices%2A> .</span><span class="sxs-lookup"><span data-stu-id="88a89-667">To configure IIS Server options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISServerOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices%2A>.</span></span> <span data-ttu-id="88a89-668">Poniższy przykład wyłącza AutomaticAuthentication:</span><span class="sxs-lookup"><span data-stu-id="88a89-668">The following example disables AutomaticAuthentication:</span></span>

```csharp
services.Configure<IISServerOptions>(options => 
{
    options.AutomaticAuthentication = false;
});
```

| <span data-ttu-id="88a89-669">Opcja</span><span class="sxs-lookup"><span data-stu-id="88a89-669">Option</span></span>                         | <span data-ttu-id="88a89-670">Domyślne</span><span class="sxs-lookup"><span data-stu-id="88a89-670">Default</span></span> | <span data-ttu-id="88a89-671">Ustawienie</span><span class="sxs-lookup"><span data-stu-id="88a89-671">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="88a89-672">Jeśli `true` serwer usług IIS ustawi uwierzytelnienie `HttpContext.User` za pomocą [uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-672">If `true`, IIS Server sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="88a89-673">Jeśli `false` serwer zawiera tylko tożsamość dla `HttpContext.User` i reaguje na wyzwania, gdy zostanie jawnie zlecony przez `AuthenticationScheme` .</span><span class="sxs-lookup"><span data-stu-id="88a89-673">If `false`, the server only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="88a89-674">Aby program mógł działać, należy włączyć uwierzytelnianie systemu Windows `AutomaticAuthentication` .</span><span class="sxs-lookup"><span data-stu-id="88a89-674">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="88a89-675">Aby uzyskać więcej informacji, zobacz [uwierzytelnianie systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-675">For more information, see [Windows Authentication](xref:security/authentication/windowsauth).</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="88a89-676">Ustawia nazwę wyświetlaną pokazywaną użytkownikom na stronach logowania.</span><span class="sxs-lookup"><span data-stu-id="88a89-676">Sets the display name shown to users on login pages.</span></span> |

<span data-ttu-id="88a89-677">**Model hostingu poza procesem**</span><span class="sxs-lookup"><span data-stu-id="88a89-677">**Out-of-process hosting model**</span></span>

<span data-ttu-id="88a89-678">Aby skonfigurować opcje usług IIS, należy uwzględnić <xref:Microsoft.AspNetCore.Builder.IISOptions> w programie konfigurację usługi <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*> .</span><span class="sxs-lookup"><span data-stu-id="88a89-678">To configure IIS options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span></span> <span data-ttu-id="88a89-679">Poniższy przykład uniemożliwia wypełnianie aplikacji `HttpContext.Connection.ClientCertificate` :</span><span class="sxs-lookup"><span data-stu-id="88a89-679">The following example prevents the app from populating `HttpContext.Connection.ClientCertificate`:</span></span>

```csharp
services.Configure<IISOptions>(options => 
{
    options.ForwardClientCertificate = false;
});
```

| <span data-ttu-id="88a89-680">Opcja</span><span class="sxs-lookup"><span data-stu-id="88a89-680">Option</span></span>                         | <span data-ttu-id="88a89-681">Domyślne</span><span class="sxs-lookup"><span data-stu-id="88a89-681">Default</span></span> | <span data-ttu-id="88a89-682">Ustawienie</span><span class="sxs-lookup"><span data-stu-id="88a89-682">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="88a89-683">Jeśli `true` [oprogramowanie pośredniczące integracji usług IIS](#enable-the-iisintegration-components) ustawi uwierzytelnienie `HttpContext.User` za pomocą [uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-683">If `true`, [IIS Integration Middleware](#enable-the-iisintegration-components) sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="88a89-684">Jeśli `false` oprogramowanie pośredniczące zapewnia tylko tożsamość `HttpContext.User` i reaguje na wyzwania, gdy zostanie jawnie zażądana przez program `AuthenticationScheme` .</span><span class="sxs-lookup"><span data-stu-id="88a89-684">If `false`, the middleware only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="88a89-685">Aby program mógł działać, należy włączyć uwierzytelnianie systemu Windows `AutomaticAuthentication` .</span><span class="sxs-lookup"><span data-stu-id="88a89-685">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="88a89-686">Aby uzyskać więcej informacji, zobacz temat [uwierzytelnianie systemu Windows](xref:security/authentication/windowsauth) .</span><span class="sxs-lookup"><span data-stu-id="88a89-686">For more information, see the [Windows Authentication](xref:security/authentication/windowsauth) topic.</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="88a89-687">Ustawia nazwę wyświetlaną pokazywaną użytkownikom na stronach logowania.</span><span class="sxs-lookup"><span data-stu-id="88a89-687">Sets the display name shown to users on login pages.</span></span> |
| `ForwardClientCertificate`     | `true`  | <span data-ttu-id="88a89-688">Jeśli `true` `MS-ASPNETCORE-CLIENTCERT` jest obecny nagłówek żądania, `HttpContext.Connection.ClientCertificate` zostanie wypełniony.</span><span class="sxs-lookup"><span data-stu-id="88a89-688">If `true` and the `MS-ASPNETCORE-CLIENTCERT` request header is present, the `HttpContext.Connection.ClientCertificate` is populated.</span></span> |

### <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="88a89-689">Scenariusze serwera proxy i modułu równoważenia obciążenia</span><span class="sxs-lookup"><span data-stu-id="88a89-689">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="88a89-690">[Oprogramowanie pośredniczące integracji usług IIS](#enable-the-iisintegration-components), które konfiguruje przekazane nagłówki oprogramowania pośredniczącego, a moduł ASP.NET Core jest skonfigurowany do przesyłania dalej schematu (http/https) i zdalnego adresu IP, z którego pochodzi żądanie.</span><span class="sxs-lookup"><span data-stu-id="88a89-690">The [IIS Integration Middleware](#enable-the-iisintegration-components), which configures Forwarded Headers Middleware, and the ASP.NET Core Module are configured to forward the scheme (HTTP/HTTPS) and the remote IP address where the request originated.</span></span> <span data-ttu-id="88a89-691">W przypadku aplikacji hostowanych za dodatkowymi serwerami proxy i modułami równoważenia obciążenia może być wymagana dodatkowa konfiguracja.</span><span class="sxs-lookup"><span data-stu-id="88a89-691">Additional configuration might be required for apps hosted behind additional proxy servers and load balancers.</span></span> <span data-ttu-id="88a89-692">Aby uzyskać więcej informacji, zobacz [konfigurowanie ASP.NET Core do pracy z serwerami proxy i usługami równoważenia obciążenia](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="88a89-692">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

### <a name="webconfig-file"></a><span data-ttu-id="88a89-693">Plik web.config</span><span class="sxs-lookup"><span data-stu-id="88a89-693">web.config file</span></span>

<span data-ttu-id="88a89-694">Plik *web.config* konfiguruje [moduł ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="88a89-694">The *web.config* file configures the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="88a89-695">Tworzenie, przekształcanie i publikowanie pliku *web.config* jest obsługiwane przez obiekt docelowy MSBuild ( `_TransformWebConfig` ), gdy projekt jest publikowany.</span><span class="sxs-lookup"><span data-stu-id="88a89-695">Creating, transforming, and publishing the *web.config* file is handled by an MSBuild target (`_TransformWebConfig`) when the project is published.</span></span> <span data-ttu-id="88a89-696">Ten element docelowy znajduje się w obiektach docelowych zestawu SDK sieci Web ( `Microsoft.NET.Sdk.Web` ).</span><span class="sxs-lookup"><span data-stu-id="88a89-696">This target is present in the Web SDK targets (`Microsoft.NET.Sdk.Web`).</span></span> <span data-ttu-id="88a89-697">Zestaw SDK jest ustawiany u góry pliku projektu:</span><span class="sxs-lookup"><span data-stu-id="88a89-697">The SDK is set at the top of the project file:</span></span>

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">
```

<span data-ttu-id="88a89-698">Jeśli plik *web.config* nie jest obecny w projekcie, plik zostanie utworzony z prawidłowymi *argumentami* *ProcessPath* i, aby skonfigurować moduł ASP.NET Core i przeniesiony do [publikowanych danych wyjściowych](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="88a89-698">If a *web.config* file isn't present in the project, the file is created with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to [published output](xref:host-and-deploy/directory-structure).</span></span>

<span data-ttu-id="88a89-699">Jeśli plik *web.config* jest obecny w projekcie, plik zostanie przekształcony przy użyciu poprawnych *processPath* i *argumentów* w celu skonfigurowania modułu ASP.NET Core i przeniesiona do publikowanych danych wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="88a89-699">If a *web.config* file is present in the project, the file is transformed with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to published output.</span></span> <span data-ttu-id="88a89-700">Transformacja nie modyfikuje ustawień konfiguracji usług IIS w pliku.</span><span class="sxs-lookup"><span data-stu-id="88a89-700">The transformation doesn't modify IIS configuration settings in the file.</span></span>

<span data-ttu-id="88a89-701">Plik *web.config* może zapewnić dodatkowe ustawienia konfiguracji usług IIS kontrolujące aktywne moduły usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-701">The *web.config* file may provide additional IIS configuration settings that control active IIS modules.</span></span> <span data-ttu-id="88a89-702">Aby uzyskać informacje na temat modułów usług IIS, które mogą przetwarzać żądania z aplikacjami ASP.NET Core, zobacz temat [moduły usług IIS](xref:host-and-deploy/iis/modules) .</span><span class="sxs-lookup"><span data-stu-id="88a89-702">For information on IIS modules that are capable of processing requests with ASP.NET Core apps, see the [IIS modules](xref:host-and-deploy/iis/modules) topic.</span></span>

<span data-ttu-id="88a89-703">Aby zapobiec transformacji pliku *web.config* przez zestaw SDK sieci Web, należy użyć **\<IsTransformWebConfigDisabled>** właściwości w pliku projektu:</span><span class="sxs-lookup"><span data-stu-id="88a89-703">To prevent the Web SDK from transforming the *web.config* file, use the **\<IsTransformWebConfigDisabled>** property in the project file:</span></span>

```xml
<PropertyGroup>
  <IsTransformWebConfigDisabled>true</IsTransformWebConfigDisabled>
</PropertyGroup>
```

<span data-ttu-id="88a89-704">Podczas wyłączania pliku zestawu SDK sieci Web, *processPath* i *argumenty* powinny być ustawiane ręcznie przez dewelopera.</span><span class="sxs-lookup"><span data-stu-id="88a89-704">When disabling the Web SDK from transforming the file, the *processPath* and *arguments* should be manually set by the developer.</span></span> <span data-ttu-id="88a89-705">Aby uzyskać więcej informacji, zobacz <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="88a89-705">For more information, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

### <a name="webconfig-file-location"></a><span data-ttu-id="88a89-706">Lokalizacja pliku web.config</span><span class="sxs-lookup"><span data-stu-id="88a89-706">web.config file location</span></span>

<span data-ttu-id="88a89-707">W celu poprawnego skonfigurowania [modułu ASP.NET Core](xref:host-and-deploy/aspnet-core-module) plik *web.config* musi znajdować się w ścieżce [katalogu głównego zawartości](xref:fundamentals/index#content-root) (zazwyczaj ścieżka podstawowa aplikacji) wdrożonej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-707">In order to set up the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) correctly, the *web.config* file must be present at the [content root](xref:fundamentals/index#content-root) path (typically the app base path) of the deployed app.</span></span> <span data-ttu-id="88a89-708">Ta sama lokalizacja jest taka sama jak ścieżka fizyczna witryny sieci Web dostarczana do usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-708">This is the same location as the website physical path provided to IIS.</span></span> <span data-ttu-id="88a89-709">Plik *web.config* jest wymagany w katalogu głównym aplikacji, aby umożliwić Publikowanie wielu aplikacji przy użyciu Web Deploy.</span><span class="sxs-lookup"><span data-stu-id="88a89-709">The *web.config* file is required at the root of the app to enable the publishing of multiple apps using Web Deploy.</span></span>

<span data-ttu-id="88a89-710">Poufne pliki znajdują się w ścieżce fizycznej aplikacji, na przykład *\<assembly>.runtimeconfig.jsna* , *\<assembly> . XML* (Komentarze dokumentacji XML) i *\<assembly>.deps.js* .</span><span class="sxs-lookup"><span data-stu-id="88a89-710">Sensitive files exist on the app's physical path, such as *\<assembly>.runtimeconfig.json* , *\<assembly>.xml* (XML Documentation comments), and *\<assembly>.deps.json* .</span></span> <span data-ttu-id="88a89-711">Gdy plik *web.config* jest obecny, a lokacja jest uruchamiana normalnie, usługi IIS nie będą obsługiwały tych poufnych plików, jeśli są żądane.</span><span class="sxs-lookup"><span data-stu-id="88a89-711">When the *web.config* file is present and the site starts normally, IIS doesn't serve these sensitive files if they're requested.</span></span> <span data-ttu-id="88a89-712">Jeśli brakuje pliku *web.config* , nazwa jest nieprawidłowa lub nie można skonfigurować lokacji do normalnego uruchamiania, usługi IIS mogą publicznie udostępniać poufne pliki.</span><span class="sxs-lookup"><span data-stu-id="88a89-712">If the *web.config* file is missing, incorrectly named, or unable to configure the site for normal startup, IIS may serve sensitive files publicly.</span></span>

<span data-ttu-id="88a89-713">**Plik *web.config* musi być obecny we wdrożeniu przez cały czas, prawidłowo nazwany i można skonfigurować lokację pod kątem normalnego uruchamiania. Nigdy nie usuwaj pliku *web.config* z wdrożenia produkcyjnego.**</span><span class="sxs-lookup"><span data-stu-id="88a89-713">**The *web.config* file must be present in the deployment at all times, correctly named, and able to configure the site for normal start up. Never remove the *web.config* file from a production deployment.**</span></span>

### <a name="transform-webconfig"></a><span data-ttu-id="88a89-714">Przekształcanie pliku web.config</span><span class="sxs-lookup"><span data-stu-id="88a89-714">Transform web.config</span></span>

<span data-ttu-id="88a89-715">Jeśli musisz przekształcić *web.config* przy publikowaniu (na przykład ustawić zmienne środowiskowe na podstawie konfiguracji, profilu lub środowiska), zobacz <xref:host-and-deploy/iis/transform-webconfig> .</span><span class="sxs-lookup"><span data-stu-id="88a89-715">If you need to transform *web.config* on publish (for example, set environment variables based on the configuration, profile, or environment), see <xref:host-and-deploy/iis/transform-webconfig>.</span></span>

## <a name="iis-configuration"></a><span data-ttu-id="88a89-716">Konfiguracja usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-716">IIS configuration</span></span>

<span data-ttu-id="88a89-717">**Systemy operacyjne Windows Server**</span><span class="sxs-lookup"><span data-stu-id="88a89-717">**Windows Server operating systems**</span></span>

<span data-ttu-id="88a89-718">Włącz rolę serwera **serwera sieci Web (IIS)** i Ustanów usługi ról.</span><span class="sxs-lookup"><span data-stu-id="88a89-718">Enable the **Web Server (IIS)** server role and establish role services.</span></span>

1. <span data-ttu-id="88a89-719">Użyj kreatora **dodawania ról i funkcji** z menu **Zarządzaj** lub łącza w **Menedżer serwera** .</span><span class="sxs-lookup"><span data-stu-id="88a89-719">Use the **Add Roles and Features** wizard from the **Manage** menu or the link in **Server Manager** .</span></span> <span data-ttu-id="88a89-720">W kroku **role serwera** zaznacz pole wyboru **serwer sieci Web (IIS)** .</span><span class="sxs-lookup"><span data-stu-id="88a89-720">On the **Server Roles** step, check the box for **Web Server (IIS)** .</span></span>

   ![W kroku wybierz role serwera zostanie wybrana rola IIS serwera sieci Web.](index/_static/server-roles-ws2016.png)

1. <span data-ttu-id="88a89-722">Po wykonaniu **kroków krok po kroku** **usługi ról** są ładowane dla serwera sieci Web (IIS).</span><span class="sxs-lookup"><span data-stu-id="88a89-722">After the **Features** step, the **Role services** step loads for Web Server (IIS).</span></span> <span data-ttu-id="88a89-723">Wybierz żądane usługi roli IIS lub zaakceptuj domyślne usługi ról.</span><span class="sxs-lookup"><span data-stu-id="88a89-723">Select the IIS role services desired or accept the default role services provided.</span></span>

   ![Domyślne usługi ról są wybrane w kroku Wybierz usługi ról.](index/_static/role-services-ws2016.png)

   <span data-ttu-id="88a89-725">**Uwierzytelnianie systemu Windows (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-725">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="88a89-726">Aby włączyć uwierzytelnianie systemu Windows, rozwiń następujące węzły: **Zabezpieczenia serwera sieci Web**  >  **Security** .</span><span class="sxs-lookup"><span data-stu-id="88a89-726">To enable Windows Authentication, expand the following nodes: **Web Server** > **Security** .</span></span> <span data-ttu-id="88a89-727">Wybierz funkcję **uwierzytelniania systemu Windows** .</span><span class="sxs-lookup"><span data-stu-id="88a89-727">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="88a89-728">Aby uzyskać więcej informacji, zobacz [uwierzytelnianie \<windowsAuthentication> systemu Windows](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) i [Konfigurowanie uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-728">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="88a89-729">**Obiekty WebSockets (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-729">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="88a89-730">Obiekty WebSockets są obsługiwane w ASP.NET Core 1,1 lub nowszych.</span><span class="sxs-lookup"><span data-stu-id="88a89-730">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="88a89-731">Aby włączyć obiekty WebSockets, rozwiń następujące węzły: projektowanie aplikacji **serwera sieci Web**  >  **Application Development** .</span><span class="sxs-lookup"><span data-stu-id="88a89-731">To enable WebSockets, expand the following nodes: **Web Server** > **Application Development** .</span></span> <span data-ttu-id="88a89-732">Wybierz funkcję **protokołu WebSocket** .</span><span class="sxs-lookup"><span data-stu-id="88a89-732">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="88a89-733">Aby uzyskać więcej informacji, zobacz [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="88a89-733">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="88a89-734">Przejdź do kroku **potwierdzenia** , aby zainstalować rolę i usługi serwera sieci Web.</span><span class="sxs-lookup"><span data-stu-id="88a89-734">Proceed through the **Confirmation** step to install the web server role and services.</span></span> <span data-ttu-id="88a89-735">Po zainstalowaniu roli **serwera sieci Web (IIS)** nie jest wymagane ponowne uruchomienie serwera ani usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-735">A server/IIS restart isn't required after installing the **Web Server (IIS)** role.</span></span>

<span data-ttu-id="88a89-736">**Systemy operacyjne Windows dla komputerów stacjonarnych**</span><span class="sxs-lookup"><span data-stu-id="88a89-736">**Windows desktop operating systems**</span></span>

<span data-ttu-id="88a89-737">Włącz **konsolę zarządzania usług IIS** i **usługi World Wide Web** .</span><span class="sxs-lookup"><span data-stu-id="88a89-737">Enable the **IIS Management Console** and **World Wide Web Services** .</span></span>

1. <span data-ttu-id="88a89-738">Przejdź do pozycji **Panel sterowania** > **programy** > **programy i funkcje** > **Włącz lub wyłącz funkcje systemu Windows** (po lewej stronie ekranu).</span><span class="sxs-lookup"><span data-stu-id="88a89-738">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>

1. <span data-ttu-id="88a89-739">Otwórz węzeł **Internet Information Services** .</span><span class="sxs-lookup"><span data-stu-id="88a89-739">Open the **Internet Information Services** node.</span></span> <span data-ttu-id="88a89-740">Otwórz węzeł **Narzędzia do zarządzania siecią Web** .</span><span class="sxs-lookup"><span data-stu-id="88a89-740">Open the **Web Management Tools** node.</span></span>

1. <span data-ttu-id="88a89-741">Zaznacz pole wyboru w obszarze **Konsola zarządzania usługami IIS** .</span><span class="sxs-lookup"><span data-stu-id="88a89-741">Check the box for **IIS Management Console** .</span></span>

1. <span data-ttu-id="88a89-742">Zaznacz pole wyboru **usług World Wide Web Services** .</span><span class="sxs-lookup"><span data-stu-id="88a89-742">Check the box for **World Wide Web Services** .</span></span>

1. <span data-ttu-id="88a89-743">Zaakceptuj domyślne funkcje **usług World Wide Web Services** lub Dostosuj funkcje usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-743">Accept the default features for **World Wide Web Services** or customize the IIS features.</span></span>

   <span data-ttu-id="88a89-744">**Uwierzytelnianie systemu Windows (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-744">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="88a89-745">Aby włączyć uwierzytelnianie systemu Windows, rozwiń następujące węzły: **World Wide Web usług**  >  **zabezpieczenia** .</span><span class="sxs-lookup"><span data-stu-id="88a89-745">To enable Windows Authentication, expand the following nodes: **World Wide Web Services** > **Security** .</span></span> <span data-ttu-id="88a89-746">Wybierz funkcję **uwierzytelniania systemu Windows** .</span><span class="sxs-lookup"><span data-stu-id="88a89-746">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="88a89-747">Aby uzyskać więcej informacji, zobacz [uwierzytelnianie \<windowsAuthentication> systemu Windows](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) i [Konfigurowanie uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-747">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="88a89-748">**Obiekty WebSockets (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-748">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="88a89-749">Obiekty WebSockets są obsługiwane w ASP.NET Core 1,1 lub nowszych.</span><span class="sxs-lookup"><span data-stu-id="88a89-749">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="88a89-750">Aby włączyć obiekty WebSockets, rozwiń następujące węzły: **World Wide Web Services**  >  **Application Development Features** .</span><span class="sxs-lookup"><span data-stu-id="88a89-750">To enable WebSockets, expand the following nodes: **World Wide Web Services** > **Application Development Features** .</span></span> <span data-ttu-id="88a89-751">Wybierz funkcję **protokołu WebSocket** .</span><span class="sxs-lookup"><span data-stu-id="88a89-751">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="88a89-752">Aby uzyskać więcej informacji, zobacz [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="88a89-752">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="88a89-753">Jeśli instalacja usług IIS wymaga ponownego uruchomienia, należy ponownie uruchomić system.</span><span class="sxs-lookup"><span data-stu-id="88a89-753">If the IIS installation requires a restart, restart the system.</span></span>

![Konsola zarządzania usługami IIS i usługi World Wide Web są wybrane w funkcjach systemu Windows.](index/_static/windows-features-win10.png)

## <a name="install-the-net-core-hosting-bundle"></a><span data-ttu-id="88a89-755">Zainstaluj pakiet hostingu platformy .NET Core</span><span class="sxs-lookup"><span data-stu-id="88a89-755">Install the .NET Core Hosting Bundle</span></span>

<span data-ttu-id="88a89-756">Zainstaluj *pakiet hostingu platformy .NET Core* w systemie hostingu.</span><span class="sxs-lookup"><span data-stu-id="88a89-756">Install the *.NET Core Hosting Bundle* on the hosting system.</span></span> <span data-ttu-id="88a89-757">Pakiet instaluje środowisko uruchomieniowe programu .NET Core, bibliotekę .NET Core i [moduł ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="88a89-757">The bundle installs the .NET Core Runtime, .NET Core Library, and the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="88a89-758">Moduł umożliwia uruchamianie aplikacji ASP.NET Core za pomocą usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-758">The module allows ASP.NET Core apps to run behind IIS.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="88a89-759">Jeśli pakiet hostingu jest zainstalowany przed usługami IIS, należy naprawić pakiet instalacyjny.</span><span class="sxs-lookup"><span data-stu-id="88a89-759">If the Hosting Bundle is installed before IIS, the bundle installation must be repaired.</span></span> <span data-ttu-id="88a89-760">Uruchom ponownie Instalatora pakietu hostingu po zainstalowaniu usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-760">Run the Hosting Bundle installer again after installing IIS.</span></span>
>
> <span data-ttu-id="88a89-761">Jeśli pakiet hostingu jest instalowany po zainstalowaniu 64-bitowej (x64) wersji programu .NET Core, prawdopodobnie brakuje zestawów SDK ([nie wykryto żadnych zestawów SDK dla platformy .NET Core](xref:test/troubleshoot#no-net-core-sdks-were-detected)).</span><span class="sxs-lookup"><span data-stu-id="88a89-761">If the Hosting Bundle is installed after installing the 64-bit (x64) version of .NET Core, SDKs might appear to be missing ([No .NET Core SDKs were detected](xref:test/troubleshoot#no-net-core-sdks-were-detected)).</span></span> <span data-ttu-id="88a89-762">Aby rozwiązać ten problem, zobacz <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle> .</span><span class="sxs-lookup"><span data-stu-id="88a89-762">To resolve the problem, see <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle>.</span></span>

### <a name="download"></a><span data-ttu-id="88a89-763">Pobierz</span><span class="sxs-lookup"><span data-stu-id="88a89-763">Download</span></span>

1. <span data-ttu-id="88a89-764">Przejdź do strony [pobieranie platformy .NET Core](https://dotnet.microsoft.com/download/dotnet-core) .</span><span class="sxs-lookup"><span data-stu-id="88a89-764">Navigate to the [Download .NET Core](https://dotnet.microsoft.com/download/dotnet-core) page.</span></span>
1. <span data-ttu-id="88a89-765">Wybierz żądaną wersję programu .NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-765">Select the desired .NET Core version.</span></span>
1. <span data-ttu-id="88a89-766">W kolumnie **Uruchom aplikacje — środowisko uruchomieniowe** Znajdź wiersz żądanej wersji środowiska uruchomieniowego platformy .NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-766">In the **Run apps - Runtime** column, find the row of the .NET Core runtime version desired.</span></span>
1. <span data-ttu-id="88a89-767">Pobierz instalatora przy użyciu linku do **pakietu hostingu** .</span><span class="sxs-lookup"><span data-stu-id="88a89-767">Download the installer using the **Hosting Bundle** link.</span></span>

> [!WARNING]
> <span data-ttu-id="88a89-768">Niektóre Instalatory zawierają wersje wydania, które osiągnęły koniec cyklu życia (EOL) i nie są już obsługiwane przez firmę Microsoft.</span><span class="sxs-lookup"><span data-stu-id="88a89-768">Some installers contain release versions that have reached their end of life (EOL) and are no longer supported by Microsoft.</span></span> <span data-ttu-id="88a89-769">Aby uzyskać więcej informacji, zobacz [zasady pomocy technicznej](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span><span class="sxs-lookup"><span data-stu-id="88a89-769">For more information, see the [support policy](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span></span>

### <a name="install-the-hosting-bundle"></a><span data-ttu-id="88a89-770">Zainstaluj pakiet hostingu</span><span class="sxs-lookup"><span data-stu-id="88a89-770">Install the Hosting Bundle</span></span>

1. <span data-ttu-id="88a89-771">Uruchom Instalatora na serwerze.</span><span class="sxs-lookup"><span data-stu-id="88a89-771">Run the installer on the server.</span></span> <span data-ttu-id="88a89-772">Następujące parametry są dostępne podczas uruchamiania Instalatora z powłoki poleceń administratora:</span><span class="sxs-lookup"><span data-stu-id="88a89-772">The following parameters are available when running the installer from an administrator command shell:</span></span>

   * <span data-ttu-id="88a89-773">`OPT_NO_ANCM=1`: Pomiń Instalowanie modułu ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-773">`OPT_NO_ANCM=1`: Skip installing the ASP.NET Core Module.</span></span>
   * <span data-ttu-id="88a89-774">`OPT_NO_RUNTIME=1`: Pomiń Instalowanie środowiska uruchomieniowego platformy .NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-774">`OPT_NO_RUNTIME=1`: Skip installing the .NET Core runtime.</span></span> <span data-ttu-id="88a89-775">Używany, gdy serwer obsługuje tylko [wdrożenia samodzielne (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span><span class="sxs-lookup"><span data-stu-id="88a89-775">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="88a89-776">`OPT_NO_SHAREDFX=1`: Pomiń instalację ASP.NET Shared Framework (ASP.NET Runtime).</span><span class="sxs-lookup"><span data-stu-id="88a89-776">`OPT_NO_SHAREDFX=1`: Skip installing the ASP.NET Shared Framework (ASP.NET runtime).</span></span> <span data-ttu-id="88a89-777">Używany, gdy serwer obsługuje tylko [wdrożenia samodzielne (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span><span class="sxs-lookup"><span data-stu-id="88a89-777">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="88a89-778">`OPT_NO_X86=1`: Pomiń Instalowanie środowiska uruchomieniowego x86.</span><span class="sxs-lookup"><span data-stu-id="88a89-778">`OPT_NO_X86=1`: Skip installing x86 runtimes.</span></span> <span data-ttu-id="88a89-779">Użyj tego parametru, Jeśli wiesz, że nie będziesz hostować aplikacji 32-bitowych.</span><span class="sxs-lookup"><span data-stu-id="88a89-779">Use this parameter when you know that you won't be hosting 32-bit apps.</span></span> <span data-ttu-id="88a89-780">Jeśli w przyszłości będziesz hostować zarówno aplikacje 32-bitowe, jak i 64-bitowe, nie używaj tego parametru i zainstaluj oba środowiska uruchomieniowe.</span><span class="sxs-lookup"><span data-stu-id="88a89-780">If there's any chance that you will host both 32-bit and 64-bit apps in the future, don't use this parameter and install both runtimes.</span></span>
   * <span data-ttu-id="88a89-781">`OPT_NO_SHARED_CONFIG_CHECK=1`: Wyłącz sprawdzanie przy użyciu konfiguracji udostępnionej usług IIS, gdy konfiguracja udostępniona ( *applicationHost.config* ) znajduje się na tym samym komputerze, na którym zainstalowano program IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-781">`OPT_NO_SHARED_CONFIG_CHECK=1`: Disable the check for using an IIS Shared Configuration when the shared configuration ( *applicationHost.config* ) is on the same machine as the IIS installation.</span></span> <span data-ttu-id="88a89-782">*Dostępne tylko w przypadku ASP.NET Core 2,2 lub nowszych instalatorów pakietu do obsługi.*</span><span class="sxs-lookup"><span data-stu-id="88a89-782">*Only available for ASP.NET Core 2.2 or later Hosting Bundler installers.*</span></span> <span data-ttu-id="88a89-783">Aby uzyskać więcej informacji, zobacz <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span><span class="sxs-lookup"><span data-stu-id="88a89-783">For more information, see <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span></span>
1. <span data-ttu-id="88a89-784">Uruchom ponownie system lub wykonaj następujące polecenia w powłoce poleceń:</span><span class="sxs-lookup"><span data-stu-id="88a89-784">Restart the system or execute the following commands in a command shell:</span></span>

   ```console
   net stop was /y
   net start w3svc
   ```
   <span data-ttu-id="88a89-785">Ponowne uruchomienie usług IIS powoduje zmianę ścieżki systemowej, która jest zmienną środowiskową, wykonaną przez Instalatora.</span><span class="sxs-lookup"><span data-stu-id="88a89-785">Restarting IIS picks up a change to the system PATH, which is an environment variable, made by the installer.</span></span>

<span data-ttu-id="88a89-786">Nie jest konieczne ręczne zatrzymanie poszczególnych lokacji w usługach IIS podczas instalowania pakietu hostingu.</span><span class="sxs-lookup"><span data-stu-id="88a89-786">It isn't necessary to manually stop individual sites in IIS when installing the Hosting Bundle.</span></span> <span data-ttu-id="88a89-787">Aplikacje hostowane (lokacje IIS) są ponownie uruchamiane po ponownym uruchomieniu usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-787">Hosted apps (IIS sites) restart when IIS restarts.</span></span> <span data-ttu-id="88a89-788">Aplikacje są uruchamiane ponownie po otrzymaniu pierwszego żądania, w tym od [modułu inicjalizacji aplikacji](#application-initialization-module-and-idle-timeout).</span><span class="sxs-lookup"><span data-stu-id="88a89-788">Apps start up again when they receive their first request, including from the [Application Initialization Module](#application-initialization-module-and-idle-timeout).</span></span>

<span data-ttu-id="88a89-789">ASP.NET Core przyjmuje zachowanie funkcji przekazywania do przodu dla wydań poprawek udostępnionych pakietów platformy.</span><span class="sxs-lookup"><span data-stu-id="88a89-789">ASP.NET Core adopts roll-forward behavior for patch releases of shared framework packages.</span></span> <span data-ttu-id="88a89-790">Po ponownym uruchomieniu aplikacji hostowanych przez usługi IIS przy użyciu usług IIS aplikacje są ładowane z najnowszymi wersjami poprawki pakietów, do których się odwołują, gdy otrzymają swoje pierwsze żądanie.</span><span class="sxs-lookup"><span data-stu-id="88a89-790">When apps hosted by IIS restart with IIS, the apps load with the latest patch releases of their referenced packages when they receive their first request.</span></span> <span data-ttu-id="88a89-791">Jeśli usługi IIS nie zostaną ponownie uruchomione, aplikacje ponownie uruchamiają się i wykazują zachowanie przekazujące, gdy procesy robocze są odtwarzane i otrzymują swoje pierwsze żądanie.</span><span class="sxs-lookup"><span data-stu-id="88a89-791">If IIS isn't restarted, apps restart and exhibit roll-forward behavior when their worker processes are recycled and they receive their first request.</span></span>

> [!NOTE]
> <span data-ttu-id="88a89-792">Aby uzyskać informacje na temat konfiguracji udostępnionej usług IIS, zobacz [ASP.NET Core Module z udostępnioną konfiguracją usług IIS](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span><span class="sxs-lookup"><span data-stu-id="88a89-792">For information on IIS Shared Configuration, see [ASP.NET Core Module with IIS Shared Configuration](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span></span>

## <a name="install-web-deploy-when-publishing-with-visual-studio"></a><span data-ttu-id="88a89-793">Zainstaluj Web Deploy przy publikowaniu w programie Visual Studio</span><span class="sxs-lookup"><span data-stu-id="88a89-793">Install Web Deploy when publishing with Visual Studio</span></span>

<span data-ttu-id="88a89-794">Podczas wdrażania aplikacji na serwerach z [Web Deploy](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later)Zainstaluj najnowszą wersję Web Deploy na serwerze.</span><span class="sxs-lookup"><span data-stu-id="88a89-794">When deploying apps to servers with [Web Deploy](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later), install the latest version of Web Deploy on the server.</span></span> <span data-ttu-id="88a89-795">Aby zainstalować Web Deploy, należy użyć [Instalatora platformy sieci Web (Instalatora WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) lub uzyskać instalatora bezpośrednio z [Centrum pobierania Microsoft](https://www.microsoft.com/download/details.aspx?id=43717).</span><span class="sxs-lookup"><span data-stu-id="88a89-795">To install Web Deploy, use the [Web Platform Installer (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) or obtain an installer directly from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=43717).</span></span> <span data-ttu-id="88a89-796">Preferowaną metodą jest użycie Instalatora WebPI.</span><span class="sxs-lookup"><span data-stu-id="88a89-796">The preferred method is to use WebPI.</span></span> <span data-ttu-id="88a89-797">Instalatora WebPI oferuje autonomiczną konfigurację i konfigurację dla dostawców hostingu.</span><span class="sxs-lookup"><span data-stu-id="88a89-797">WebPI offers a standalone setup and a configuration for hosting providers.</span></span>

## <a name="create-the-iis-site"></a><span data-ttu-id="88a89-798">Tworzenie witryny usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-798">Create the IIS site</span></span>

1. <span data-ttu-id="88a89-799">W systemie hostingu Utwórz folder, który będzie zawierać opublikowane foldery i pliki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-799">On the hosting system, create a folder to contain the app's published folders and files.</span></span> <span data-ttu-id="88a89-800">W poniższym kroku ścieżka folderu jest dostarczana do usług IIS jako ścieżka fizyczna do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-800">In a following step, the folder's path is provided to IIS as the physical path to the app.</span></span> <span data-ttu-id="88a89-801">Aby uzyskać więcej informacji na temat folderu wdrożenia aplikacji i układu pliku, zobacz <xref:host-and-deploy/directory-structure> .</span><span class="sxs-lookup"><span data-stu-id="88a89-801">For more information on an app's deployment folder and file layout, see <xref:host-and-deploy/directory-structure>.</span></span>

1. <span data-ttu-id="88a89-802">W Menedżerze usług IIS Otwórz węzeł serwera w panelu **połączenia** .</span><span class="sxs-lookup"><span data-stu-id="88a89-802">In IIS Manager, open the server's node in the **Connections** panel.</span></span> <span data-ttu-id="88a89-803">Kliknij prawym przyciskiem myszy folder **sitess** .</span><span class="sxs-lookup"><span data-stu-id="88a89-803">Right-click the **Sites** folder.</span></span> <span data-ttu-id="88a89-804">Wybierz pozycję **Dodaj witrynę internetową** z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="88a89-804">Select **Add Website** from the contextual menu.</span></span>

1. <span data-ttu-id="88a89-805">Podaj **nazwę lokacji** i ustaw **ścieżkę fizyczną** folderu wdrożenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-805">Provide a **Site name** and set the **Physical path** to the app's deployment folder.</span></span> <span data-ttu-id="88a89-806">Podaj konfigurację **powiązania** i Utwórz witrynę sieci Web, wybierając **przycisk OK** :</span><span class="sxs-lookup"><span data-stu-id="88a89-806">Provide the **Binding** configuration and create the website by selecting **OK** :</span></span>

   ![Podaj nazwę lokacji, ścieżkę fizyczną i nazwę hosta w kroku Dodaj witrynę sieci Web.](index/_static/add-website-ws2016.png)

   > [!WARNING]
   > <span data-ttu-id="88a89-808">`http://*:80/` `http://+:80` **Nie** należy używać powiązań z symbolami wieloznacznymi (i) najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="88a89-808">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="88a89-809">Powiązania z symbolami wieloznacznymi najwyższego poziomu mogą otwierać aplikację pod kątem luk w zabezpieczeniach.</span><span class="sxs-lookup"><span data-stu-id="88a89-809">Top-level wildcard bindings can open up your app to security vulnerabilities.</span></span> <span data-ttu-id="88a89-810">Dotyczy to zarówno silnych, jak i słabych symboli wieloznacznych.</span><span class="sxs-lookup"><span data-stu-id="88a89-810">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="88a89-811">Używaj jawnych nazw hostów zamiast symboli wieloznacznych.</span><span class="sxs-lookup"><span data-stu-id="88a89-811">Use explicit host names rather than wildcards.</span></span> <span data-ttu-id="88a89-812">Powiązanie symboli wieloznacznych z poddomeną (na przykład `*.mysub.com` ) nie ma tego ryzyka bezpieczeństwa, jeśli kontrolujesz całą domenę nadrzędną (w przeciwieństwie do `*.com` , która jest narażona).</span><span class="sxs-lookup"><span data-stu-id="88a89-812">Subdomain wildcard binding (for example, `*.mysub.com`) doesn't have this security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="88a89-813">Aby uzyskać więcej informacji, zobacz [sekcję rfc7230-5,4](https://tools.ietf.org/html/rfc7230#section-5.4) .</span><span class="sxs-lookup"><span data-stu-id="88a89-813">See [rfc7230 section-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) for more information.</span></span>

1. <span data-ttu-id="88a89-814">W węźle serwera wybierz pozycję **Pule aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-814">Under the server's node, select **Application Pools** .</span></span>

1. <span data-ttu-id="88a89-815">Kliknij prawym przyciskiem myszy pulę aplikacji lokacji i wybierz pozycję **Ustawienia podstawowe** z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="88a89-815">Right-click the site's app pool and select **Basic Settings** from the contextual menu.</span></span>

1. <span data-ttu-id="88a89-816">W oknie **Edytowanie puli aplikacji** Ustaw **wersję środowiska .NET CLR** na **Brak kodu zarządzanego** :</span><span class="sxs-lookup"><span data-stu-id="88a89-816">In the **Edit Application Pool** window, set the **.NET CLR version** to **No Managed Code** :</span></span>

   ![Nie ustawiaj kodu zarządzanego dla wersji środowiska .NET CLR.](index/_static/edit-apppool-ws2016.png)

    <span data-ttu-id="88a89-818">ASP.NET Core działa w osobnym procesie i zarządza środowiskiem uruchomieniowym.</span><span class="sxs-lookup"><span data-stu-id="88a89-818">ASP.NET Core runs in a separate process and manages the runtime.</span></span> <span data-ttu-id="88a89-819">ASP.NET Core nie polega na ładowaniu środowiska CLR (.NET CLR) &mdash; podstawowego środowiska uruchomieniowego języka wspólnego (CoreCLR) dla platformy .NET Core w celu hostowania aplikacji w procesie roboczym.</span><span class="sxs-lookup"><span data-stu-id="88a89-819">ASP.NET Core doesn't rely on loading the desktop CLR (.NET CLR)&mdash;the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process.</span></span> <span data-ttu-id="88a89-820">Ustawienie **wersji środowiska .NET CLR** na **Brak kodu zarządzanego** jest opcjonalne, ale zalecane.</span><span class="sxs-lookup"><span data-stu-id="88a89-820">Setting the **.NET CLR version** to **No Managed Code** is optional but recommended.</span></span>

1. <span data-ttu-id="88a89-821">*ASP.NET Core 2,2 lub nowsza* : w przypadku [wdrożenia](/dotnet/core/deploying/#self-contained-deployments-scd) z systemem 64-bitowym (x64), które korzysta z [modelu hostingu w procesie](#in-process-hosting-model), wyłączaj pulę aplikacji dla procesów 32-bit (x86).</span><span class="sxs-lookup"><span data-stu-id="88a89-821">*ASP.NET Core 2.2 or later* : For a 64-bit (x64) [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd) that uses the [in-process hosting model](#in-process-hosting-model), disable the app pool for 32-bit (x86) processes.</span></span>

   <span data-ttu-id="88a89-822">Na pasku bocznym **Akcje** Menedżera usług IIS > **Pule aplikacji** wybierz pozycję **Ustaw ustawienia domyślne puli aplikacji** lub **Zaawansowane** .</span><span class="sxs-lookup"><span data-stu-id="88a89-822">In the **Actions** sidebar of IIS Manager > **Application Pools** , select **Set Application Pool Defaults** or **Advanced Settings** .</span></span> <span data-ttu-id="88a89-823">Znajdź **opcję Włącz aplikacje 32-bitowe** i ustaw wartość na `False` .</span><span class="sxs-lookup"><span data-stu-id="88a89-823">Locate **Enable 32-Bit Applications** and set the value to `False`.</span></span> <span data-ttu-id="88a89-824">To ustawienie nie ma wpływu na aplikacje wdrożone na potrzeby [hostingu poza procesem](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span><span class="sxs-lookup"><span data-stu-id="88a89-824">This setting doesn't affect apps deployed for [out-of-process hosting](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span></span>

1. <span data-ttu-id="88a89-825">Potwierdź, że tożsamość modelu procesu ma odpowiednie uprawnienia.</span><span class="sxs-lookup"><span data-stu-id="88a89-825">Confirm the process model identity has the proper permissions.</span></span>

   <span data-ttu-id="88a89-826">Jeśli domyślna tożsamość puli aplikacji ( **model procesów**  >  **Identity** ) została zmieniona z **ApplicationPool Identity** na inną tożsamość, sprawdź, czy Nowa tożsamość ma wymagane uprawnienia dostępu do folderu, bazy danych i innych wymaganych zasobów aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-826">If the default identity of the app pool ( **Process Model** > **Identity** ) is changed from **ApplicationPoolIdentity** to another identity, verify that the new identity has the required permissions to access the app's folder, database, and other required resources.</span></span> <span data-ttu-id="88a89-827">Na przykład Pula aplikacji wymaga dostępu do odczytu i zapisu do folderów, w których aplikacja odczytuje i zapisuje pliki.</span><span class="sxs-lookup"><span data-stu-id="88a89-827">For example, the app pool requires read and write access to folders where the app reads and writes files.</span></span>

<span data-ttu-id="88a89-828">**Konfiguracja uwierzytelniania systemu Windows (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-828">**Windows Authentication configuration (Optional)**</span></span>  
<span data-ttu-id="88a89-829">Aby uzyskać więcej informacji, zobacz [Konfigurowanie uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-829">For more information, see [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

## <a name="deploy-the-app"></a><span data-ttu-id="88a89-830">Wdrażanie aplikacji</span><span class="sxs-lookup"><span data-stu-id="88a89-830">Deploy the app</span></span>

<span data-ttu-id="88a89-831">Wdróż aplikację w folderze **ścieżki fizycznej** usług IIS, który został ustanowiony w sekcji [Tworzenie witryny usług IIS](#create-the-iis-site) .</span><span class="sxs-lookup"><span data-stu-id="88a89-831">Deploy the app to the IIS **Physical path** folder that was established in the [Create the IIS site](#create-the-iis-site) section.</span></span> <span data-ttu-id="88a89-832">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) jest zalecanym mechanizmem wdrażania, ale istnieje kilka opcji przeniesienia aplikacji z folderu *publikowania* projektu do folderu wdrożenia systemu hostingu.</span><span class="sxs-lookup"><span data-stu-id="88a89-832">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) is the recommended mechanism for deployment, but several options exist for moving the app from the project's *publish* folder to the hosting system's deployment folder.</span></span>

### <a name="web-deploy-with-visual-studio"></a><span data-ttu-id="88a89-833">Web Deploy z programem Visual Studio</span><span class="sxs-lookup"><span data-stu-id="88a89-833">Web Deploy with Visual Studio</span></span>

<span data-ttu-id="88a89-834">Aby dowiedzieć się, jak utworzyć profil publikowania do użytku z usługą Web Deploy, zobacz temat [Profile publikacji programu Visual Studio dla wdrożenia aplikacji ASP.NET Core](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) .</span><span class="sxs-lookup"><span data-stu-id="88a89-834">See the [Visual Studio publish profiles for ASP.NET Core app deployment](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) topic to learn how to create a publish profile for use with Web Deploy.</span></span> <span data-ttu-id="88a89-835">Jeśli dostawca hostingu udostępnia profil publikowania lub obsługę tworzenia aplikacji, pobierz swój profil i zaimportuj go za pomocą okna dialogowego **publikowania** programu Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="88a89-835">If the hosting provider provides a Publish Profile or support for creating one, download their profile and import it using the Visual Studio **Publish** dialog:</span></span>

![Strona okna dialogowego publikowanie](index/_static/pub-dialog.png)

### <a name="web-deploy-outside-of-visual-studio"></a><span data-ttu-id="88a89-837">Web Deploy poza programem Visual Studio</span><span class="sxs-lookup"><span data-stu-id="88a89-837">Web Deploy outside of Visual Studio</span></span>

<span data-ttu-id="88a89-838">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) można również użyć poza programem Visual Studio z wiersza polecenia.</span><span class="sxs-lookup"><span data-stu-id="88a89-838">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) can also be used outside of Visual Studio from the command line.</span></span> <span data-ttu-id="88a89-839">Aby uzyskać więcej informacji, zobacz [Narzędzie do wdrażania w sieci Web](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span><span class="sxs-lookup"><span data-stu-id="88a89-839">For more information, see [Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span></span>

### <a name="alternatives-to-web-deploy"></a><span data-ttu-id="88a89-840">Alternatywy dla Web Deploy</span><span class="sxs-lookup"><span data-stu-id="88a89-840">Alternatives to Web Deploy</span></span>

<span data-ttu-id="88a89-841">Użyj dowolnej z kilku metod, aby przenieść aplikację do systemu hostingu, takich jak ręczna kopia, [xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy)lub [PowerShell](/powershell/).</span><span class="sxs-lookup"><span data-stu-id="88a89-841">Use any of several methods to move the app to the hosting system, such as manual copy, [Xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy), or [PowerShell](/powershell/).</span></span>

<span data-ttu-id="88a89-842">Aby uzyskać więcej informacji na ASP.NET Core wdrażania usług IIS, zobacz sekcję [zasoby wdrażania dla administratorów usług IIS](#deployment-resources-for-iis-administrators) .</span><span class="sxs-lookup"><span data-stu-id="88a89-842">For more information on ASP.NET Core deployment to IIS, see the [Deployment resources for IIS administrators](#deployment-resources-for-iis-administrators) section.</span></span>

## <a name="browse-the-website"></a><span data-ttu-id="88a89-843">Przeglądanie witryny sieci Web</span><span class="sxs-lookup"><span data-stu-id="88a89-843">Browse the website</span></span>

<span data-ttu-id="88a89-844">Po wdrożeniu aplikacji w systemie hostingu należy wysłać żądanie do jednej z publicznych punktów końcowych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-844">After the app is deployed to the hosting system, make a request to one of the app's public endpoints.</span></span>

<span data-ttu-id="88a89-845">W poniższym przykładzie lokacja jest powiązana z **nazwą hosta** usług IIS `www.mysite.com` na **porcie** `80` .</span><span class="sxs-lookup"><span data-stu-id="88a89-845">In the following example, the site is bound to an IIS **Host name** of `www.mysite.com` on **Port** `80`.</span></span> <span data-ttu-id="88a89-846">Zostanie wysłane żądanie `http://www.mysite.com` :</span><span class="sxs-lookup"><span data-stu-id="88a89-846">A request is made to `http://www.mysite.com`:</span></span>

![Przeglądarka Microsoft Edge załadowała stronę startową usług IIS.](index/_static/browsewebsite.png)

## <a name="locked-deployment-files"></a><span data-ttu-id="88a89-848">Zablokowane pliki wdrożenia</span><span class="sxs-lookup"><span data-stu-id="88a89-848">Locked deployment files</span></span>

<span data-ttu-id="88a89-849">Pliki w folderze wdrożenia są zablokowane, gdy aplikacja jest uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="88a89-849">Files in the deployment folder are locked when the app is running.</span></span> <span data-ttu-id="88a89-850">Nie można zastąpić zablokowanych plików podczas wdrażania.</span><span class="sxs-lookup"><span data-stu-id="88a89-850">Locked files can't be overwritten during deployment.</span></span> <span data-ttu-id="88a89-851">Aby zwolnić zablokowane pliki we wdrożeniu, Zatrzymaj pulę aplikacji, korzystając z **jednej** z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="88a89-851">To release locked files in a deployment, stop the app pool using **one** of the following approaches:</span></span>

* <span data-ttu-id="88a89-852">Użyj Web Deploy i Reference `Microsoft.NET.Sdk.Web` w pliku projektu.</span><span class="sxs-lookup"><span data-stu-id="88a89-852">Use Web Deploy and reference `Microsoft.NET.Sdk.Web` in the project file.</span></span> <span data-ttu-id="88a89-853">Plik *app_offline.htm* jest umieszczony w katalogu głównym katalogu aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="88a89-853">An *app_offline.htm* file is placed at the root of the web app directory.</span></span> <span data-ttu-id="88a89-854">Gdy plik jest obecny, moduł ASP.NET Core bezpiecznie zamyka aplikację i obsługuje plik *app_offline.htm* podczas wdrażania.</span><span class="sxs-lookup"><span data-stu-id="88a89-854">When the file is present, the ASP.NET Core Module gracefully shuts down the app and serves the *app_offline.htm* file during the deployment.</span></span> <span data-ttu-id="88a89-855">Aby uzyskać więcej informacji, zobacz [Informacje o konfiguracji modułu ASP.NET Core](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span><span class="sxs-lookup"><span data-stu-id="88a89-855">For more information, see the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span></span>
* <span data-ttu-id="88a89-856">Ręcznie Zatrzymaj pulę aplikacji w Menedżerze usług IIS na serwerze.</span><span class="sxs-lookup"><span data-stu-id="88a89-856">Manually stop the app pool in the IIS Manager on the server.</span></span>
* <span data-ttu-id="88a89-857">Użyj programu PowerShell do porzucenia *app_offline.htm* (wymaga programu PowerShell 5 lub nowszego):</span><span class="sxs-lookup"><span data-stu-id="88a89-857">Use PowerShell to drop *app_offline.htm* (requires PowerShell 5 or later):</span></span>

  ```powershell
  $pathToApp = 'PATH_TO_APP'

  # Stop the AppPool
  New-Item -Path $pathToApp app_offline.htm

  # Provide script commands here to deploy the app

  # Restart the AppPool
  Remove-Item -Path $pathToApp app_offline.htm

  ```

## <a name="data-protection"></a><span data-ttu-id="88a89-858">Ochrona danych</span><span class="sxs-lookup"><span data-stu-id="88a89-858">Data protection</span></span>

<span data-ttu-id="88a89-859">[Stos ochrony danych ASP.NET Core](xref:security/data-protection/introduction) jest używany przez kilka ASP.NET Core [middlewares](xref:fundamentals/middleware/index), w tym oprogramowanie pośredniczące używane podczas uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="88a89-859">The [ASP.NET Core Data Protection stack](xref:security/data-protection/introduction) is used by several ASP.NET Core [middlewares](xref:fundamentals/middleware/index), including middleware used in authentication.</span></span> <span data-ttu-id="88a89-860">Nawet jeśli interfejsy API ochrony danych nie są wywoływane przez kod użytkownika, należy skonfigurować ochronę danych przy użyciu skryptu wdrożenia lub w kodzie użytkownika, aby utworzyć trwały [Magazyn kluczy](xref:security/data-protection/implementation/key-management)kryptograficznych.</span><span class="sxs-lookup"><span data-stu-id="88a89-860">Even if Data Protection APIs aren't called by user code, data protection should be configured with a deployment script or in user code to create a persistent cryptographic [key store](xref:security/data-protection/implementation/key-management).</span></span> <span data-ttu-id="88a89-861">Jeśli ochrona danych nie jest skonfigurowana, klucze są przechowywane w pamięci i usuwane po ponownym uruchomieniu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-861">If data protection isn't configured, the keys are held in memory and discarded when the app restarts.</span></span>

<span data-ttu-id="88a89-862">Jeśli pierścień kluczy jest przechowywany w pamięci po ponownym uruchomieniu aplikacji:</span><span class="sxs-lookup"><span data-stu-id="88a89-862">If the key ring is stored in memory when the app restarts:</span></span>

* <span data-ttu-id="88a89-863">cookieTokeny uwierzytelniania na podstawie wszystkich są unieważnione.</span><span class="sxs-lookup"><span data-stu-id="88a89-863">All cookie-based authentication tokens are invalidated.</span></span> 
* <span data-ttu-id="88a89-864">Użytkownicy muszą ponownie zalogować się przy następnym żądaniu.</span><span class="sxs-lookup"><span data-stu-id="88a89-864">Users are required to sign in again on their next request.</span></span> 
* <span data-ttu-id="88a89-865">Nie można już odszyfrować żadnych danych chronionych za pomocą dzwonka klucza.</span><span class="sxs-lookup"><span data-stu-id="88a89-865">Any data protected with the key ring can no longer be decrypted.</span></span> <span data-ttu-id="88a89-866">Może to obejmować [tokeny CSRF](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) i [ASP.NET Core MVC TempData cookie s](xref:fundamentals/app-state#tempdata).</span><span class="sxs-lookup"><span data-stu-id="88a89-866">This may include [CSRF tokens](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) and [ASP.NET Core MVC TempData cookies](xref:fundamentals/app-state#tempdata).</span></span>

<span data-ttu-id="88a89-867">Aby skonfigurować ochronę danych w ramach usług IIS w celu utrwalenia pierścienia kluczy, należy użyć **jednej** z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="88a89-867">To configure data protection under IIS to persist the key ring, use **one** of the following approaches:</span></span>

* <span data-ttu-id="88a89-868">**Tworzenie kluczy rejestru ochrony danych**</span><span class="sxs-lookup"><span data-stu-id="88a89-868">**Create Data Protection Registry Keys**</span></span>

  <span data-ttu-id="88a89-869">Klucze ochrony danych używane przez aplikacje ASP.NET Core są przechowywane w rejestrze zewnętrznym dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-869">Data protection keys used by ASP.NET Core apps are stored in the registry external to the apps.</span></span> <span data-ttu-id="88a89-870">Aby utrzymać klucze dla danej aplikacji, należy utworzyć klucze rejestru dla puli aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-870">To persist the keys for a given app, create registry keys for the app pool.</span></span>

  <span data-ttu-id="88a89-871">W przypadku autonomicznych, nieopartych na webfarmie instalacji usług IIS [skrypt ochrony danych Provision-AutoGenKeys.ps1 programu PowerShell](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) może być używany dla każdej puli aplikacji używanej w aplikacji ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-871">For standalone, non-webfarm IIS installations, the [Data Protection Provision-AutoGenKeys.ps1 PowerShell script](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) can be used for each app pool used with an ASP.NET Core app.</span></span> <span data-ttu-id="88a89-872">Ten skrypt tworzy klucz rejestru w rejestrze HKLM, który jest dostępny tylko dla konta procesu roboczego puli aplikacji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-872">This script creates a registry key in the HKLM registry that's accessible only to the worker process account of the app's app pool.</span></span> <span data-ttu-id="88a89-873">Klucze są szyfrowane przy użyciu funkcji DPAPI z kluczem dla całego komputera.</span><span class="sxs-lookup"><span data-stu-id="88a89-873">Keys are encrypted at rest using DPAPI with a machine-wide key.</span></span>

  <span data-ttu-id="88a89-874">W scenariuszach farmy sieci Web aplikacja może być skonfigurowana pod kątem używania ścieżki UNC do przechowywania tego dzwonka klucza ochrony danych.</span><span class="sxs-lookup"><span data-stu-id="88a89-874">In web farm scenarios, an app can be configured to use a UNC path to store its data protection key ring.</span></span> <span data-ttu-id="88a89-875">Domyślnie klucze ochrony danych nie są szyfrowane.</span><span class="sxs-lookup"><span data-stu-id="88a89-875">By default, the data protection keys aren't encrypted.</span></span> <span data-ttu-id="88a89-876">Upewnij się, że uprawnienia do pliku dla udziału sieciowego są ograniczone do konta systemu Windows, w którym jest uruchamiana aplikacja.</span><span class="sxs-lookup"><span data-stu-id="88a89-876">Ensure that the file permissions for the network share are limited to the Windows account the app runs under.</span></span> <span data-ttu-id="88a89-877">Certyfikat x509 może służyć do ochrony kluczy w spoczynku.</span><span class="sxs-lookup"><span data-stu-id="88a89-877">An X509 certificate can be used to protect keys at rest.</span></span> <span data-ttu-id="88a89-878">Rozważ zastosowanie mechanizmu umożliwiającego użytkownikom przekazywanie certyfikatów: Umieść certyfikaty w zaufanym magazynie certyfikatów użytkownika i upewnij się, że są one dostępne na wszystkich komputerach, na których działa aplikacja użytkownika.</span><span class="sxs-lookup"><span data-stu-id="88a89-878">Consider a mechanism to allow users to upload certificates: Place certificates into the user's trusted certificate store and ensure they're available on all machines where the user's app runs.</span></span> <span data-ttu-id="88a89-879">Szczegóły można znaleźć w temacie [Konfigurowanie ochrony danych ASP.NET Core](xref:security/data-protection/configuration/overview) .</span><span class="sxs-lookup"><span data-stu-id="88a89-879">See [Configure ASP.NET Core Data Protection](xref:security/data-protection/configuration/overview) for details.</span></span>

* <span data-ttu-id="88a89-880">**Konfigurowanie puli aplikacji usług IIS w celu załadowania profilu użytkownika**</span><span class="sxs-lookup"><span data-stu-id="88a89-880">**Configure the IIS Application Pool to load the user profile**</span></span>

  <span data-ttu-id="88a89-881">To ustawienie znajduje się w sekcji **model procesów** w obszarze **Ustawienia zaawansowane** dla puli aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-881">This setting is in the **Process Model** section under the **Advanced Settings** for the app pool.</span></span> <span data-ttu-id="88a89-882">Ustaw **Załaduj profil użytkownika** na `True` .</span><span class="sxs-lookup"><span data-stu-id="88a89-882">Set **Load User Profile** to `True`.</span></span> <span data-ttu-id="88a89-883">Po ustawieniu opcji `True` klucze są przechowywane w katalogu profilu użytkownika i chronione przy użyciu funkcji DPAPI z kluczem specyficznym dla konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="88a89-883">When set to `True`, keys are stored in the user profile directory and protected using DPAPI with a key specific to the user account.</span></span> <span data-ttu-id="88a89-884">Klucze są utrwalane w folderze *% LocalAppData%/ASP.NET/dataprotection-Keys* .</span><span class="sxs-lookup"><span data-stu-id="88a89-884">Keys are persisted to the *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys* folder.</span></span>

  <span data-ttu-id="88a89-885">[Atrybut setProfileEnvironment](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) puli aplikacji również musi być włączony.</span><span class="sxs-lookup"><span data-stu-id="88a89-885">The app pool's [setProfileEnvironment attribute](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) must also be enabled.</span></span> <span data-ttu-id="88a89-886">Wartość domyślna `setProfileEnvironment` to `true` .</span><span class="sxs-lookup"><span data-stu-id="88a89-886">The default value of `setProfileEnvironment` is `true`.</span></span> <span data-ttu-id="88a89-887">W niektórych scenariuszach (na przykład system operacyjny Windows) `setProfileEnvironment` jest ustawiony na `false` .</span><span class="sxs-lookup"><span data-stu-id="88a89-887">In some scenarios (for example, Windows OS), `setProfileEnvironment` is set to `false`.</span></span> <span data-ttu-id="88a89-888">Jeśli klucze nie są przechowywane w katalogu profilu użytkownika zgodnie z oczekiwaniami:</span><span class="sxs-lookup"><span data-stu-id="88a89-888">If keys aren't stored in the user profile directory as expected:</span></span>

  1. <span data-ttu-id="88a89-889">Przejdź do folderu *% windir%/system32/inetsrv/config*</span><span class="sxs-lookup"><span data-stu-id="88a89-889">Navigate to the *%windir%/system32/inetsrv/config* folder.</span></span>
  1. <span data-ttu-id="88a89-890">Otwórz plik *applicationHost.config* .</span><span class="sxs-lookup"><span data-stu-id="88a89-890">Open the *applicationHost.config* file.</span></span>
  1. <span data-ttu-id="88a89-891">Znajdź `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` element.</span><span class="sxs-lookup"><span data-stu-id="88a89-891">Locate the `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` element.</span></span>
  1. <span data-ttu-id="88a89-892">Upewnij się, że `setProfileEnvironment` atrybut nie istnieje, który jest wartością domyślną `true` , lub jawnie ustaw wartość atrybutu na `true` .</span><span class="sxs-lookup"><span data-stu-id="88a89-892">Confirm that the `setProfileEnvironment` attribute isn't present, which defaults the value to `true`, or explicitly set the attribute's value to `true`.</span></span>

* <span data-ttu-id="88a89-893">**Używanie systemu plików jako magazynu kluczy**</span><span class="sxs-lookup"><span data-stu-id="88a89-893">**Use the file system as a key ring store**</span></span>

  <span data-ttu-id="88a89-894">Dostosuj kod aplikacji, [tak aby używał systemu plików jako magazynu kluczy](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="88a89-894">Adjust the app code to [use the file system as a key ring store](xref:security/data-protection/configuration/overview).</span></span> <span data-ttu-id="88a89-895">Użyj certyfikatu x509 do ochrony pierścienia kluczy i upewnij się, że certyfikat jest certyfikatem zaufanym.</span><span class="sxs-lookup"><span data-stu-id="88a89-895">Use an X509 certificate to protect the key ring and ensure the certificate is a trusted certificate.</span></span> <span data-ttu-id="88a89-896">Jeśli certyfikat jest podpisany z podpisem własnym, umieść certyfikat w zaufanym magazynie głównym.</span><span class="sxs-lookup"><span data-stu-id="88a89-896">If the certificate is self-signed, place the certificate in the Trusted Root store.</span></span>

  <span data-ttu-id="88a89-897">W przypadku korzystania z usług IIS w kolektywie serwerów sieci Web:</span><span class="sxs-lookup"><span data-stu-id="88a89-897">When using IIS in a web farm:</span></span>

  * <span data-ttu-id="88a89-898">Użyj udziału plików, do którego mają dostęp wszystkie maszyny.</span><span class="sxs-lookup"><span data-stu-id="88a89-898">Use a file share that all machines can access.</span></span>
  * <span data-ttu-id="88a89-899">Wdróż certyfikat x509 na każdym komputerze.</span><span class="sxs-lookup"><span data-stu-id="88a89-899">Deploy an X509 certificate to each machine.</span></span> <span data-ttu-id="88a89-900">Konfigurowanie [ochrony danych w kodzie](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="88a89-900">Configure [data protection in code](xref:security/data-protection/configuration/overview).</span></span>

* <span data-ttu-id="88a89-901">**Ustawianie zasad dla całej maszyny na potrzeby ochrony danych**</span><span class="sxs-lookup"><span data-stu-id="88a89-901">**Set a machine-wide policy for data protection**</span></span>

  <span data-ttu-id="88a89-902">System ochrony danych ma ograniczoną obsługę ustawiania domyślnych [zasad komputera](xref:security/data-protection/configuration/machine-wide-policy) dla wszystkich aplikacji korzystających z interfejsów API ochrony danych.</span><span class="sxs-lookup"><span data-stu-id="88a89-902">The data protection system has limited support for setting a default [machine-wide policy](xref:security/data-protection/configuration/machine-wide-policy) for all apps that consume the Data Protection APIs.</span></span> <span data-ttu-id="88a89-903">Aby uzyskać więcej informacji, zobacz <xref:security/data-protection/introduction>.</span><span class="sxs-lookup"><span data-stu-id="88a89-903">For more information, see <xref:security/data-protection/introduction>.</span></span>

## <a name="virtual-directories"></a><span data-ttu-id="88a89-904">Katalogi wirtualne</span><span class="sxs-lookup"><span data-stu-id="88a89-904">Virtual Directories</span></span>

<span data-ttu-id="88a89-905">[Katalogi wirtualne usług IIS](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) nie są obsługiwane w aplikacjach ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-905">[IIS Virtual Directories](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) aren't supported with ASP.NET Core apps.</span></span> <span data-ttu-id="88a89-906">Aplikacja może być hostowana jako [podaplikacja](#sub-applications).</span><span class="sxs-lookup"><span data-stu-id="88a89-906">An app can be hosted as a [sub-application](#sub-applications).</span></span>

## <a name="sub-applications"></a><span data-ttu-id="88a89-907">Aplikacje podrzędne</span><span class="sxs-lookup"><span data-stu-id="88a89-907">Sub-applications</span></span>

<span data-ttu-id="88a89-908">Aplikacja ASP.NET Core może być hostowana jako [podaplikacja usług IIS (podrzędna)](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span><span class="sxs-lookup"><span data-stu-id="88a89-908">An ASP.NET Core app can be hosted as an [IIS sub-application (sub-app)](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span></span> <span data-ttu-id="88a89-909">Ścieżka aplikacji podrzędnej jest częścią adresu URL aplikacji głównej.</span><span class="sxs-lookup"><span data-stu-id="88a89-909">The sub-app's path becomes part of the root app's URL.</span></span>

<span data-ttu-id="88a89-910">Linki do zasobów statycznych w aplikacji podrzędnej powinny używać notacji z ukośnikiem ( `~/` ).</span><span class="sxs-lookup"><span data-stu-id="88a89-910">Static asset links within the sub-app should use tilde-slash (`~/`) notation.</span></span> <span data-ttu-id="88a89-911">Notacja "ukośnik" wyzwala [pomocnika tagów](xref:mvc/views/tag-helpers/intro) , aby dołączyć pathbase podaplikacji do renderowanego linku względnego.</span><span class="sxs-lookup"><span data-stu-id="88a89-911">Tilde-slash notation triggers a [Tag Helper](xref:mvc/views/tag-helpers/intro) to prepend the sub-app's pathbase to the rendered relative link.</span></span> <span data-ttu-id="88a89-912">W przypadku aplikacji podrzędnej w `/subapp_path` programie obraz połączony z programem `src="~/image.png"` jest renderowany jako `src="/subapp_path/image.png"` .</span><span class="sxs-lookup"><span data-stu-id="88a89-912">For a sub-app at `/subapp_path`, an image linked with `src="~/image.png"` is rendered as `src="/subapp_path/image.png"`.</span></span> <span data-ttu-id="88a89-913">Oprogramowanie pośredniczące aplikacji głównej nie przetwarza żądania pliku statycznego.</span><span class="sxs-lookup"><span data-stu-id="88a89-913">The root app's Static File Middleware doesn't process the static file request.</span></span> <span data-ttu-id="88a89-914">Żądanie jest przetwarzane przez oprogramowanie pośredniczące plików statycznych aplikacji podrzędnej.</span><span class="sxs-lookup"><span data-stu-id="88a89-914">The request is processed by the sub-app's Static File Middleware.</span></span>

<span data-ttu-id="88a89-915">Jeśli atrybut statycznego zasobu `src` jest ustawiony na ścieżkę bezwzględną (na przykład `src="/image.png"` ), link jest renderowany bez pathbase podaplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-915">If a static asset's `src` attribute is set to an absolute path (for example, `src="/image.png"`), the link is rendered without the sub-app's pathbase.</span></span> <span data-ttu-id="88a89-916">Oprogramowanie pośredniczące pliku statycznego aplikacji głównej próbuje obsłużyć zasób z poziomu [głównego katalogu sieci Web](xref:fundamentals/index#web-root)aplikacji głównej, co spowoduje, że odpowiedź na *404 nie zostanie znaleziona* , chyba że statyczny zasób jest dostępny z poziomu aplikacji głównej.</span><span class="sxs-lookup"><span data-stu-id="88a89-916">The root app's Static File Middleware attempts to serve the asset from the root app's [web root](xref:fundamentals/index#web-root), which results in a *404 - Not Found* response unless the static asset is available from the root app.</span></span>

<span data-ttu-id="88a89-917">Aby hostować aplikację ASP.NET Core jako aplikację podrzędną w innej aplikacji ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="88a89-917">To host an ASP.NET Core app as a sub-app under another ASP.NET Core app:</span></span>

1. <span data-ttu-id="88a89-918">Ustanów pulę aplikacji dla aplikacji podrzędnej.</span><span class="sxs-lookup"><span data-stu-id="88a89-918">Establish an app pool for the sub-app.</span></span> <span data-ttu-id="88a89-919">Ustaw **wersję środowiska .NET CLR** na **Brak kodu zarządzanego** , ponieważ podstawowe środowisko uruchomieniowe języka wspólnego (CoreCLR) dla platformy .NET Core jest uruchomione w celu hostowania aplikacji w procesie roboczym, a nie na pulpicie CLR (.NET CLR).</span><span class="sxs-lookup"><span data-stu-id="88a89-919">Set the **.NET CLR Version** to **No Managed Code** because the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process, not the desktop CLR (.NET CLR).</span></span>

1. <span data-ttu-id="88a89-920">Dodaj lokację główną w Menedżerze usług IIS przy użyciu aplikacji podrzędnej w folderze w lokacji głównej.</span><span class="sxs-lookup"><span data-stu-id="88a89-920">Add the root site in IIS Manager with the sub-app in a folder under the root site.</span></span>

1. <span data-ttu-id="88a89-921">Kliknij prawym przyciskiem myszy folder subapp w Menedżerze usług IIS, a następnie wybierz polecenie **Konwertuj na aplikację** .</span><span class="sxs-lookup"><span data-stu-id="88a89-921">Right-click the sub-app folder in IIS Manager and select **Convert to Application** .</span></span>

1. <span data-ttu-id="88a89-922">W oknie dialogowym **Dodawanie aplikacji** Użyj przycisku **Wybierz** dla **puli aplikacji** , aby przypisać pulę aplikacji utworzoną dla aplikacji podrzędnej.</span><span class="sxs-lookup"><span data-stu-id="88a89-922">In the **Add Application** dialog, use the **Select** button for the **Application Pool** to assign the app pool that you created for the sub-app.</span></span> <span data-ttu-id="88a89-923">Wybierz pozycję **OK** .</span><span class="sxs-lookup"><span data-stu-id="88a89-923">Select **OK** .</span></span>

<span data-ttu-id="88a89-924">Przypisanie oddzielnej puli aplikacji do aplikacji podrzędnej jest wymagane w przypadku korzystania z modelu hostingu w procesie.</span><span class="sxs-lookup"><span data-stu-id="88a89-924">The assignment of a separate app pool to the sub-app is a requirement when using the in-process hosting model.</span></span>

<span data-ttu-id="88a89-925">Aby uzyskać więcej informacji na temat modelu hostingu w procesie i konfigurowania modułu ASP.NET Core, zobacz <xref:host-and-deploy/aspnet-core-module> .</span><span class="sxs-lookup"><span data-stu-id="88a89-925">For more information on the in-process hosting model and configuring the ASP.NET Core Module, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

## <a name="configuration-of-iis-with-webconfig"></a><span data-ttu-id="88a89-926">Konfiguracja usług IIS z web.config</span><span class="sxs-lookup"><span data-stu-id="88a89-926">Configuration of IIS with web.config</span></span>

<span data-ttu-id="88a89-927">Na konfigurację usług IIS wpływa `<system.webServer>` sekcja *web.config* dla scenariuszy usług IIS, które są funkcjonalne dla ASP.NET Core aplikacji za pomocą modułu ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-927">IIS configuration is influenced by the `<system.webServer>` section of *web.config* for IIS scenarios that are functional for ASP.NET Core apps with the ASP.NET Core Module.</span></span> <span data-ttu-id="88a89-928">Na przykład konfiguracja usług IIS jest funkcjonalna dla kompresji dynamicznej.</span><span class="sxs-lookup"><span data-stu-id="88a89-928">For example, IIS configuration is functional for dynamic compression.</span></span> <span data-ttu-id="88a89-929">Jeśli usługi IIS są skonfigurowane na poziomie serwera do korzystania z kompresji dynamicznej, `<urlCompression>` element w pliku *web.config* aplikacji może go wyłączyć dla aplikacji ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-929">If IIS is configured at the server level to use dynamic compression, the `<urlCompression>` element in the app's *web.config* file can disable it for an ASP.NET Core app.</span></span>

<span data-ttu-id="88a89-930">Aby uzyskać więcej informacji, zobacz następujące tematy:</span><span class="sxs-lookup"><span data-stu-id="88a89-930">For more information, see the following topics:</span></span>

* [<span data-ttu-id="88a89-931">Dokumentacja konfiguracyjna programu \<system.webServer></span><span class="sxs-lookup"><span data-stu-id="88a89-931">Configuration reference for \<system.webServer></span></span>](/iis/configuration/system.webServer/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/iis/modules>

<span data-ttu-id="88a89-932">Aby ustawić zmienne środowiskowe dla poszczególnych aplikacji działających w pulach izolowanych aplikacji (obsługiwanych w przypadku usług IIS 10,0 lub nowszych), zobacz sekcję *polecenieAppCmd.exe* w temacie [ \<environmentVariables> zmienne środowiskowe](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) w dokumentacji dotyczącej usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-932">To set environment variables for individual apps running in isolated app pools (supported for IIS 10.0 or later), see the *AppCmd.exe command* section of the [Environment Variables \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) topic in the IIS reference documentation.</span></span>

## <a name="configuration-sections-of-webconfig"></a><span data-ttu-id="88a89-933">Sekcje konfiguracji web.config</span><span class="sxs-lookup"><span data-stu-id="88a89-933">Configuration sections of web.config</span></span>

<span data-ttu-id="88a89-934">Sekcje konfiguracyjne aplikacji ASP.NET 4. x w *web.config* nie są używane przez aplikacje ASP.NET Core do konfiguracji:</span><span class="sxs-lookup"><span data-stu-id="88a89-934">Configuration sections of ASP.NET 4.x apps in *web.config* aren't used by ASP.NET Core apps for configuration:</span></span>

* `<system.web>`
* `<appSettings>`
* `<connectionStrings>`
* `<location>`

<span data-ttu-id="88a89-935">Aplikacje ASP.NET Core są konfigurowane przy użyciu innych dostawców konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="88a89-935">ASP.NET Core apps are configured using other configuration providers.</span></span> <span data-ttu-id="88a89-936">Aby uzyskać więcej informacji, zobacz [Konfiguracja](xref:fundamentals/configuration/index).</span><span class="sxs-lookup"><span data-stu-id="88a89-936">For more information, see [Configuration](xref:fundamentals/configuration/index).</span></span>

## <a name="application-pools"></a><span data-ttu-id="88a89-937">Pule aplikacji</span><span class="sxs-lookup"><span data-stu-id="88a89-937">Application Pools</span></span>

<span data-ttu-id="88a89-938">Izolacja puli aplikacji jest określana przez model hostingu:</span><span class="sxs-lookup"><span data-stu-id="88a89-938">App pool isolation is determined by the hosting model:</span></span>

* <span data-ttu-id="88a89-939">Hosting w procesie: aplikacje muszą być uruchamiane w oddzielnych pulach aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-939">In-process hosting: Apps are required to run in separate app pools.</span></span>
* <span data-ttu-id="88a89-940">Hosting poza procesem: zalecamy izolowanie aplikacji od siebie, uruchamiając każdą aplikację w jej własnej puli aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-940">Out-of-process hosting: We recommend isolating the apps from each other by running each app in its own app pool.</span></span>

<span data-ttu-id="88a89-941">Okno dialogowe **Dodaj witrynę sieci Web** usług IIS domyślnie umożliwia pojedynczej puli aplikacji na aplikację.</span><span class="sxs-lookup"><span data-stu-id="88a89-941">The IIS **Add Website** dialog defaults to a single app pool per app.</span></span> <span data-ttu-id="88a89-942">Po podaniu **nazwy witryny** tekst zostanie automatycznie przeniesiony do pola tekstowego **Pula aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-942">When a **Site name** is provided, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="88a89-943">Nowa pula aplikacji jest tworzona przy użyciu nazwy lokacji, gdy zostanie dodana lokacja.</span><span class="sxs-lookup"><span data-stu-id="88a89-943">A new app pool is created using the site name when the site is added.</span></span>

## <a name="application-pool-no-locidentity"></a><span data-ttu-id="88a89-944">Pula aplikacji Identity</span><span class="sxs-lookup"><span data-stu-id="88a89-944">Application Pool Identity</span></span>

<span data-ttu-id="88a89-945">Konto tożsamości puli aplikacji umożliwia uruchamianie aplikacji na unikatowym koncie bez konieczności tworzenia domen ani kont lokalnych oraz zarządzania nimi.</span><span class="sxs-lookup"><span data-stu-id="88a89-945">An app pool identity account allows an app to run under a unique account without having to create and manage domains or local accounts.</span></span> <span data-ttu-id="88a89-946">W przypadku usług IIS 8,0 lub nowszych proces roboczy administratora usług IIS tworzy konto wirtualne o nazwie nowej puli aplikacji i domyślnie uruchamia procesy robocze puli aplikacji w ramach tego konta.</span><span class="sxs-lookup"><span data-stu-id="88a89-946">On IIS 8.0 or later, the IIS Admin Worker Process (WAS) creates a virtual account with the name of the new app pool and runs the app pool's worker processes under this account by default.</span></span> <span data-ttu-id="88a89-947">W konsoli zarządzania usługami IIS w obszarze **Ustawienia zaawansowane** dla puli aplikacji upewnij się, że **Identity** ustawiono opcję Użyj **ApplicationPool Identity** :</span><span class="sxs-lookup"><span data-stu-id="88a89-947">In the IIS Management Console under **Advanced Settings** for the app pool, ensure that the **Identity** is set to use **ApplicationPoolIdentity** :</span></span>

![Okno dialogowe Zaawansowane ustawienia puli aplikacji](index/_static/apppool-identity.png)

<span data-ttu-id="88a89-949">Proces zarządzania usługami IIS tworzy Bezpieczny identyfikator z nazwą puli aplikacji w systemie zabezpieczeń systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="88a89-949">The IIS management process creates a secure identifier with the name of the app pool in the Windows Security System.</span></span> <span data-ttu-id="88a89-950">Zasoby mogą być zabezpieczone przy użyciu tej tożsamości.</span><span class="sxs-lookup"><span data-stu-id="88a89-950">Resources can be secured using this identity.</span></span> <span data-ttu-id="88a89-951">Jednak ta tożsamość nie jest kontem użytkownika rzeczywistego i nie jest wyświetlana w konsoli zarządzania użytkownikami systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="88a89-951">However, this identity isn't a real user account and doesn't show up in the Windows User Management Console.</span></span>

<span data-ttu-id="88a89-952">Jeśli proces roboczy usług IIS wymaga podwyższonego poziomu dostępu do aplikacji, Zmodyfikuj listę Access Control (ACL) dla katalogu zawierającego aplikację:</span><span class="sxs-lookup"><span data-stu-id="88a89-952">If the IIS worker process requires elevated access to the app, modify the Access Control List (ACL) for the directory containing the app:</span></span>

1. <span data-ttu-id="88a89-953">Otwórz Eksploratora Windows i przejdź do katalogu.</span><span class="sxs-lookup"><span data-stu-id="88a89-953">Open Windows Explorer and navigate to the directory.</span></span>

1. <span data-ttu-id="88a89-954">Kliknij prawym przyciskiem myszy katalog i wybierz polecenie **Właściwości** .</span><span class="sxs-lookup"><span data-stu-id="88a89-954">Right-click on the directory and select **Properties** .</span></span>

1. <span data-ttu-id="88a89-955">Na karcie **zabezpieczenia** wybierz przycisk **Edytuj** , a następnie przycisk **Dodaj** .</span><span class="sxs-lookup"><span data-stu-id="88a89-955">Under the **Security** tab, select the **Edit** button and then the **Add** button.</span></span>

1. <span data-ttu-id="88a89-956">Wybierz przycisk **lokalizacje** i upewnij się, że wybrano system.</span><span class="sxs-lookup"><span data-stu-id="88a89-956">Select the **Locations** button and make sure the system is selected.</span></span>

1. <span data-ttu-id="88a89-957">Wprowadź **<usług IIS puli aplikacji \\ app_pool_name>** w polu **Wprowadź nazwy obiektów do wybrania** .</span><span class="sxs-lookup"><span data-stu-id="88a89-957">Enter **IIS AppPool\\<app_pool_name>** in **Enter the object names to select** area.</span></span> <span data-ttu-id="88a89-958">Wybierz przycisk **Sprawdź nazwy** .</span><span class="sxs-lookup"><span data-stu-id="88a89-958">Select the **Check Names** button.</span></span> <span data-ttu-id="88a89-959">W obszarze *Domyślna pula aplikacji* Sprawdź nazwy za pomocą **usług IIS AppPool\DefaultAppPool** .</span><span class="sxs-lookup"><span data-stu-id="88a89-959">For the *DefaultAppPool* check the names using **IIS AppPool\DefaultAppPool** .</span></span> <span data-ttu-id="88a89-960">Po wybraniu przycisku **Sprawdź nazwy** w obszarze nazwy obiektów zostanie wykazana wartość **Domyślna pula aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-960">When the **Check Names** button is selected, a value of **DefaultAppPool** is indicated in the object names area.</span></span> <span data-ttu-id="88a89-961">Nie można wprowadzić nazwy puli aplikacji bezpośrednio w obszarze nazw obiektów.</span><span class="sxs-lookup"><span data-stu-id="88a89-961">It isn't possible to enter the app pool name directly into the object names area.</span></span> <span data-ttu-id="88a89-962">Podczas sprawdzania nazwy obiektu Użyj **<IIS puli aplikacji \\ app_pool_name>** .</span><span class="sxs-lookup"><span data-stu-id="88a89-962">Use the **IIS AppPool\\<app_pool_name>** format when checking for the object name.</span></span>

   ![Okno dialogowe Wybieranie użytkowników lub grup dla folderu aplikacji: Nazwa puli aplikacji "domyślna pula" jest dołączana do "puli aplikacji IIS \" w obszarze nazw obiektów przed wybraniem pozycji" Sprawdź nazwy ".](index/_static/select-users-or-groups-1.png)

1. <span data-ttu-id="88a89-964">Wybierz pozycję **OK** .</span><span class="sxs-lookup"><span data-stu-id="88a89-964">Select **OK** .</span></span>

   ![Okno dialogowe Wybieranie użytkowników lub grup dla folderu aplikacji: po wybraniu pozycji "Sprawdź nazwy" w obszarze nazwy obiektów zostanie wyświetlona nazwa obiektu "domyślna pula aplikacji".](index/_static/select-users-or-groups-2.png)

1. <span data-ttu-id="88a89-966">&amp;Uprawnienia do wykonywania odczytu powinny być przyznawane domyślnie.</span><span class="sxs-lookup"><span data-stu-id="88a89-966">Read &amp; execute permissions should be granted by default.</span></span> <span data-ttu-id="88a89-967">Podaj dodatkowe uprawnienia zgodnie z wymaganiami.</span><span class="sxs-lookup"><span data-stu-id="88a89-967">Provide additional permissions as needed.</span></span>

<span data-ttu-id="88a89-968">Dostęp można także udzielić w wierszu polecenia przy użyciu narzędzia **icacls** .</span><span class="sxs-lookup"><span data-stu-id="88a89-968">Access can also be granted at a command prompt using the **ICACLS** tool.</span></span> <span data-ttu-id="88a89-969">Użycie funkcji *Domyślna pula aplikacji* jako przykładu powoduje użycie następującego polecenia:</span><span class="sxs-lookup"><span data-stu-id="88a89-969">Using the *DefaultAppPool* as an example, the following command is used:</span></span>

```console
ICACLS C:\sites\MyWebApp /grant "IIS AppPool\DefaultAppPool":F
```

<span data-ttu-id="88a89-970">Aby uzyskać więcej informacji, zobacz temat [icacls](/windows-server/administration/windows-commands/icacls) .</span><span class="sxs-lookup"><span data-stu-id="88a89-970">For more information, see the [icacls](/windows-server/administration/windows-commands/icacls) topic.</span></span>

## <a name="http2-support"></a><span data-ttu-id="88a89-971">Obsługa protokołu HTTP/2</span><span class="sxs-lookup"><span data-stu-id="88a89-971">HTTP/2 support</span></span>

<span data-ttu-id="88a89-972">[Protokół HTTP/2](https://httpwg.org/specs/rfc7540.html) jest obsługiwany z ASP.NET Core w następujących scenariuszach wdrażania usług IIS:</span><span class="sxs-lookup"><span data-stu-id="88a89-972">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is supported with ASP.NET Core in the following IIS deployment scenarios:</span></span>

* <span data-ttu-id="88a89-973">W procesie</span><span class="sxs-lookup"><span data-stu-id="88a89-973">In-process</span></span>
  * <span data-ttu-id="88a89-974">Windows Server 2016/Windows 10 lub nowszy; Program IIS 10 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="88a89-974">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="88a89-975">Połączenie TLS 1,2 lub nowsze</span><span class="sxs-lookup"><span data-stu-id="88a89-975">TLS 1.2 or later connection</span></span>
* <span data-ttu-id="88a89-976">Pozaprocesowe</span><span class="sxs-lookup"><span data-stu-id="88a89-976">Out-of-process</span></span>
  * <span data-ttu-id="88a89-977">Windows Server 2016/Windows 10 lub nowszy; Program IIS 10 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="88a89-977">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="88a89-978">Połączenia z serwerem granicznym dostępnym publicznie korzystają z protokołu HTTP/2, ale połączenie zwrotnego serwera proxy z [serwerem Kestrel](xref:fundamentals/servers/kestrel) korzysta z protokołu HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="88a89-978">Public-facing edge server connections use HTTP/2, but the reverse proxy connection to the [Kestrel server](xref:fundamentals/servers/kestrel) uses HTTP/1.1.</span></span>
  * <span data-ttu-id="88a89-979">Połączenie TLS 1,2 lub nowsze</span><span class="sxs-lookup"><span data-stu-id="88a89-979">TLS 1.2 or later connection</span></span>

<span data-ttu-id="88a89-980">W przypadku wdrożenia w procesie podczas ustanawiania połączenia HTTP/2 w raportach [HttpRequest. Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) `HTTP/2` .</span><span class="sxs-lookup"><span data-stu-id="88a89-980">For an in-process deployment when an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/2`.</span></span> <span data-ttu-id="88a89-981">W przypadku wdrożenia poza procesem, gdy jest nawiązywane połączenie HTTP/2, raporty [HttpRequest. Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) `HTTP/1.1` .</span><span class="sxs-lookup"><span data-stu-id="88a89-981">For an out-of-process deployment when an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/1.1`.</span></span>

<span data-ttu-id="88a89-982">Aby uzyskać więcej informacji na temat modeli hostingu w procesie i poza procesami, zobacz <xref:host-and-deploy/aspnet-core-module> .</span><span class="sxs-lookup"><span data-stu-id="88a89-982">For more information on the in-process and out-of-process hosting models, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

<span data-ttu-id="88a89-983">Protokół HTTP/2 jest domyślnie włączony.</span><span class="sxs-lookup"><span data-stu-id="88a89-983">HTTP/2 is enabled by default.</span></span> <span data-ttu-id="88a89-984">Połączenia powracają do protokołu HTTP/1.1, jeśli połączenie HTTP/2 nie zostało ustanowione.</span><span class="sxs-lookup"><span data-stu-id="88a89-984">Connections fall back to HTTP/1.1 if an HTTP/2 connection isn't established.</span></span> <span data-ttu-id="88a89-985">Aby uzyskać więcej informacji na temat konfiguracji protokołu HTTP/2 z wdrożeniami usług IIS, zobacz [http/2 w usługach IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span><span class="sxs-lookup"><span data-stu-id="88a89-985">For more information on HTTP/2 configuration with IIS deployments, see [HTTP/2 on IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span></span>

## <a name="cors-preflight-requests"></a><span data-ttu-id="88a89-986">Żądania inspekcji wstępnej CORS</span><span class="sxs-lookup"><span data-stu-id="88a89-986">CORS preflight requests</span></span>

<span data-ttu-id="88a89-987">*Ta sekcja dotyczy tylko ASP.NET Core aplikacji przeznaczonych dla .NET Framework.*</span><span class="sxs-lookup"><span data-stu-id="88a89-987">*This section only applies to ASP.NET Core apps that target the .NET Framework.*</span></span>

<span data-ttu-id="88a89-988">W przypadku aplikacji ASP.NET Core, która jest przeznaczona dla .NET Framework, żądania opcji nie są domyślnie przesyłane do aplikacji w usługach IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-988">For an ASP.NET Core app that targets the .NET Framework, OPTIONS requests aren't passed to the app by default in IIS.</span></span> <span data-ttu-id="88a89-989">Aby dowiedzieć się, jak skonfigurować obsługę usług IIS w *web.config* , aby przekazywać żądania dotyczące opcji, zobacz [Włączanie żądań między źródłami w ASP.NET Web API 2: jak działa mechanizm CORS](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span><span class="sxs-lookup"><span data-stu-id="88a89-989">To learn how to configure the app's IIS handlers in *web.config* to pass OPTIONS requests, see [Enable cross-origin requests in ASP.NET Web API 2: How CORS Works](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span></span>

## <a name="application-initialization-module-and-idle-timeout"></a><span data-ttu-id="88a89-990">Moduł inicjalizacji aplikacji i limit czasu bezczynności</span><span class="sxs-lookup"><span data-stu-id="88a89-990">Application Initialization Module and Idle Timeout</span></span>

<span data-ttu-id="88a89-991">Hostowane w usługach IIS przez moduł ASP.NET Core w wersji 2:</span><span class="sxs-lookup"><span data-stu-id="88a89-991">When hosted in IIS by the ASP.NET Core Module version 2:</span></span>

* <span data-ttu-id="88a89-992">[Moduł inicjalizacji aplikacji](#application-initialization-module): hostowana [w procesie](#in-process-hosting-model) lub [poza procesem](#out-of-process-hosting-model) aplikacja może zostać skonfigurowana do automatycznego uruchamiania na potrzeby ponownego uruchomienia procesu roboczego lub ponownego uruchomienia serwera.</span><span class="sxs-lookup"><span data-stu-id="88a89-992">[Application Initialization Module](#application-initialization-module): App's hosted [in-process](#in-process-hosting-model) or [out-of-process](#out-of-process-hosting-model) can be configured to start automatically on a worker process restart or server restart.</span></span>
* <span data-ttu-id="88a89-993">[Limit czasu bezczynności](#idle-timeout): hostowana [w trakcie](#in-process-hosting-model) działania aplikacji można skonfigurować w taki sposób, aby nie przekroczyć limitu czasu podczas okresów braku aktywności.</span><span class="sxs-lookup"><span data-stu-id="88a89-993">[Idle Timeout](#idle-timeout): App's hosted [in-process](#in-process-hosting-model) can be configured not to timeout during periods of inactivity.</span></span>

### <a name="application-initialization-module"></a><span data-ttu-id="88a89-994">Moduł inicjalizacji aplikacji</span><span class="sxs-lookup"><span data-stu-id="88a89-994">Application Initialization Module</span></span>

<span data-ttu-id="88a89-995">*Dotyczy aplikacji hostowanych w procesie i pozaprocesowe.*</span><span class="sxs-lookup"><span data-stu-id="88a89-995">*Applies to apps hosted in-process and out-of-process.*</span></span>

<span data-ttu-id="88a89-996">[Inicjowanie aplikacji IIS](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization) to funkcja usług IIS, która wysyła do aplikacji żądanie HTTP, gdy pula aplikacji zostanie uruchomiona lub zostanie odtworzona.</span><span class="sxs-lookup"><span data-stu-id="88a89-996">[IIS Application Initialization](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization) is an IIS feature that sends an HTTP request to the app when the app pool starts or is recycled.</span></span> <span data-ttu-id="88a89-997">Żądanie wyzwala uruchomienie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-997">The request triggers the app to start.</span></span> <span data-ttu-id="88a89-998">Domyślnie usługi IIS wysyłają żądanie do głównego adresu URL aplikacji ( `/` ) w celu zainicjowania aplikacji (zobacz [dodatkowe zasoby](#application-initialization-module-and-idle-timeout-additional-resources) , aby uzyskać więcej informacji na temat konfiguracji).</span><span class="sxs-lookup"><span data-stu-id="88a89-998">By default, IIS issues a request to the app's root URL (`/`) to initialize the app (see the [additional resources](#application-initialization-module-and-idle-timeout-additional-resources) for more details on configuration).</span></span>

<span data-ttu-id="88a89-999">Upewnij się, że funkcja inicjowania roli inicjalizacji aplikacji IIS jest włączona:</span><span class="sxs-lookup"><span data-stu-id="88a89-999">Confirm that the IIS Application Initialization role feature in enabled:</span></span>

<span data-ttu-id="88a89-1000">Na komputerach z systemem Windows 7 lub nowszym w przypadku lokalnego korzystania z usług IIS:</span><span class="sxs-lookup"><span data-stu-id="88a89-1000">On Windows 7 or later desktop systems when using IIS locally:</span></span>

1. <span data-ttu-id="88a89-1001">Przejdź do pozycji **Panel sterowania** > **programy** > **programy i funkcje** > **Włącz lub wyłącz funkcje systemu Windows** (po lewej stronie ekranu).</span><span class="sxs-lookup"><span data-stu-id="88a89-1001">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>
1. <span data-ttu-id="88a89-1002">Otwórz **Internet Information Services** > **World Wide Web Services** > **funkcje projektowania aplikacji** Internet Information Services World Wide Web Services.</span><span class="sxs-lookup"><span data-stu-id="88a89-1002">Open **Internet Information Services** > **World Wide Web Services** > **Application Development Features** .</span></span>
1. <span data-ttu-id="88a89-1003">Zaznacz pole wyboru dla **inicjowania aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1003">Select the check box for **Application Initialization** .</span></span>

<span data-ttu-id="88a89-1004">W systemie Windows Server 2008 R2 lub nowszym:</span><span class="sxs-lookup"><span data-stu-id="88a89-1004">On Windows Server 2008 R2 or later:</span></span>

1. <span data-ttu-id="88a89-1005">Otwórz **Kreatora dodawania ról i funkcji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1005">Open the **Add Roles and Features Wizard** .</span></span>
1. <span data-ttu-id="88a89-1006">W panelu **Wybierz usługi ról** Otwórz węzeł **Programowanie aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1006">In the **Select role services** panel, open the **Application Development** node.</span></span>
1. <span data-ttu-id="88a89-1007">Zaznacz pole wyboru dla **inicjowania aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1007">Select the check box for **Application Initialization** .</span></span>

<span data-ttu-id="88a89-1008">Użyj jednego z poniższych metod, aby włączyć moduł inicjowania aplikacji dla lokacji:</span><span class="sxs-lookup"><span data-stu-id="88a89-1008">Use either of the following approaches to enable the Application Initialization Module for the site:</span></span>

* <span data-ttu-id="88a89-1009">Za pomocą Menedżera usług IIS:</span><span class="sxs-lookup"><span data-stu-id="88a89-1009">Using IIS Manager:</span></span>

  1. <span data-ttu-id="88a89-1010">W panelu **połączenia** wybierz pozycję **Pule aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1010">Select **Application Pools** in the **Connections** panel.</span></span>
  1. <span data-ttu-id="88a89-1011">Kliknij prawym przyciskiem myszy pulę aplikacji aplikacji na liście i wybierz pozycję **Ustawienia zaawansowane** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1011">Right-click the app's app pool in the list and select **Advanced Settings** .</span></span>
  1. <span data-ttu-id="88a89-1012">Domyślny **tryb uruchamiania** to **OnDemand** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1012">The default **Start Mode** is **OnDemand** .</span></span> <span data-ttu-id="88a89-1013">Ustaw **tryb uruchamiania** na **AlwaysRunning** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1013">Set the **Start Mode** to **AlwaysRunning** .</span></span> <span data-ttu-id="88a89-1014">Wybierz pozycję **OK** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1014">Select **OK** .</span></span>
  1. <span data-ttu-id="88a89-1015">Otwórz węzeł **Lokacje** w panelu **połączenia** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1015">Open the **Sites** node in the **Connections** panel.</span></span>
  1. <span data-ttu-id="88a89-1016">Kliknij prawym przyciskiem myszy aplikację i wybierz pozycję Zarządzaj ustawieniami zaawansowanymi **witryny sieci Web** > **Advanced Settings** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1016">Right-click the app and select **Manage Website** > **Advanced Settings** .</span></span>
  1. <span data-ttu-id="88a89-1017">Domyślnym ustawieniem **wstępnego ładowania** jest **wartość false** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1017">The default **Preload Enabled** setting is **False** .</span></span> <span data-ttu-id="88a89-1018">Ustaw dla opcji **wstępnego ładowania** **wartość true** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1018">Set **Preload Enabled** to **True** .</span></span> <span data-ttu-id="88a89-1019">Wybierz pozycję **OK** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1019">Select **OK** .</span></span>

* <span data-ttu-id="88a89-1020">Za pomocą *web.config* Dodaj `<applicationInitialization>` element z `doAppInitAfterRestart` ustawionym do `true` `<system.webServer>` elementów w pliku *web.config* aplikacji:</span><span class="sxs-lookup"><span data-stu-id="88a89-1020">Using *web.config* , add the `<applicationInitialization>` element with `doAppInitAfterRestart` set to `true` to the `<system.webServer>` elements in the app's *web.config* file:</span></span>

  ```xml
  <?xml version="1.0" encoding="utf-8"?>
  <configuration>
    <location path="." inheritInChildApplications="false">
      <system.webServer>
        <applicationInitialization doAppInitAfterRestart="true" />
      </system.webServer>
    </location>
  </configuration>
  ```

### <a name="idle-timeout"></a><span data-ttu-id="88a89-1021">Limit czasu bezczynności</span><span class="sxs-lookup"><span data-stu-id="88a89-1021">Idle Timeout</span></span>

<span data-ttu-id="88a89-1022">*Dotyczy tylko aplikacji hostowanych w procesie.*</span><span class="sxs-lookup"><span data-stu-id="88a89-1022">*Only applies to apps hosted in-process.*</span></span>

<span data-ttu-id="88a89-1023">Aby zapobiec przekroczeniu przez aplikację, należy ustawić limit czasu bezczynności puli aplikacji przy użyciu Menedżera usług IIS:</span><span class="sxs-lookup"><span data-stu-id="88a89-1023">To prevent the app from idling, set the app pool's idle timeout using IIS Manager:</span></span>

1. <span data-ttu-id="88a89-1024">W panelu **połączenia** wybierz pozycję **Pule aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1024">Select **Application Pools** in the **Connections** panel.</span></span>
1. <span data-ttu-id="88a89-1025">Kliknij prawym przyciskiem myszy pulę aplikacji aplikacji na liście i wybierz pozycję **Ustawienia zaawansowane** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1025">Right-click the app's app pool in the list and select **Advanced Settings** .</span></span>
1. <span data-ttu-id="88a89-1026">Domyślny **limit czasu bezczynności (w minutach)** wynosi **20** minut.</span><span class="sxs-lookup"><span data-stu-id="88a89-1026">The default **Idle Time-out (minutes)** is **20** minutes.</span></span> <span data-ttu-id="88a89-1027">Ustaw **limit czasu bezczynności (w minutach)** na **0** (zero).</span><span class="sxs-lookup"><span data-stu-id="88a89-1027">Set the **Idle Time-out (minutes)** to **0** (zero).</span></span> <span data-ttu-id="88a89-1028">Wybierz pozycję **OK** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1028">Select **OK** .</span></span>
1. <span data-ttu-id="88a89-1029">Odtwórz proces roboczy.</span><span class="sxs-lookup"><span data-stu-id="88a89-1029">Recycle the worker process.</span></span>

<span data-ttu-id="88a89-1030">Aby zapobiec przekroczeniu limitu [czasu hostowanych przez aplikacje](#out-of-process-hosting-model) aplikacji, użyj jednej z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="88a89-1030">To prevent apps hosted [out-of-process](#out-of-process-hosting-model) from timing out, use either of the following approaches:</span></span>

* <span data-ttu-id="88a89-1031">Wyślij polecenie ping do aplikacji z zewnętrznej usługi, aby było ono uruchomione.</span><span class="sxs-lookup"><span data-stu-id="88a89-1031">Ping the app from an external service in order to keep it running.</span></span>
* <span data-ttu-id="88a89-1032">Jeśli aplikacja obsługuje tylko usługi w tle, należy unikać hostingu usług IIS i używać [usługi systemu Windows do hostowania aplikacji ASP.NET Core](xref:host-and-deploy/windows-service).</span><span class="sxs-lookup"><span data-stu-id="88a89-1032">If the app only hosts background services, avoid IIS hosting and use a [Windows Service to host the ASP.NET Core app](xref:host-and-deploy/windows-service).</span></span>

### <a name="application-initialization-module-and-idle-timeout-additional-resources"></a><span data-ttu-id="88a89-1033">Dodatkowe zasoby dotyczące modułu inicjalizacji aplikacji i limitu czasu bezczynności</span><span class="sxs-lookup"><span data-stu-id="88a89-1033">Application Initialization Module and Idle Timeout additional resources</span></span>

* [<span data-ttu-id="88a89-1034">Inicjowanie aplikacji usług IIS 8,0</span><span class="sxs-lookup"><span data-stu-id="88a89-1034">IIS 8.0 Application Initialization</span></span>](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization)
* <span data-ttu-id="88a89-1035">[Inicjowanie \<applicationInitialization> aplikacji ](/iis/configuration/system.webserver/applicationinitialization/).</span><span class="sxs-lookup"><span data-stu-id="88a89-1035">[Application Initialization \<applicationInitialization>](/iis/configuration/system.webserver/applicationinitialization/).</span></span>
* <span data-ttu-id="88a89-1036">[Ustawienia modelu procesów dla \<processModel> puli aplikacji ](/iis/configuration/system.applicationhost/applicationpools/add/processmodel).</span><span class="sxs-lookup"><span data-stu-id="88a89-1036">[Process Model Settings for an Application Pool \<processModel>](/iis/configuration/system.applicationhost/applicationpools/add/processmodel).</span></span>

## <a name="deployment-resources-for-iis-administrators"></a><span data-ttu-id="88a89-1037">Zasoby wdrażania dla administratorów usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-1037">Deployment resources for IIS administrators</span></span>

* [<span data-ttu-id="88a89-1038">Dokumentacja usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-1038">IIS documentation</span></span>](/iis)
* [<span data-ttu-id="88a89-1039">Wprowadzenie z menedżerem usług IIS w usługach IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-1039">Getting Started with the IIS Manager in IIS</span></span>](/iis/get-started/getting-started-with-iis/getting-started-with-the-iis-manager-in-iis-7-and-iis-8)
* [<span data-ttu-id="88a89-1040">Wdrażanie aplikacji .NET Core</span><span class="sxs-lookup"><span data-stu-id="88a89-1040">.NET Core application deployment</span></span>](/dotnet/core/deploying/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/directory-structure>
* <xref:host-and-deploy/iis/modules>
* <xref:test/troubleshoot-azure-iis>
* <xref:host-and-deploy/azure-iis-errors-reference>

## <a name="additional-resources"></a><span data-ttu-id="88a89-1041">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="88a89-1041">Additional resources</span></span>

* <xref:test/troubleshoot>
* <xref:index>
* [<span data-ttu-id="88a89-1042">Oficjalna witryna programu Microsoft IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-1042">The Official Microsoft IIS Site</span></span>](https://www.iis.net/)
* [<span data-ttu-id="88a89-1043">Biblioteka zawartości technicznej systemu Windows Server</span><span class="sxs-lookup"><span data-stu-id="88a89-1043">Windows Server technical content library</span></span>](/windows-server/windows-server)
* [<span data-ttu-id="88a89-1044">Protokół HTTP/2 w usługach IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-1044">HTTP/2 on IIS</span></span>](/iis/get-started/whats-new-in-iis-10/http2-on-iis)
* <xref:host-and-deploy/iis/transform-webconfig>

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="88a89-1045">Aby zapoznać się z samouczkiem dotyczącym publikowania aplikacji ASP.NET Core na serwerze usług IIS, zobacz <xref:tutorials/publish-to-iis> .</span><span class="sxs-lookup"><span data-stu-id="88a89-1045">For a tutorial experience on publishing an ASP.NET Core app to an IIS server, see <xref:tutorials/publish-to-iis>.</span></span>

[<span data-ttu-id="88a89-1046">Zainstaluj pakiet hostingu platformy .NET Core</span><span class="sxs-lookup"><span data-stu-id="88a89-1046">Install the .NET Core Hosting Bundle</span></span>](#install-the-net-core-hosting-bundle)

## <a name="supported-operating-systems"></a><span data-ttu-id="88a89-1047">Obsługiwane systemy operacyjne</span><span class="sxs-lookup"><span data-stu-id="88a89-1047">Supported operating systems</span></span>

<span data-ttu-id="88a89-1048">Obsługiwane są następujące systemy operacyjne:</span><span class="sxs-lookup"><span data-stu-id="88a89-1048">The following operating systems are supported:</span></span>

* <span data-ttu-id="88a89-1049">System Windows 7 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="88a89-1049">Windows 7 or later</span></span>
* <span data-ttu-id="88a89-1050">Windows Server 2008 R2 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="88a89-1050">Windows Server 2008 R2 or later</span></span>

<span data-ttu-id="88a89-1051">[ SerwerHTTP.sys](xref:fundamentals/servers/httpsys) (znany wcześniej jako webListener) nie działa w konfiguracji zwrotnego serwera proxy z usługami IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1051">[HTTP.sys server](xref:fundamentals/servers/httpsys) (formerly called WebListener) doesn't work in a reverse proxy configuration with IIS.</span></span> <span data-ttu-id="88a89-1052">Użyj [serwera Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="88a89-1052">Use the [Kestrel server](xref:fundamentals/servers/kestrel).</span></span>

<span data-ttu-id="88a89-1053">Aby uzyskać informacje na temat hostingu na platformie Azure, zobacz <xref:host-and-deploy/azure-apps/index> .</span><span class="sxs-lookup"><span data-stu-id="88a89-1053">For information on hosting in Azure, see <xref:host-and-deploy/azure-apps/index>.</span></span>

<span data-ttu-id="88a89-1054">Aby uzyskać wskazówki dotyczące rozwiązywania problemów, zobacz <xref:test/troubleshoot> .</span><span class="sxs-lookup"><span data-stu-id="88a89-1054">For troubleshooting guidance, see <xref:test/troubleshoot>.</span></span>

## <a name="supported-platforms"></a><span data-ttu-id="88a89-1055">Obsługiwane platformy</span><span class="sxs-lookup"><span data-stu-id="88a89-1055">Supported platforms</span></span>

<span data-ttu-id="88a89-1056">Obsługiwane są aplikacje opublikowane dla wdrożenia 32-bitowego (x86) lub 64-bitowego (x64).</span><span class="sxs-lookup"><span data-stu-id="88a89-1056">Apps published for 32-bit (x86) or 64-bit (x64) deployment are supported.</span></span> <span data-ttu-id="88a89-1057">Wdróż aplikację 32-bitową z 32-bitową (x86) zestaw .NET Core SDK, chyba że aplikacja:</span><span class="sxs-lookup"><span data-stu-id="88a89-1057">Deploy a 32-bit app with a 32-bit (x86) .NET Core SDK unless the app:</span></span>

* <span data-ttu-id="88a89-1058">Wymagana jest większa przestrzeń adresów pamięci wirtualnej dla aplikacji 64-bitowej.</span><span class="sxs-lookup"><span data-stu-id="88a89-1058">Requires the larger virtual memory address space available to a 64-bit app.</span></span>
* <span data-ttu-id="88a89-1059">Wymaga większego rozmiaru stosu IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1059">Requires the larger IIS stack size.</span></span>
* <span data-ttu-id="88a89-1060">Ma 64-bitowe zależności natywne.</span><span class="sxs-lookup"><span data-stu-id="88a89-1060">Has 64-bit native dependencies.</span></span>

<span data-ttu-id="88a89-1061">Aby opublikować aplikację 64-bitową, należy użyć 64-bitowej (x64) zestaw .NET Core SDK.</span><span class="sxs-lookup"><span data-stu-id="88a89-1061">Use a 64-bit (x64) .NET Core SDK to publish a 64-bit app.</span></span> <span data-ttu-id="88a89-1062">64-bitowy środowisko uruchomieniowe musi być obecny w systemie hosta.</span><span class="sxs-lookup"><span data-stu-id="88a89-1062">A 64-bit runtime must be present on the host system.</span></span>

<span data-ttu-id="88a89-1063">ASP.NET Core jest dostarczany z [serwerem Kestrel](xref:fundamentals/servers/kestrel), a domyślnym serwerem HTTP na wielu platformach.</span><span class="sxs-lookup"><span data-stu-id="88a89-1063">ASP.NET Core ships with [Kestrel server](xref:fundamentals/servers/kestrel), a default, cross-platform HTTP server.</span></span>

<span data-ttu-id="88a89-1064">W przypadku korzystania z [usług IIS](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture) lub [IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview)aplikacja działa w procesie innym niż proces roboczy usług IIS ( *poza procesem* ) z [serwerem Kestrel](xref:fundamentals/servers/index#kestrel).</span><span class="sxs-lookup"><span data-stu-id="88a89-1064">When using [IIS](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture) or [IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview), the app runs in a process separate from the IIS worker process ( *out-of-process* ) with the [Kestrel server](xref:fundamentals/servers/index#kestrel).</span></span>

<span data-ttu-id="88a89-1065">Ponieważ ASP.NET Core aplikacje działają w procesie innym niż proces roboczy usług IIS, moduł obsługuje zarządzanie procesami.</span><span class="sxs-lookup"><span data-stu-id="88a89-1065">Because ASP.NET Core apps run in a process separate from the IIS worker process, the module handles process management.</span></span> <span data-ttu-id="88a89-1066">Moduł uruchamia proces dla aplikacji ASP.NET Core, gdy pierwsze żądanie zostanie odebrane i ponownie uruchomiony, jeśli zostanie zamknięty lub ulegnie awarii.</span><span class="sxs-lookup"><span data-stu-id="88a89-1066">The module starts the process for the ASP.NET Core app when the first request arrives and restarts the app if it shuts down or crashes.</span></span> <span data-ttu-id="88a89-1067">Jest to zasadniczo takie samo zachowanie jak w przypadku aplikacji uruchamianych w procesie, które są zarządzane przez [usługę aktywacji procesów systemu Windows (was)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="88a89-1067">This is essentially the same behavior as seen with apps that run in-process that are managed by the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="88a89-1068">Na poniższym diagramie przedstawiono relację między usługami IIS, modułem ASP.NET Core i hostowanym przez aplikację aplikacją:</span><span class="sxs-lookup"><span data-stu-id="88a89-1068">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted out-of-process:</span></span>

![Moduł ASP.NET Core](index/_static/ancm-outofprocess.png)

<span data-ttu-id="88a89-1070">Żądania docierają z sieci Web do sterownika HTTP.sys trybu jądra.</span><span class="sxs-lookup"><span data-stu-id="88a89-1070">Requests arrive from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="88a89-1071">Sterownik kieruje żądania do usług IIS na skonfigurowanym porcie witryny sieci Web, zwykle 80 (HTTP) lub 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="88a89-1071">The driver routes the requests to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="88a89-1072">Moduł przekazuje żądania do Kestrel na losowo wybranym porcie dla aplikacji, która nie jest portem 80 lub 443.</span><span class="sxs-lookup"><span data-stu-id="88a89-1072">The module forwards the requests to Kestrel on a random port for the app, which isn't port 80 or 443.</span></span>

<span data-ttu-id="88a89-1073">Moduł określa port za pośrednictwem zmiennej środowiskowej podczas uruchamiania, a [oprogramowanie pośredniczące integracji usług IIS](xref:host-and-deploy/iis/index#enable-the-iisintegration-components) konfiguruje serwer do nasłuchiwania `http://localhost:{port}` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1073">The module specifies the port via an environment variable at startup, and the [IIS Integration Middleware](xref:host-and-deploy/iis/index#enable-the-iisintegration-components) configures the server to listen on `http://localhost:{port}`.</span></span> <span data-ttu-id="88a89-1074">Dodatkowe sprawdzenia są wykonywane, a żądania, które nie pochodzą z modułu, są odrzucane.</span><span class="sxs-lookup"><span data-stu-id="88a89-1074">Additional checks are performed, and requests that don't originate from the module are rejected.</span></span> <span data-ttu-id="88a89-1075">Moduł nie obsługuje przekazywania HTTPS, dlatego żądania są przekazywane przez protokół HTTP nawet wtedy, gdy są odbierane przez usługę IIS przez protokół HTTPS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1075">The module doesn't support HTTPS forwarding, so requests are forwarded over HTTP even if received by IIS over HTTPS.</span></span>

<span data-ttu-id="88a89-1076">Po podaniu przez Kestrel żądania z modułu żądanie jest wypychane do potoku ASP.NET Core pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="88a89-1076">After Kestrel picks up the request from the module, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="88a89-1077">Potok oprogramowania pośredniczącego obsługuje żądanie i przekazuje go jako `HttpContext` wystąpienie do logiki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1077">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="88a89-1078">Oprogramowanie pośredniczące dodane przez integrację usług IIS aktualizuje schemat, zdalny adres IP i pathbase, aby można było przesłać żądanie do Kestrel.</span><span class="sxs-lookup"><span data-stu-id="88a89-1078">Middleware added by IIS Integration updates the scheme, remote IP, and pathbase to account for forwarding the request to Kestrel.</span></span> <span data-ttu-id="88a89-1079">Odpowiedź aplikacji jest przesyłana z powrotem do usług IIS, która wypycha ją z powrotem do klienta HTTP, który zainicjował żądanie.</span><span class="sxs-lookup"><span data-stu-id="88a89-1079">The app's response is passed back to IIS, which pushes it back out to the HTTP client that initiated the request.</span></span>

<span data-ttu-id="88a89-1080">`CreateDefaultBuilder` Konfiguruje serwer [Kestrel](xref:fundamentals/servers/kestrel) jako serwer sieci Web i włącza INTEGRACJĘ usług IIS przez skonfigurowanie ścieżki podstawowej i portu dla [modułu ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="88a89-1080">`CreateDefaultBuilder` configures [Kestrel](xref:fundamentals/servers/kestrel) server as the web server and enables IIS Integration by configuring the base path and port for the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span>

<span data-ttu-id="88a89-1081">Moduł ASP.NET Core generuje port dynamiczny do przypisania do procesu zaplecza.</span><span class="sxs-lookup"><span data-stu-id="88a89-1081">The ASP.NET Core Module generates a dynamic port to assign to the backend process.</span></span> <span data-ttu-id="88a89-1082">`CreateDefaultBuilder` wywołuje <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration%2A> metodę.</span><span class="sxs-lookup"><span data-stu-id="88a89-1082">`CreateDefaultBuilder` calls the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration%2A> method.</span></span> <span data-ttu-id="88a89-1083">`UseIISIntegration` konfiguruje Kestrel do nasłuchiwania na porcie dynamicznym przy użyciu adresu IP hosta lokalnego ( `127.0.0.1` ).</span><span class="sxs-lookup"><span data-stu-id="88a89-1083">`UseIISIntegration` configures Kestrel to listen on the dynamic port at the localhost IP address (`127.0.0.1`).</span></span> <span data-ttu-id="88a89-1084">Jeśli port dynamiczny to 1234, Kestrel nasłuchuje na `127.0.0.1:1234` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1084">If the dynamic port is 1234, Kestrel listens at `127.0.0.1:1234`.</span></span> <span data-ttu-id="88a89-1085">Ta konfiguracja zastępuje inne konfiguracje URL dostarczone przez:</span><span class="sxs-lookup"><span data-stu-id="88a89-1085">This configuration replaces other URL configurations provided by:</span></span>

* `UseUrls`
* [<span data-ttu-id="88a89-1086">Interfejs API Listen Kestrel</span><span class="sxs-lookup"><span data-stu-id="88a89-1086">Kestrel's Listen API</span></span>](xref:fundamentals/servers/kestrel#endpoint-configuration)
* <span data-ttu-id="88a89-1087">[Konfiguracja](xref:fundamentals/configuration/index) (lub [Opcja wiersza polecenia--URL](xref:fundamentals/host/web-host#override-configuration))</span><span class="sxs-lookup"><span data-stu-id="88a89-1087">[Configuration](xref:fundamentals/configuration/index) (or [command-line --urls option](xref:fundamentals/host/web-host#override-configuration))</span></span>

<span data-ttu-id="88a89-1088">Wywołania `UseUrls` interfejsu API lub Kestrel `Listen` nie są wymagane w przypadku korzystania z modułu.</span><span class="sxs-lookup"><span data-stu-id="88a89-1088">Calls to `UseUrls` or Kestrel's `Listen` API aren't required when using the module.</span></span> <span data-ttu-id="88a89-1089">Jeśli `UseUrls` lub `Listen` jest wywoływana, Kestrel nasłuchuje na porcie określonym tylko podczas uruchamiania aplikacji bez usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1089">If `UseUrls` or `Listen` is called, Kestrel listens on the port specified only when running the app without IIS.</span></span>

<span data-ttu-id="88a89-1090">Aby uzyskać wskazówki dotyczące konfiguracji modułu ASP.NET Core, zobacz <xref:host-and-deploy/aspnet-core-module> .</span><span class="sxs-lookup"><span data-stu-id="88a89-1090">For ASP.NET Core Module configuration guidance, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

<span data-ttu-id="88a89-1091">Aby uzyskać więcej informacji na temat hostingu, zobacz [host in ASP.NET Core](xref:fundamentals/index#host).</span><span class="sxs-lookup"><span data-stu-id="88a89-1091">For more information on hosting, see [Host in ASP.NET Core](xref:fundamentals/index#host).</span></span>

## <a name="application-configuration"></a><span data-ttu-id="88a89-1092">Konfiguracja aplikacji</span><span class="sxs-lookup"><span data-stu-id="88a89-1092">Application configuration</span></span>

### <a name="enable-the-iisintegration-components"></a><span data-ttu-id="88a89-1093">Włącz składniki IISIntegration</span><span class="sxs-lookup"><span data-stu-id="88a89-1093">Enable the IISIntegration components</span></span>

<span data-ttu-id="88a89-1094">Podczas kompilowania hosta w `CreateWebHostBuilder` ( *program.cs* ), wywołaj, <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder%2A> Aby włączyć integrację usług IIS:</span><span class="sxs-lookup"><span data-stu-id="88a89-1094">When building a host in `CreateWebHostBuilder` ( *Program.cs* ), call <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder%2A> to enable IIS integration:</span></span>

```csharp
public static IWebHostBuilder CreateWebHostBuilder(string[] args) =>
    WebHost.CreateDefaultBuilder(args)
        ...
```

<span data-ttu-id="88a89-1095">Aby uzyskać więcej informacji na temat `CreateDefaultBuilder` , zobacz <xref:fundamentals/host/web-host#set-up-a-host> .</span><span class="sxs-lookup"><span data-stu-id="88a89-1095">For more information on `CreateDefaultBuilder`, see <xref:fundamentals/host/web-host#set-up-a-host>.</span></span>

### <a name="iis-options"></a><span data-ttu-id="88a89-1096">Opcje usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-1096">IIS options</span></span>

| <span data-ttu-id="88a89-1097">Opcja</span><span class="sxs-lookup"><span data-stu-id="88a89-1097">Option</span></span>                         | <span data-ttu-id="88a89-1098">Domyślne</span><span class="sxs-lookup"><span data-stu-id="88a89-1098">Default</span></span> | <span data-ttu-id="88a89-1099">Ustawienie</span><span class="sxs-lookup"><span data-stu-id="88a89-1099">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="88a89-1100">Jeśli `true` serwer usług IIS ustawi uwierzytelnienie `HttpContext.User` za pomocą [uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-1100">If `true`, IIS Server sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="88a89-1101">Jeśli `false` serwer zawiera tylko tożsamość dla `HttpContext.User` i reaguje na wyzwania, gdy zostanie jawnie zlecony przez `AuthenticationScheme` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1101">If `false`, the server only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="88a89-1102">Aby program mógł działać, należy włączyć uwierzytelnianie systemu Windows `AutomaticAuthentication` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1102">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="88a89-1103">Aby uzyskać więcej informacji, zobacz [uwierzytelnianie systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-1103">For more information, see [Windows Authentication](xref:security/authentication/windowsauth).</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="88a89-1104">Ustawia nazwę wyświetlaną pokazywaną użytkownikom na stronach logowania.</span><span class="sxs-lookup"><span data-stu-id="88a89-1104">Sets the display name shown to users on login pages.</span></span> |

<span data-ttu-id="88a89-1105">Aby skonfigurować opcje usług IIS, należy uwzględnić <xref:Microsoft.AspNetCore.Builder.IISOptions> w programie konfigurację usługi <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*> .</span><span class="sxs-lookup"><span data-stu-id="88a89-1105">To configure IIS options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span></span> <span data-ttu-id="88a89-1106">Poniższy przykład uniemożliwia wypełnianie aplikacji `HttpContext.Connection.ClientCertificate` :</span><span class="sxs-lookup"><span data-stu-id="88a89-1106">The following example prevents the app from populating `HttpContext.Connection.ClientCertificate`:</span></span>

```csharp
services.Configure<IISOptions>(options => 
{
    options.ForwardClientCertificate = false;
});
```

| <span data-ttu-id="88a89-1107">Opcja</span><span class="sxs-lookup"><span data-stu-id="88a89-1107">Option</span></span>                         | <span data-ttu-id="88a89-1108">Domyślne</span><span class="sxs-lookup"><span data-stu-id="88a89-1108">Default</span></span> | <span data-ttu-id="88a89-1109">Ustawienie</span><span class="sxs-lookup"><span data-stu-id="88a89-1109">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="88a89-1110">Jeśli `true` [oprogramowanie pośredniczące integracji usług IIS](#enable-the-iisintegration-components) ustawi uwierzytelnienie `HttpContext.User` za pomocą [uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-1110">If `true`, [IIS Integration Middleware](#enable-the-iisintegration-components) sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="88a89-1111">Jeśli `false` oprogramowanie pośredniczące zapewnia tylko tożsamość `HttpContext.User` i reaguje na wyzwania, gdy zostanie jawnie zażądana przez program `AuthenticationScheme` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1111">If `false`, the middleware only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="88a89-1112">Aby program mógł działać, należy włączyć uwierzytelnianie systemu Windows `AutomaticAuthentication` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1112">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="88a89-1113">Aby uzyskać więcej informacji, zobacz temat [uwierzytelnianie systemu Windows](xref:security/authentication/windowsauth) .</span><span class="sxs-lookup"><span data-stu-id="88a89-1113">For more information, see the [Windows Authentication](xref:security/authentication/windowsauth) topic.</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="88a89-1114">Ustawia nazwę wyświetlaną pokazywaną użytkownikom na stronach logowania.</span><span class="sxs-lookup"><span data-stu-id="88a89-1114">Sets the display name shown to users on login pages.</span></span> |
| `ForwardClientCertificate`     | `true`  | <span data-ttu-id="88a89-1115">Jeśli `true` `MS-ASPNETCORE-CLIENTCERT` jest obecny nagłówek żądania, `HttpContext.Connection.ClientCertificate` zostanie wypełniony.</span><span class="sxs-lookup"><span data-stu-id="88a89-1115">If `true` and the `MS-ASPNETCORE-CLIENTCERT` request header is present, the `HttpContext.Connection.ClientCertificate` is populated.</span></span> |

### <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="88a89-1116">Scenariusze serwera proxy i modułu równoważenia obciążenia</span><span class="sxs-lookup"><span data-stu-id="88a89-1116">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="88a89-1117">[Oprogramowanie pośredniczące integracji usług IIS](#enable-the-iisintegration-components), które konfiguruje przekazane nagłówki oprogramowania pośredniczącego, a moduł ASP.NET Core jest skonfigurowany do przesyłania dalej schematu (http/https) i zdalnego adresu IP, z którego pochodzi żądanie.</span><span class="sxs-lookup"><span data-stu-id="88a89-1117">The [IIS Integration Middleware](#enable-the-iisintegration-components), which configures Forwarded Headers Middleware, and the ASP.NET Core Module are configured to forward the scheme (HTTP/HTTPS) and the remote IP address where the request originated.</span></span> <span data-ttu-id="88a89-1118">W przypadku aplikacji hostowanych za dodatkowymi serwerami proxy i modułami równoważenia obciążenia może być wymagana dodatkowa konfiguracja.</span><span class="sxs-lookup"><span data-stu-id="88a89-1118">Additional configuration might be required for apps hosted behind additional proxy servers and load balancers.</span></span> <span data-ttu-id="88a89-1119">Aby uzyskać więcej informacji, zobacz [konfigurowanie ASP.NET Core do pracy z serwerami proxy i usługami równoważenia obciążenia](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="88a89-1119">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

### <a name="webconfig-file"></a><span data-ttu-id="88a89-1120">Plik web.config</span><span class="sxs-lookup"><span data-stu-id="88a89-1120">web.config file</span></span>

<span data-ttu-id="88a89-1121">Plik *web.config* konfiguruje [moduł ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="88a89-1121">The *web.config* file configures the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="88a89-1122">Tworzenie, przekształcanie i publikowanie pliku *web.config* jest obsługiwane przez obiekt docelowy MSBuild ( `_TransformWebConfig` ), gdy projekt jest publikowany.</span><span class="sxs-lookup"><span data-stu-id="88a89-1122">Creating, transforming, and publishing the *web.config* file is handled by an MSBuild target (`_TransformWebConfig`) when the project is published.</span></span> <span data-ttu-id="88a89-1123">Ten element docelowy znajduje się w obiektach docelowych zestawu SDK sieci Web ( `Microsoft.NET.Sdk.Web` ).</span><span class="sxs-lookup"><span data-stu-id="88a89-1123">This target is present in the Web SDK targets (`Microsoft.NET.Sdk.Web`).</span></span> <span data-ttu-id="88a89-1124">Zestaw SDK jest ustawiany u góry pliku projektu:</span><span class="sxs-lookup"><span data-stu-id="88a89-1124">The SDK is set at the top of the project file:</span></span>

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">
```

<span data-ttu-id="88a89-1125">Jeśli plik *web.config* nie jest obecny w projekcie, plik zostanie utworzony z prawidłowymi *argumentami* *ProcessPath* i, aby skonfigurować moduł ASP.NET Core i przeniesiony do [publikowanych danych wyjściowych](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="88a89-1125">If a *web.config* file isn't present in the project, the file is created with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to [published output](xref:host-and-deploy/directory-structure).</span></span>

<span data-ttu-id="88a89-1126">Jeśli plik *web.config* jest obecny w projekcie, plik zostanie przekształcony przy użyciu poprawnych *processPath* i *argumentów* w celu skonfigurowania modułu ASP.NET Core i przeniesiona do publikowanych danych wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="88a89-1126">If a *web.config* file is present in the project, the file is transformed with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to published output.</span></span> <span data-ttu-id="88a89-1127">Transformacja nie modyfikuje ustawień konfiguracji usług IIS w pliku.</span><span class="sxs-lookup"><span data-stu-id="88a89-1127">The transformation doesn't modify IIS configuration settings in the file.</span></span>

<span data-ttu-id="88a89-1128">Plik *web.config* może zapewnić dodatkowe ustawienia konfiguracji usług IIS kontrolujące aktywne moduły usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1128">The *web.config* file may provide additional IIS configuration settings that control active IIS modules.</span></span> <span data-ttu-id="88a89-1129">Aby uzyskać informacje na temat modułów usług IIS, które mogą przetwarzać żądania z aplikacjami ASP.NET Core, zobacz temat [moduły usług IIS](xref:host-and-deploy/iis/modules) .</span><span class="sxs-lookup"><span data-stu-id="88a89-1129">For information on IIS modules that are capable of processing requests with ASP.NET Core apps, see the [IIS modules](xref:host-and-deploy/iis/modules) topic.</span></span>

<span data-ttu-id="88a89-1130">Aby zapobiec transformacji pliku *web.config* przez zestaw SDK sieci Web, należy użyć **\<IsTransformWebConfigDisabled>** właściwości w pliku projektu:</span><span class="sxs-lookup"><span data-stu-id="88a89-1130">To prevent the Web SDK from transforming the *web.config* file, use the **\<IsTransformWebConfigDisabled>** property in the project file:</span></span>

```xml
<PropertyGroup>
  <IsTransformWebConfigDisabled>true</IsTransformWebConfigDisabled>
</PropertyGroup>
```

<span data-ttu-id="88a89-1131">Podczas wyłączania pliku zestawu SDK sieci Web, *processPath* i *argumenty* powinny być ustawiane ręcznie przez dewelopera.</span><span class="sxs-lookup"><span data-stu-id="88a89-1131">When disabling the Web SDK from transforming the file, the *processPath* and *arguments* should be manually set by the developer.</span></span> <span data-ttu-id="88a89-1132">Aby uzyskać więcej informacji, zobacz <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="88a89-1132">For more information, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

### <a name="webconfig-file-location"></a><span data-ttu-id="88a89-1133">Lokalizacja pliku web.config</span><span class="sxs-lookup"><span data-stu-id="88a89-1133">web.config file location</span></span>

<span data-ttu-id="88a89-1134">W celu poprawnego skonfigurowania [modułu ASP.NET Core](xref:host-and-deploy/aspnet-core-module) plik *web.config* musi znajdować się w ścieżce [katalogu głównego zawartości](xref:fundamentals/index#content-root) (zazwyczaj ścieżka podstawowa aplikacji) wdrożonej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1134">In order to set up the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) correctly, the *web.config* file must be present at the [content root](xref:fundamentals/index#content-root) path (typically the app base path) of the deployed app.</span></span> <span data-ttu-id="88a89-1135">Ta sama lokalizacja jest taka sama jak ścieżka fizyczna witryny sieci Web dostarczana do usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1135">This is the same location as the website physical path provided to IIS.</span></span> <span data-ttu-id="88a89-1136">Plik *web.config* jest wymagany w katalogu głównym aplikacji, aby umożliwić Publikowanie wielu aplikacji przy użyciu Web Deploy.</span><span class="sxs-lookup"><span data-stu-id="88a89-1136">The *web.config* file is required at the root of the app to enable the publishing of multiple apps using Web Deploy.</span></span>

<span data-ttu-id="88a89-1137">Poufne pliki znajdują się w ścieżce fizycznej aplikacji, na przykład *\<assembly>.runtimeconfig.jsna* , *\<assembly> . XML* (Komentarze dokumentacji XML) i *\<assembly>.deps.js* .</span><span class="sxs-lookup"><span data-stu-id="88a89-1137">Sensitive files exist on the app's physical path, such as *\<assembly>.runtimeconfig.json* , *\<assembly>.xml* (XML Documentation comments), and *\<assembly>.deps.json* .</span></span> <span data-ttu-id="88a89-1138">Gdy plik *web.config* jest obecny, a lokacja jest uruchamiana normalnie, usługi IIS nie będą obsługiwały tych poufnych plików, jeśli są żądane.</span><span class="sxs-lookup"><span data-stu-id="88a89-1138">When the *web.config* file is present and the site starts normally, IIS doesn't serve these sensitive files if they're requested.</span></span> <span data-ttu-id="88a89-1139">Jeśli brakuje pliku *web.config* , nazwa jest nieprawidłowa lub nie można skonfigurować lokacji do normalnego uruchamiania, usługi IIS mogą publicznie udostępniać poufne pliki.</span><span class="sxs-lookup"><span data-stu-id="88a89-1139">If the *web.config* file is missing, incorrectly named, or unable to configure the site for normal startup, IIS may serve sensitive files publicly.</span></span>

<span data-ttu-id="88a89-1140">**Plik *web.config* musi być obecny we wdrożeniu przez cały czas, prawidłowo nazwany i można skonfigurować lokację pod kątem normalnego uruchamiania. Nigdy nie usuwaj pliku *web.config* z wdrożenia produkcyjnego.**</span><span class="sxs-lookup"><span data-stu-id="88a89-1140">**The *web.config* file must be present in the deployment at all times, correctly named, and able to configure the site for normal start up. Never remove the *web.config* file from a production deployment.**</span></span>

### <a name="transform-webconfig"></a><span data-ttu-id="88a89-1141">Przekształcanie pliku web.config</span><span class="sxs-lookup"><span data-stu-id="88a89-1141">Transform web.config</span></span>

<span data-ttu-id="88a89-1142">Jeśli musisz przekształcić *web.config* przy publikowaniu (na przykład ustawić zmienne środowiskowe na podstawie konfiguracji, profilu lub środowiska), zobacz <xref:host-and-deploy/iis/transform-webconfig> .</span><span class="sxs-lookup"><span data-stu-id="88a89-1142">If you need to transform *web.config* on publish (for example, set environment variables based on the configuration, profile, or environment), see <xref:host-and-deploy/iis/transform-webconfig>.</span></span>

## <a name="iis-configuration"></a><span data-ttu-id="88a89-1143">Konfiguracja usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-1143">IIS configuration</span></span>

<span data-ttu-id="88a89-1144">**Systemy operacyjne Windows Server**</span><span class="sxs-lookup"><span data-stu-id="88a89-1144">**Windows Server operating systems**</span></span>

<span data-ttu-id="88a89-1145">Włącz rolę serwera **serwera sieci Web (IIS)** i Ustanów usługi ról.</span><span class="sxs-lookup"><span data-stu-id="88a89-1145">Enable the **Web Server (IIS)** server role and establish role services.</span></span>

1. <span data-ttu-id="88a89-1146">Użyj kreatora **dodawania ról i funkcji** z menu **Zarządzaj** lub łącza w **Menedżer serwera** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1146">Use the **Add Roles and Features** wizard from the **Manage** menu or the link in **Server Manager** .</span></span> <span data-ttu-id="88a89-1147">W kroku **role serwera** zaznacz pole wyboru **serwer sieci Web (IIS)** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1147">On the **Server Roles** step, check the box for **Web Server (IIS)** .</span></span>

   ![W kroku wybierz role serwera zostanie wybrana rola IIS serwera sieci Web.](index/_static/server-roles-ws2016.png)

1. <span data-ttu-id="88a89-1149">Po wykonaniu **kroków krok po kroku** **usługi ról** są ładowane dla serwera sieci Web (IIS).</span><span class="sxs-lookup"><span data-stu-id="88a89-1149">After the **Features** step, the **Role services** step loads for Web Server (IIS).</span></span> <span data-ttu-id="88a89-1150">Wybierz żądane usługi roli IIS lub zaakceptuj domyślne usługi ról.</span><span class="sxs-lookup"><span data-stu-id="88a89-1150">Select the IIS role services desired or accept the default role services provided.</span></span>

   ![Domyślne usługi ról są wybrane w kroku Wybierz usługi ról.](index/_static/role-services-ws2016.png)

   <span data-ttu-id="88a89-1152">**Uwierzytelnianie systemu Windows (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-1152">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="88a89-1153">Aby włączyć uwierzytelnianie systemu Windows, rozwiń następujące węzły: **Zabezpieczenia serwera sieci Web**  >  **Security** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1153">To enable Windows Authentication, expand the following nodes: **Web Server** > **Security** .</span></span> <span data-ttu-id="88a89-1154">Wybierz funkcję **uwierzytelniania systemu Windows** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1154">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="88a89-1155">Aby uzyskać więcej informacji, zobacz [uwierzytelnianie \<windowsAuthentication> systemu Windows](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) i [Konfigurowanie uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-1155">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="88a89-1156">**Obiekty WebSockets (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-1156">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="88a89-1157">Obiekty WebSockets są obsługiwane w ASP.NET Core 1,1 lub nowszych.</span><span class="sxs-lookup"><span data-stu-id="88a89-1157">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="88a89-1158">Aby włączyć obiekty WebSockets, rozwiń następujące węzły: projektowanie aplikacji **serwera sieci Web**  >  **Application Development** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1158">To enable WebSockets, expand the following nodes: **Web Server** > **Application Development** .</span></span> <span data-ttu-id="88a89-1159">Wybierz funkcję **protokołu WebSocket** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1159">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="88a89-1160">Aby uzyskać więcej informacji, zobacz [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="88a89-1160">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="88a89-1161">Przejdź do kroku **potwierdzenia** , aby zainstalować rolę i usługi serwera sieci Web.</span><span class="sxs-lookup"><span data-stu-id="88a89-1161">Proceed through the **Confirmation** step to install the web server role and services.</span></span> <span data-ttu-id="88a89-1162">Po zainstalowaniu roli **serwera sieci Web (IIS)** nie jest wymagane ponowne uruchomienie serwera ani usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1162">A server/IIS restart isn't required after installing the **Web Server (IIS)** role.</span></span>

<span data-ttu-id="88a89-1163">**Systemy operacyjne Windows dla komputerów stacjonarnych**</span><span class="sxs-lookup"><span data-stu-id="88a89-1163">**Windows desktop operating systems**</span></span>

<span data-ttu-id="88a89-1164">Włącz **konsolę zarządzania usług IIS** i **usługi World Wide Web** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1164">Enable the **IIS Management Console** and **World Wide Web Services** .</span></span>

1. <span data-ttu-id="88a89-1165">Przejdź do pozycji **Panel sterowania** > **programy** > **programy i funkcje** > **Włącz lub wyłącz funkcje systemu Windows** (po lewej stronie ekranu).</span><span class="sxs-lookup"><span data-stu-id="88a89-1165">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>

1. <span data-ttu-id="88a89-1166">Otwórz węzeł **Internet Information Services** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1166">Open the **Internet Information Services** node.</span></span> <span data-ttu-id="88a89-1167">Otwórz węzeł **Narzędzia do zarządzania siecią Web** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1167">Open the **Web Management Tools** node.</span></span>

1. <span data-ttu-id="88a89-1168">Zaznacz pole wyboru w obszarze **Konsola zarządzania usługami IIS** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1168">Check the box for **IIS Management Console** .</span></span>

1. <span data-ttu-id="88a89-1169">Zaznacz pole wyboru **usług World Wide Web Services** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1169">Check the box for **World Wide Web Services** .</span></span>

1. <span data-ttu-id="88a89-1170">Zaakceptuj domyślne funkcje **usług World Wide Web Services** lub Dostosuj funkcje usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1170">Accept the default features for **World Wide Web Services** or customize the IIS features.</span></span>

   <span data-ttu-id="88a89-1171">**Uwierzytelnianie systemu Windows (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-1171">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="88a89-1172">Aby włączyć uwierzytelnianie systemu Windows, rozwiń następujące węzły: **World Wide Web usług**  >  **zabezpieczenia** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1172">To enable Windows Authentication, expand the following nodes: **World Wide Web Services** > **Security** .</span></span> <span data-ttu-id="88a89-1173">Wybierz funkcję **uwierzytelniania systemu Windows** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1173">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="88a89-1174">Aby uzyskać więcej informacji, zobacz [uwierzytelnianie \<windowsAuthentication> systemu Windows](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) i [Konfigurowanie uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-1174">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="88a89-1175">**Obiekty WebSockets (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-1175">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="88a89-1176">Obiekty WebSockets są obsługiwane w ASP.NET Core 1,1 lub nowszych.</span><span class="sxs-lookup"><span data-stu-id="88a89-1176">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="88a89-1177">Aby włączyć obiekty WebSockets, rozwiń następujące węzły: **World Wide Web Services**  >  **Application Development Features** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1177">To enable WebSockets, expand the following nodes: **World Wide Web Services** > **Application Development Features** .</span></span> <span data-ttu-id="88a89-1178">Wybierz funkcję **protokołu WebSocket** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1178">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="88a89-1179">Aby uzyskać więcej informacji, zobacz [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="88a89-1179">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="88a89-1180">Jeśli instalacja usług IIS wymaga ponownego uruchomienia, należy ponownie uruchomić system.</span><span class="sxs-lookup"><span data-stu-id="88a89-1180">If the IIS installation requires a restart, restart the system.</span></span>

![Konsola zarządzania usługami IIS i usługi World Wide Web są wybrane w funkcjach systemu Windows.](index/_static/windows-features-win10.png)

## <a name="install-the-net-core-hosting-bundle"></a><span data-ttu-id="88a89-1182">Zainstaluj pakiet hostingu platformy .NET Core</span><span class="sxs-lookup"><span data-stu-id="88a89-1182">Install the .NET Core Hosting Bundle</span></span>

<span data-ttu-id="88a89-1183">Zainstaluj *pakiet hostingu platformy .NET Core* w systemie hostingu.</span><span class="sxs-lookup"><span data-stu-id="88a89-1183">Install the *.NET Core Hosting Bundle* on the hosting system.</span></span> <span data-ttu-id="88a89-1184">Pakiet instaluje środowisko uruchomieniowe programu .NET Core, bibliotekę .NET Core i [moduł ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="88a89-1184">The bundle installs the .NET Core Runtime, .NET Core Library, and the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="88a89-1185">Moduł umożliwia uruchamianie aplikacji ASP.NET Core za pomocą usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1185">The module allows ASP.NET Core apps to run behind IIS.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="88a89-1186">Jeśli pakiet hostingu jest zainstalowany przed usługami IIS, należy naprawić pakiet instalacyjny.</span><span class="sxs-lookup"><span data-stu-id="88a89-1186">If the Hosting Bundle is installed before IIS, the bundle installation must be repaired.</span></span> <span data-ttu-id="88a89-1187">Uruchom ponownie Instalatora pakietu hostingu po zainstalowaniu usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1187">Run the Hosting Bundle installer again after installing IIS.</span></span>
>
> <span data-ttu-id="88a89-1188">Jeśli pakiet hostingu jest instalowany po zainstalowaniu 64-bitowej (x64) wersji programu .NET Core, prawdopodobnie brakuje zestawów SDK ([nie wykryto żadnych zestawów SDK dla platformy .NET Core](xref:test/troubleshoot#no-net-core-sdks-were-detected)).</span><span class="sxs-lookup"><span data-stu-id="88a89-1188">If the Hosting Bundle is installed after installing the 64-bit (x64) version of .NET Core, SDKs might appear to be missing ([No .NET Core SDKs were detected](xref:test/troubleshoot#no-net-core-sdks-were-detected)).</span></span> <span data-ttu-id="88a89-1189">Aby rozwiązać ten problem, zobacz <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle> .</span><span class="sxs-lookup"><span data-stu-id="88a89-1189">To resolve the problem, see <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle>.</span></span>

### <a name="download"></a><span data-ttu-id="88a89-1190">Pobierz</span><span class="sxs-lookup"><span data-stu-id="88a89-1190">Download</span></span>

1. <span data-ttu-id="88a89-1191">Przejdź do strony [pobieranie platformy .NET Core](https://dotnet.microsoft.com/download/dotnet-core) .</span><span class="sxs-lookup"><span data-stu-id="88a89-1191">Navigate to the [Download .NET Core](https://dotnet.microsoft.com/download/dotnet-core) page.</span></span>
1. <span data-ttu-id="88a89-1192">Wybierz żądaną wersję programu .NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-1192">Select the desired .NET Core version.</span></span>
1. <span data-ttu-id="88a89-1193">W kolumnie **Uruchom aplikacje — środowisko uruchomieniowe** Znajdź wiersz żądanej wersji środowiska uruchomieniowego platformy .NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-1193">In the **Run apps - Runtime** column, find the row of the .NET Core runtime version desired.</span></span>
1. <span data-ttu-id="88a89-1194">Pobierz instalatora przy użyciu linku do **pakietu hostingu** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1194">Download the installer using the **Hosting Bundle** link.</span></span>

> [!WARNING]
> <span data-ttu-id="88a89-1195">Niektóre Instalatory zawierają wersje wydania, które osiągnęły koniec cyklu życia (EOL) i nie są już obsługiwane przez firmę Microsoft.</span><span class="sxs-lookup"><span data-stu-id="88a89-1195">Some installers contain release versions that have reached their end of life (EOL) and are no longer supported by Microsoft.</span></span> <span data-ttu-id="88a89-1196">Aby uzyskać więcej informacji, zobacz [zasady pomocy technicznej](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span><span class="sxs-lookup"><span data-stu-id="88a89-1196">For more information, see the [support policy](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span></span>

### <a name="install-the-hosting-bundle"></a><span data-ttu-id="88a89-1197">Zainstaluj pakiet hostingu</span><span class="sxs-lookup"><span data-stu-id="88a89-1197">Install the Hosting Bundle</span></span>

1. <span data-ttu-id="88a89-1198">Uruchom Instalatora na serwerze.</span><span class="sxs-lookup"><span data-stu-id="88a89-1198">Run the installer on the server.</span></span> <span data-ttu-id="88a89-1199">Następujące parametry są dostępne podczas uruchamiania Instalatora z powłoki poleceń administratora:</span><span class="sxs-lookup"><span data-stu-id="88a89-1199">The following parameters are available when running the installer from an administrator command shell:</span></span>

   * <span data-ttu-id="88a89-1200">`OPT_NO_ANCM=1`: Pomiń Instalowanie modułu ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-1200">`OPT_NO_ANCM=1`: Skip installing the ASP.NET Core Module.</span></span>
   * <span data-ttu-id="88a89-1201">`OPT_NO_RUNTIME=1`: Pomiń Instalowanie środowiska uruchomieniowego platformy .NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-1201">`OPT_NO_RUNTIME=1`: Skip installing the .NET Core runtime.</span></span> <span data-ttu-id="88a89-1202">Używany, gdy serwer obsługuje tylko [wdrożenia samodzielne (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span><span class="sxs-lookup"><span data-stu-id="88a89-1202">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="88a89-1203">`OPT_NO_SHAREDFX=1`: Pomiń instalację ASP.NET Shared Framework (ASP.NET Runtime).</span><span class="sxs-lookup"><span data-stu-id="88a89-1203">`OPT_NO_SHAREDFX=1`: Skip installing the ASP.NET Shared Framework (ASP.NET runtime).</span></span> <span data-ttu-id="88a89-1204">Używany, gdy serwer obsługuje tylko [wdrożenia samodzielne (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span><span class="sxs-lookup"><span data-stu-id="88a89-1204">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="88a89-1205">`OPT_NO_X86=1`: Pomiń Instalowanie środowiska uruchomieniowego x86.</span><span class="sxs-lookup"><span data-stu-id="88a89-1205">`OPT_NO_X86=1`: Skip installing x86 runtimes.</span></span> <span data-ttu-id="88a89-1206">Użyj tego parametru, Jeśli wiesz, że nie będziesz hostować aplikacji 32-bitowych.</span><span class="sxs-lookup"><span data-stu-id="88a89-1206">Use this parameter when you know that you won't be hosting 32-bit apps.</span></span> <span data-ttu-id="88a89-1207">Jeśli w przyszłości będziesz hostować zarówno aplikacje 32-bitowe, jak i 64-bitowe, nie używaj tego parametru i zainstaluj oba środowiska uruchomieniowe.</span><span class="sxs-lookup"><span data-stu-id="88a89-1207">If there's any chance that you will host both 32-bit and 64-bit apps in the future, don't use this parameter and install both runtimes.</span></span>
   * <span data-ttu-id="88a89-1208">`OPT_NO_SHARED_CONFIG_CHECK=1`: Wyłącz sprawdzanie przy użyciu konfiguracji udostępnionej usług IIS, gdy konfiguracja udostępniona ( *applicationHost.config* ) znajduje się na tym samym komputerze, na którym zainstalowano program IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1208">`OPT_NO_SHARED_CONFIG_CHECK=1`: Disable the check for using an IIS Shared Configuration when the shared configuration ( *applicationHost.config* ) is on the same machine as the IIS installation.</span></span> <span data-ttu-id="88a89-1209">*Dostępne tylko w przypadku ASP.NET Core 2,2 lub nowszych instalatorów pakietu do obsługi.*</span><span class="sxs-lookup"><span data-stu-id="88a89-1209">*Only available for ASP.NET Core 2.2 or later Hosting Bundler installers.*</span></span> <span data-ttu-id="88a89-1210">Aby uzyskać więcej informacji, zobacz <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span><span class="sxs-lookup"><span data-stu-id="88a89-1210">For more information, see <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span></span>
1. <span data-ttu-id="88a89-1211">Uruchom ponownie system lub wykonaj następujące polecenia w powłoce poleceń:</span><span class="sxs-lookup"><span data-stu-id="88a89-1211">Restart the system or execute the following commands in a command shell:</span></span>

   ```console
   net stop was /y
   net start w3svc
   ```
   <span data-ttu-id="88a89-1212">Ponowne uruchomienie usług IIS powoduje zmianę ścieżki systemowej, która jest zmienną środowiskową, wykonaną przez Instalatora.</span><span class="sxs-lookup"><span data-stu-id="88a89-1212">Restarting IIS picks up a change to the system PATH, which is an environment variable, made by the installer.</span></span>

<span data-ttu-id="88a89-1213">Nie jest konieczne ręczne zatrzymanie poszczególnych lokacji w usługach IIS podczas instalowania pakietu hostingu.</span><span class="sxs-lookup"><span data-stu-id="88a89-1213">It isn't necessary to manually stop individual sites in IIS when installing the Hosting Bundle.</span></span> <span data-ttu-id="88a89-1214">Aplikacje hostowane (lokacje IIS) są ponownie uruchamiane po ponownym uruchomieniu usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1214">Hosted apps (IIS sites) restart when IIS restarts.</span></span> <span data-ttu-id="88a89-1215">Aplikacje są uruchamiane ponownie po otrzymaniu pierwszego żądania, w tym od [modułu inicjalizacji aplikacji](#application-initialization-module-and-idle-timeout).</span><span class="sxs-lookup"><span data-stu-id="88a89-1215">Apps start up again when they receive their first request, including from the [Application Initialization Module](#application-initialization-module-and-idle-timeout).</span></span>

<span data-ttu-id="88a89-1216">ASP.NET Core przyjmuje zachowanie funkcji przekazywania do przodu dla wydań poprawek udostępnionych pakietów platformy.</span><span class="sxs-lookup"><span data-stu-id="88a89-1216">ASP.NET Core adopts roll-forward behavior for patch releases of shared framework packages.</span></span> <span data-ttu-id="88a89-1217">Po ponownym uruchomieniu aplikacji hostowanych przez usługi IIS przy użyciu usług IIS aplikacje są ładowane z najnowszymi wersjami poprawki pakietów, do których się odwołują, gdy otrzymają swoje pierwsze żądanie.</span><span class="sxs-lookup"><span data-stu-id="88a89-1217">When apps hosted by IIS restart with IIS, the apps load with the latest patch releases of their referenced packages when they receive their first request.</span></span> <span data-ttu-id="88a89-1218">Jeśli usługi IIS nie zostaną ponownie uruchomione, aplikacje ponownie uruchamiają się i wykazują zachowanie przekazujące, gdy procesy robocze są odtwarzane i otrzymują swoje pierwsze żądanie.</span><span class="sxs-lookup"><span data-stu-id="88a89-1218">If IIS isn't restarted, apps restart and exhibit roll-forward behavior when their worker processes are recycled and they receive their first request.</span></span>

> [!NOTE]
> <span data-ttu-id="88a89-1219">Aby uzyskać informacje na temat konfiguracji udostępnionej usług IIS, zobacz [ASP.NET Core Module z udostępnioną konfiguracją usług IIS](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span><span class="sxs-lookup"><span data-stu-id="88a89-1219">For information on IIS Shared Configuration, see [ASP.NET Core Module with IIS Shared Configuration](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span></span>

## <a name="install-web-deploy-when-publishing-with-visual-studio"></a><span data-ttu-id="88a89-1220">Zainstaluj Web Deploy przy publikowaniu w programie Visual Studio</span><span class="sxs-lookup"><span data-stu-id="88a89-1220">Install Web Deploy when publishing with Visual Studio</span></span>

<span data-ttu-id="88a89-1221">Podczas wdrażania aplikacji na serwerach z [Web Deploy](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later)Zainstaluj najnowszą wersję Web Deploy na serwerze.</span><span class="sxs-lookup"><span data-stu-id="88a89-1221">When deploying apps to servers with [Web Deploy](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later), install the latest version of Web Deploy on the server.</span></span> <span data-ttu-id="88a89-1222">Aby zainstalować Web Deploy, należy użyć [Instalatora platformy sieci Web (Instalatora WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) lub uzyskać instalatora bezpośrednio z [Centrum pobierania Microsoft](https://www.microsoft.com/download/details.aspx?id=43717).</span><span class="sxs-lookup"><span data-stu-id="88a89-1222">To install Web Deploy, use the [Web Platform Installer (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) or obtain an installer directly from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=43717).</span></span> <span data-ttu-id="88a89-1223">Preferowaną metodą jest użycie Instalatora WebPI.</span><span class="sxs-lookup"><span data-stu-id="88a89-1223">The preferred method is to use WebPI.</span></span> <span data-ttu-id="88a89-1224">Instalatora WebPI oferuje autonomiczną konfigurację i konfigurację dla dostawców hostingu.</span><span class="sxs-lookup"><span data-stu-id="88a89-1224">WebPI offers a standalone setup and a configuration for hosting providers.</span></span>

## <a name="create-the-iis-site"></a><span data-ttu-id="88a89-1225">Tworzenie witryny usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-1225">Create the IIS site</span></span>

1. <span data-ttu-id="88a89-1226">W systemie hostingu Utwórz folder, który będzie zawierać opublikowane foldery i pliki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1226">On the hosting system, create a folder to contain the app's published folders and files.</span></span> <span data-ttu-id="88a89-1227">W poniższym kroku ścieżka folderu jest dostarczana do usług IIS jako ścieżka fizyczna do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1227">In a following step, the folder's path is provided to IIS as the physical path to the app.</span></span> <span data-ttu-id="88a89-1228">Aby uzyskać więcej informacji na temat folderu wdrożenia aplikacji i układu pliku, zobacz <xref:host-and-deploy/directory-structure> .</span><span class="sxs-lookup"><span data-stu-id="88a89-1228">For more information on an app's deployment folder and file layout, see <xref:host-and-deploy/directory-structure>.</span></span>

1. <span data-ttu-id="88a89-1229">W Menedżerze usług IIS Otwórz węzeł serwera w panelu **połączenia** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1229">In IIS Manager, open the server's node in the **Connections** panel.</span></span> <span data-ttu-id="88a89-1230">Kliknij prawym przyciskiem myszy folder **sitess** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1230">Right-click the **Sites** folder.</span></span> <span data-ttu-id="88a89-1231">Wybierz pozycję **Dodaj witrynę internetową** z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="88a89-1231">Select **Add Website** from the contextual menu.</span></span>

1. <span data-ttu-id="88a89-1232">Podaj **nazwę lokacji** i ustaw **ścieżkę fizyczną** folderu wdrożenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1232">Provide a **Site name** and set the **Physical path** to the app's deployment folder.</span></span> <span data-ttu-id="88a89-1233">Podaj konfigurację **powiązania** i Utwórz witrynę sieci Web, wybierając **przycisk OK** :</span><span class="sxs-lookup"><span data-stu-id="88a89-1233">Provide the **Binding** configuration and create the website by selecting **OK** :</span></span>

   ![Podaj nazwę lokacji, ścieżkę fizyczną i nazwę hosta w kroku Dodaj witrynę sieci Web.](index/_static/add-website-ws2016.png)

   > [!WARNING]
   > <span data-ttu-id="88a89-1235">`http://*:80/` `http://+:80` **Nie** należy używać powiązań z symbolami wieloznacznymi (i) najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="88a89-1235">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="88a89-1236">Powiązania z symbolami wieloznacznymi najwyższego poziomu mogą otwierać aplikację pod kątem luk w zabezpieczeniach.</span><span class="sxs-lookup"><span data-stu-id="88a89-1236">Top-level wildcard bindings can open up your app to security vulnerabilities.</span></span> <span data-ttu-id="88a89-1237">Dotyczy to zarówno silnych, jak i słabych symboli wieloznacznych.</span><span class="sxs-lookup"><span data-stu-id="88a89-1237">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="88a89-1238">Używaj jawnych nazw hostów zamiast symboli wieloznacznych.</span><span class="sxs-lookup"><span data-stu-id="88a89-1238">Use explicit host names rather than wildcards.</span></span> <span data-ttu-id="88a89-1239">Powiązanie symboli wieloznacznych z poddomeną (na przykład `*.mysub.com` ) nie ma tego ryzyka bezpieczeństwa, jeśli kontrolujesz całą domenę nadrzędną (w przeciwieństwie do `*.com` , która jest narażona).</span><span class="sxs-lookup"><span data-stu-id="88a89-1239">Subdomain wildcard binding (for example, `*.mysub.com`) doesn't have this security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="88a89-1240">Aby uzyskać więcej informacji, zobacz [sekcję rfc7230-5,4](https://tools.ietf.org/html/rfc7230#section-5.4) .</span><span class="sxs-lookup"><span data-stu-id="88a89-1240">See [rfc7230 section-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) for more information.</span></span>

1. <span data-ttu-id="88a89-1241">W węźle serwera wybierz pozycję **Pule aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1241">Under the server's node, select **Application Pools** .</span></span>

1. <span data-ttu-id="88a89-1242">Kliknij prawym przyciskiem myszy pulę aplikacji lokacji i wybierz pozycję **Ustawienia podstawowe** z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="88a89-1242">Right-click the site's app pool and select **Basic Settings** from the contextual menu.</span></span>

1. <span data-ttu-id="88a89-1243">W oknie **Edytowanie puli aplikacji** Ustaw **wersję środowiska .NET CLR** na **Brak kodu zarządzanego** :</span><span class="sxs-lookup"><span data-stu-id="88a89-1243">In the **Edit Application Pool** window, set the **.NET CLR version** to **No Managed Code** :</span></span>

   ![Nie ustawiaj kodu zarządzanego dla wersji środowiska .NET CLR.](index/_static/edit-apppool-ws2016.png)

    <span data-ttu-id="88a89-1245">ASP.NET Core działa w osobnym procesie i zarządza środowiskiem uruchomieniowym.</span><span class="sxs-lookup"><span data-stu-id="88a89-1245">ASP.NET Core runs in a separate process and manages the runtime.</span></span> <span data-ttu-id="88a89-1246">ASP.NET Core nie polega na ładowaniu środowiska CLR (.NET CLR) &mdash; podstawowego środowiska uruchomieniowego języka wspólnego (CoreCLR) dla platformy .NET Core w celu hostowania aplikacji w procesie roboczym.</span><span class="sxs-lookup"><span data-stu-id="88a89-1246">ASP.NET Core doesn't rely on loading the desktop CLR (.NET CLR)&mdash;the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process.</span></span> <span data-ttu-id="88a89-1247">Ustawienie **wersji środowiska .NET CLR** na **Brak kodu zarządzanego** jest opcjonalne, ale zalecane.</span><span class="sxs-lookup"><span data-stu-id="88a89-1247">Setting the **.NET CLR version** to **No Managed Code** is optional but recommended.</span></span>

1. <span data-ttu-id="88a89-1248">*ASP.NET Core 2,2 lub nowsza* : w przypadku [wdrożenia](/dotnet/core/deploying/#self-contained-deployments-scd) z systemem 64-bitowym (x64), które korzysta z [modelu hostingu w procesie](#in-process-hosting-model), wyłączaj pulę aplikacji dla procesów 32-bit (x86).</span><span class="sxs-lookup"><span data-stu-id="88a89-1248">*ASP.NET Core 2.2 or later* : For a 64-bit (x64) [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd) that uses the [in-process hosting model](#in-process-hosting-model), disable the app pool for 32-bit (x86) processes.</span></span>

   <span data-ttu-id="88a89-1249">Na pasku bocznym **Akcje** Menedżera usług IIS > **Pule aplikacji** wybierz pozycję **Ustaw ustawienia domyślne puli aplikacji** lub **Zaawansowane** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1249">In the **Actions** sidebar of IIS Manager > **Application Pools** , select **Set Application Pool Defaults** or **Advanced Settings** .</span></span> <span data-ttu-id="88a89-1250">Znajdź **opcję Włącz aplikacje 32-bitowe** i ustaw wartość na `False` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1250">Locate **Enable 32-Bit Applications** and set the value to `False`.</span></span> <span data-ttu-id="88a89-1251">To ustawienie nie ma wpływu na aplikacje wdrożone na potrzeby [hostingu poza procesem](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span><span class="sxs-lookup"><span data-stu-id="88a89-1251">This setting doesn't affect apps deployed for [out-of-process hosting](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span></span>

1. <span data-ttu-id="88a89-1252">Potwierdź, że tożsamość modelu procesu ma odpowiednie uprawnienia.</span><span class="sxs-lookup"><span data-stu-id="88a89-1252">Confirm the process model identity has the proper permissions.</span></span>

   <span data-ttu-id="88a89-1253">Jeśli domyślna tożsamość puli aplikacji ( **model procesów**  >  **Identity** ) została zmieniona z **ApplicationPool Identity** na inną tożsamość, sprawdź, czy Nowa tożsamość ma wymagane uprawnienia dostępu do folderu, bazy danych i innych wymaganych zasobów aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1253">If the default identity of the app pool ( **Process Model** > **Identity** ) is changed from **ApplicationPoolIdentity** to another identity, verify that the new identity has the required permissions to access the app's folder, database, and other required resources.</span></span> <span data-ttu-id="88a89-1254">Na przykład Pula aplikacji wymaga dostępu do odczytu i zapisu do folderów, w których aplikacja odczytuje i zapisuje pliki.</span><span class="sxs-lookup"><span data-stu-id="88a89-1254">For example, the app pool requires read and write access to folders where the app reads and writes files.</span></span>

<span data-ttu-id="88a89-1255">**Konfiguracja uwierzytelniania systemu Windows (opcjonalnie)**</span><span class="sxs-lookup"><span data-stu-id="88a89-1255">**Windows Authentication configuration (Optional)**</span></span>  
<span data-ttu-id="88a89-1256">Aby uzyskać więcej informacji, zobacz [Konfigurowanie uwierzytelniania systemu Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="88a89-1256">For more information, see [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

## <a name="deploy-the-app"></a><span data-ttu-id="88a89-1257">Wdrażanie aplikacji</span><span class="sxs-lookup"><span data-stu-id="88a89-1257">Deploy the app</span></span>

<span data-ttu-id="88a89-1258">Wdróż aplikację w folderze **ścieżki fizycznej** usług IIS, który został ustanowiony w sekcji [Tworzenie witryny usług IIS](#create-the-iis-site) .</span><span class="sxs-lookup"><span data-stu-id="88a89-1258">Deploy the app to the IIS **Physical path** folder that was established in the [Create the IIS site](#create-the-iis-site) section.</span></span> <span data-ttu-id="88a89-1259">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) jest zalecanym mechanizmem wdrażania, ale istnieje kilka opcji przeniesienia aplikacji z folderu *publikowania* projektu do folderu wdrożenia systemu hostingu.</span><span class="sxs-lookup"><span data-stu-id="88a89-1259">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) is the recommended mechanism for deployment, but several options exist for moving the app from the project's *publish* folder to the hosting system's deployment folder.</span></span>

### <a name="web-deploy-with-visual-studio"></a><span data-ttu-id="88a89-1260">Web Deploy z programem Visual Studio</span><span class="sxs-lookup"><span data-stu-id="88a89-1260">Web Deploy with Visual Studio</span></span>

<span data-ttu-id="88a89-1261">Aby dowiedzieć się, jak utworzyć profil publikowania do użytku z usługą Web Deploy, zobacz temat [Profile publikacji programu Visual Studio dla wdrożenia aplikacji ASP.NET Core](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) .</span><span class="sxs-lookup"><span data-stu-id="88a89-1261">See the [Visual Studio publish profiles for ASP.NET Core app deployment](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) topic to learn how to create a publish profile for use with Web Deploy.</span></span> <span data-ttu-id="88a89-1262">Jeśli dostawca hostingu udostępnia profil publikowania lub obsługę tworzenia aplikacji, pobierz swój profil i zaimportuj go za pomocą okna dialogowego **publikowania** programu Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="88a89-1262">If the hosting provider provides a Publish Profile or support for creating one, download their profile and import it using the Visual Studio **Publish** dialog:</span></span>

![Strona okna dialogowego publikowanie](index/_static/pub-dialog.png)

### <a name="web-deploy-outside-of-visual-studio"></a><span data-ttu-id="88a89-1264">Web Deploy poza programem Visual Studio</span><span class="sxs-lookup"><span data-stu-id="88a89-1264">Web Deploy outside of Visual Studio</span></span>

<span data-ttu-id="88a89-1265">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) można również użyć poza programem Visual Studio z wiersza polecenia.</span><span class="sxs-lookup"><span data-stu-id="88a89-1265">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) can also be used outside of Visual Studio from the command line.</span></span> <span data-ttu-id="88a89-1266">Aby uzyskać więcej informacji, zobacz [Narzędzie do wdrażania w sieci Web](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span><span class="sxs-lookup"><span data-stu-id="88a89-1266">For more information, see [Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span></span>

### <a name="alternatives-to-web-deploy"></a><span data-ttu-id="88a89-1267">Alternatywy dla Web Deploy</span><span class="sxs-lookup"><span data-stu-id="88a89-1267">Alternatives to Web Deploy</span></span>

<span data-ttu-id="88a89-1268">Użyj dowolnej z kilku metod, aby przenieść aplikację do systemu hostingu, takich jak ręczna kopia, [xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy)lub [PowerShell](/powershell/).</span><span class="sxs-lookup"><span data-stu-id="88a89-1268">Use any of several methods to move the app to the hosting system, such as manual copy, [Xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy), or [PowerShell](/powershell/).</span></span>

<span data-ttu-id="88a89-1269">Aby uzyskać więcej informacji na ASP.NET Core wdrażania usług IIS, zobacz sekcję [zasoby wdrażania dla administratorów usług IIS](#deployment-resources-for-iis-administrators) .</span><span class="sxs-lookup"><span data-stu-id="88a89-1269">For more information on ASP.NET Core deployment to IIS, see the [Deployment resources for IIS administrators](#deployment-resources-for-iis-administrators) section.</span></span>

## <a name="browse-the-website"></a><span data-ttu-id="88a89-1270">Przeglądanie witryny sieci Web</span><span class="sxs-lookup"><span data-stu-id="88a89-1270">Browse the website</span></span>

<span data-ttu-id="88a89-1271">Po wdrożeniu aplikacji w systemie hostingu należy wysłać żądanie do jednej z publicznych punktów końcowych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1271">After the app is deployed to the hosting system, make a request to one of the app's public endpoints.</span></span>

<span data-ttu-id="88a89-1272">W poniższym przykładzie lokacja jest powiązana z **nazwą hosta** usług IIS `www.mysite.com` na **porcie** `80` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1272">In the following example, the site is bound to an IIS **Host name** of `www.mysite.com` on **Port** `80`.</span></span> <span data-ttu-id="88a89-1273">Zostanie wysłane żądanie `http://www.mysite.com` :</span><span class="sxs-lookup"><span data-stu-id="88a89-1273">A request is made to `http://www.mysite.com`:</span></span>

![Przeglądarka Microsoft Edge załadowała stronę startową usług IIS.](index/_static/browsewebsite.png)

## <a name="locked-deployment-files"></a><span data-ttu-id="88a89-1275">Zablokowane pliki wdrożenia</span><span class="sxs-lookup"><span data-stu-id="88a89-1275">Locked deployment files</span></span>

<span data-ttu-id="88a89-1276">Pliki w folderze wdrożenia są zablokowane, gdy aplikacja jest uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="88a89-1276">Files in the deployment folder are locked when the app is running.</span></span> <span data-ttu-id="88a89-1277">Nie można zastąpić zablokowanych plików podczas wdrażania.</span><span class="sxs-lookup"><span data-stu-id="88a89-1277">Locked files can't be overwritten during deployment.</span></span> <span data-ttu-id="88a89-1278">Aby zwolnić zablokowane pliki we wdrożeniu, Zatrzymaj pulę aplikacji, korzystając z **jednej** z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="88a89-1278">To release locked files in a deployment, stop the app pool using **one** of the following approaches:</span></span>

* <span data-ttu-id="88a89-1279">Użyj Web Deploy i Reference `Microsoft.NET.Sdk.Web` w pliku projektu.</span><span class="sxs-lookup"><span data-stu-id="88a89-1279">Use Web Deploy and reference `Microsoft.NET.Sdk.Web` in the project file.</span></span> <span data-ttu-id="88a89-1280">Plik *app_offline.htm* jest umieszczony w katalogu głównym katalogu aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="88a89-1280">An *app_offline.htm* file is placed at the root of the web app directory.</span></span> <span data-ttu-id="88a89-1281">Gdy plik jest obecny, moduł ASP.NET Core bezpiecznie zamyka aplikację i obsługuje plik *app_offline.htm* podczas wdrażania.</span><span class="sxs-lookup"><span data-stu-id="88a89-1281">When the file is present, the ASP.NET Core Module gracefully shuts down the app and serves the *app_offline.htm* file during the deployment.</span></span> <span data-ttu-id="88a89-1282">Aby uzyskać więcej informacji, zobacz [Informacje o konfiguracji modułu ASP.NET Core](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span><span class="sxs-lookup"><span data-stu-id="88a89-1282">For more information, see the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span></span>
* <span data-ttu-id="88a89-1283">Ręcznie Zatrzymaj pulę aplikacji w Menedżerze usług IIS na serwerze.</span><span class="sxs-lookup"><span data-stu-id="88a89-1283">Manually stop the app pool in the IIS Manager on the server.</span></span>
* <span data-ttu-id="88a89-1284">Użyj programu PowerShell do porzucenia *app_offline.htm* (wymaga programu PowerShell 5 lub nowszego):</span><span class="sxs-lookup"><span data-stu-id="88a89-1284">Use PowerShell to drop *app_offline.htm* (requires PowerShell 5 or later):</span></span>

  ```powershell
  $pathToApp = 'PATH_TO_APP'

  # Stop the AppPool
  New-Item -Path $pathToApp app_offline.htm

  # Provide script commands here to deploy the app

  # Restart the AppPool
  Remove-Item -Path $pathToApp app_offline.htm

  ```

## <a name="data-protection"></a><span data-ttu-id="88a89-1285">Ochrona danych</span><span class="sxs-lookup"><span data-stu-id="88a89-1285">Data protection</span></span>

<span data-ttu-id="88a89-1286">[Stos ochrony danych ASP.NET Core](xref:security/data-protection/introduction) jest używany przez kilka ASP.NET Core [middlewares](xref:fundamentals/middleware/index), w tym oprogramowanie pośredniczące używane podczas uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="88a89-1286">The [ASP.NET Core Data Protection stack](xref:security/data-protection/introduction) is used by several ASP.NET Core [middlewares](xref:fundamentals/middleware/index), including middleware used in authentication.</span></span> <span data-ttu-id="88a89-1287">Nawet jeśli interfejsy API ochrony danych nie są wywoływane przez kod użytkownika, należy skonfigurować ochronę danych przy użyciu skryptu wdrożenia lub w kodzie użytkownika, aby utworzyć trwały [Magazyn kluczy](xref:security/data-protection/implementation/key-management)kryptograficznych.</span><span class="sxs-lookup"><span data-stu-id="88a89-1287">Even if Data Protection APIs aren't called by user code, data protection should be configured with a deployment script or in user code to create a persistent cryptographic [key store](xref:security/data-protection/implementation/key-management).</span></span> <span data-ttu-id="88a89-1288">Jeśli ochrona danych nie jest skonfigurowana, klucze są przechowywane w pamięci i usuwane po ponownym uruchomieniu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1288">If data protection isn't configured, the keys are held in memory and discarded when the app restarts.</span></span>

<span data-ttu-id="88a89-1289">Jeśli pierścień kluczy jest przechowywany w pamięci po ponownym uruchomieniu aplikacji:</span><span class="sxs-lookup"><span data-stu-id="88a89-1289">If the key ring is stored in memory when the app restarts:</span></span>

* <span data-ttu-id="88a89-1290">cookieTokeny uwierzytelniania na podstawie wszystkich są unieważnione.</span><span class="sxs-lookup"><span data-stu-id="88a89-1290">All cookie-based authentication tokens are invalidated.</span></span> 
* <span data-ttu-id="88a89-1291">Użytkownicy muszą ponownie zalogować się przy następnym żądaniu.</span><span class="sxs-lookup"><span data-stu-id="88a89-1291">Users are required to sign in again on their next request.</span></span> 
* <span data-ttu-id="88a89-1292">Nie można już odszyfrować żadnych danych chronionych za pomocą dzwonka klucza.</span><span class="sxs-lookup"><span data-stu-id="88a89-1292">Any data protected with the key ring can no longer be decrypted.</span></span> <span data-ttu-id="88a89-1293">Może to obejmować [tokeny CSRF](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) i [ASP.NET Core MVC TempData cookie s](xref:fundamentals/app-state#tempdata).</span><span class="sxs-lookup"><span data-stu-id="88a89-1293">This may include [CSRF tokens](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) and [ASP.NET Core MVC TempData cookies](xref:fundamentals/app-state#tempdata).</span></span>

<span data-ttu-id="88a89-1294">Aby skonfigurować ochronę danych w ramach usług IIS w celu utrwalenia pierścienia kluczy, należy użyć **jednej** z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="88a89-1294">To configure data protection under IIS to persist the key ring, use **one** of the following approaches:</span></span>

* <span data-ttu-id="88a89-1295">**Tworzenie kluczy rejestru ochrony danych**</span><span class="sxs-lookup"><span data-stu-id="88a89-1295">**Create Data Protection Registry Keys**</span></span>

  <span data-ttu-id="88a89-1296">Klucze ochrony danych używane przez aplikacje ASP.NET Core są przechowywane w rejestrze zewnętrznym dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1296">Data protection keys used by ASP.NET Core apps are stored in the registry external to the apps.</span></span> <span data-ttu-id="88a89-1297">Aby utrzymać klucze dla danej aplikacji, należy utworzyć klucze rejestru dla puli aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1297">To persist the keys for a given app, create registry keys for the app pool.</span></span>

  <span data-ttu-id="88a89-1298">W przypadku autonomicznych, nieopartych na webfarmie instalacji usług IIS [skrypt ochrony danych Provision-AutoGenKeys.ps1 programu PowerShell](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) może być używany dla każdej puli aplikacji używanej w aplikacji ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-1298">For standalone, non-webfarm IIS installations, the [Data Protection Provision-AutoGenKeys.ps1 PowerShell script](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) can be used for each app pool used with an ASP.NET Core app.</span></span> <span data-ttu-id="88a89-1299">Ten skrypt tworzy klucz rejestru w rejestrze HKLM, który jest dostępny tylko dla konta procesu roboczego puli aplikacji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1299">This script creates a registry key in the HKLM registry that's accessible only to the worker process account of the app's app pool.</span></span> <span data-ttu-id="88a89-1300">Klucze są szyfrowane przy użyciu funkcji DPAPI z kluczem dla całego komputera.</span><span class="sxs-lookup"><span data-stu-id="88a89-1300">Keys are encrypted at rest using DPAPI with a machine-wide key.</span></span>

  <span data-ttu-id="88a89-1301">W scenariuszach farmy sieci Web aplikacja może być skonfigurowana pod kątem używania ścieżki UNC do przechowywania tego dzwonka klucza ochrony danych.</span><span class="sxs-lookup"><span data-stu-id="88a89-1301">In web farm scenarios, an app can be configured to use a UNC path to store its data protection key ring.</span></span> <span data-ttu-id="88a89-1302">Domyślnie klucze ochrony danych nie są szyfrowane.</span><span class="sxs-lookup"><span data-stu-id="88a89-1302">By default, the data protection keys aren't encrypted.</span></span> <span data-ttu-id="88a89-1303">Upewnij się, że uprawnienia do pliku dla udziału sieciowego są ograniczone do konta systemu Windows, w którym jest uruchamiana aplikacja.</span><span class="sxs-lookup"><span data-stu-id="88a89-1303">Ensure that the file permissions for the network share are limited to the Windows account the app runs under.</span></span> <span data-ttu-id="88a89-1304">Certyfikat x509 może służyć do ochrony kluczy w spoczynku.</span><span class="sxs-lookup"><span data-stu-id="88a89-1304">An X509 certificate can be used to protect keys at rest.</span></span> <span data-ttu-id="88a89-1305">Rozważ zastosowanie mechanizmu umożliwiającego użytkownikom przekazywanie certyfikatów: Umieść certyfikaty w zaufanym magazynie certyfikatów użytkownika i upewnij się, że są one dostępne na wszystkich komputerach, na których działa aplikacja użytkownika.</span><span class="sxs-lookup"><span data-stu-id="88a89-1305">Consider a mechanism to allow users to upload certificates: Place certificates into the user's trusted certificate store and ensure they're available on all machines where the user's app runs.</span></span> <span data-ttu-id="88a89-1306">Szczegóły można znaleźć w temacie [Konfigurowanie ochrony danych ASP.NET Core](xref:security/data-protection/configuration/overview) .</span><span class="sxs-lookup"><span data-stu-id="88a89-1306">See [Configure ASP.NET Core Data Protection](xref:security/data-protection/configuration/overview) for details.</span></span>

* <span data-ttu-id="88a89-1307">**Konfigurowanie puli aplikacji usług IIS w celu załadowania profilu użytkownika**</span><span class="sxs-lookup"><span data-stu-id="88a89-1307">**Configure the IIS Application Pool to load the user profile**</span></span>

  <span data-ttu-id="88a89-1308">To ustawienie znajduje się w sekcji **model procesów** w obszarze **Ustawienia zaawansowane** dla puli aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1308">This setting is in the **Process Model** section under the **Advanced Settings** for the app pool.</span></span> <span data-ttu-id="88a89-1309">Ustaw **Załaduj profil użytkownika** na `True` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1309">Set **Load User Profile** to `True`.</span></span> <span data-ttu-id="88a89-1310">Po ustawieniu opcji `True` klucze są przechowywane w katalogu profilu użytkownika i chronione przy użyciu funkcji DPAPI z kluczem specyficznym dla konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="88a89-1310">When set to `True`, keys are stored in the user profile directory and protected using DPAPI with a key specific to the user account.</span></span> <span data-ttu-id="88a89-1311">Klucze są utrwalane w folderze *% LocalAppData%/ASP.NET/dataprotection-Keys* .</span><span class="sxs-lookup"><span data-stu-id="88a89-1311">Keys are persisted to the *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys* folder.</span></span>

  <span data-ttu-id="88a89-1312">[Atrybut setProfileEnvironment](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) puli aplikacji również musi być włączony.</span><span class="sxs-lookup"><span data-stu-id="88a89-1312">The app pool's [setProfileEnvironment attribute](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) must also be enabled.</span></span> <span data-ttu-id="88a89-1313">Wartość domyślna `setProfileEnvironment` to `true` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1313">The default value of `setProfileEnvironment` is `true`.</span></span> <span data-ttu-id="88a89-1314">W niektórych scenariuszach (na przykład system operacyjny Windows) `setProfileEnvironment` jest ustawiony na `false` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1314">In some scenarios (for example, Windows OS), `setProfileEnvironment` is set to `false`.</span></span> <span data-ttu-id="88a89-1315">Jeśli klucze nie są przechowywane w katalogu profilu użytkownika zgodnie z oczekiwaniami:</span><span class="sxs-lookup"><span data-stu-id="88a89-1315">If keys aren't stored in the user profile directory as expected:</span></span>

  1. <span data-ttu-id="88a89-1316">Przejdź do folderu *% windir%/system32/inetsrv/config*</span><span class="sxs-lookup"><span data-stu-id="88a89-1316">Navigate to the *%windir%/system32/inetsrv/config* folder.</span></span>
  1. <span data-ttu-id="88a89-1317">Otwórz plik *applicationHost.config* .</span><span class="sxs-lookup"><span data-stu-id="88a89-1317">Open the *applicationHost.config* file.</span></span>
  1. <span data-ttu-id="88a89-1318">Znajdź `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` element.</span><span class="sxs-lookup"><span data-stu-id="88a89-1318">Locate the `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` element.</span></span>
  1. <span data-ttu-id="88a89-1319">Upewnij się, że `setProfileEnvironment` atrybut nie istnieje, który jest wartością domyślną `true` , lub jawnie ustaw wartość atrybutu na `true` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1319">Confirm that the `setProfileEnvironment` attribute isn't present, which defaults the value to `true`, or explicitly set the attribute's value to `true`.</span></span>

* <span data-ttu-id="88a89-1320">**Używanie systemu plików jako magazynu kluczy**</span><span class="sxs-lookup"><span data-stu-id="88a89-1320">**Use the file system as a key ring store**</span></span>

  <span data-ttu-id="88a89-1321">Dostosuj kod aplikacji, [tak aby używał systemu plików jako magazynu kluczy](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="88a89-1321">Adjust the app code to [use the file system as a key ring store](xref:security/data-protection/configuration/overview).</span></span> <span data-ttu-id="88a89-1322">Użyj certyfikatu x509 do ochrony pierścienia kluczy i upewnij się, że certyfikat jest certyfikatem zaufanym.</span><span class="sxs-lookup"><span data-stu-id="88a89-1322">Use an X509 certificate to protect the key ring and ensure the certificate is a trusted certificate.</span></span> <span data-ttu-id="88a89-1323">Jeśli certyfikat jest podpisany z podpisem własnym, umieść certyfikat w zaufanym magazynie głównym.</span><span class="sxs-lookup"><span data-stu-id="88a89-1323">If the certificate is self-signed, place the certificate in the Trusted Root store.</span></span>

  <span data-ttu-id="88a89-1324">W przypadku korzystania z usług IIS w kolektywie serwerów sieci Web:</span><span class="sxs-lookup"><span data-stu-id="88a89-1324">When using IIS in a web farm:</span></span>

  * <span data-ttu-id="88a89-1325">Użyj udziału plików, do którego mają dostęp wszystkie maszyny.</span><span class="sxs-lookup"><span data-stu-id="88a89-1325">Use a file share that all machines can access.</span></span>
  * <span data-ttu-id="88a89-1326">Wdróż certyfikat x509 na każdym komputerze.</span><span class="sxs-lookup"><span data-stu-id="88a89-1326">Deploy an X509 certificate to each machine.</span></span> <span data-ttu-id="88a89-1327">Konfigurowanie [ochrony danych w kodzie](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="88a89-1327">Configure [data protection in code](xref:security/data-protection/configuration/overview).</span></span>

* <span data-ttu-id="88a89-1328">**Ustawianie zasad dla całej maszyny na potrzeby ochrony danych**</span><span class="sxs-lookup"><span data-stu-id="88a89-1328">**Set a machine-wide policy for data protection**</span></span>

  <span data-ttu-id="88a89-1329">System ochrony danych ma ograniczoną obsługę ustawiania domyślnych [zasad komputera](xref:security/data-protection/configuration/machine-wide-policy) dla wszystkich aplikacji korzystających z interfejsów API ochrony danych.</span><span class="sxs-lookup"><span data-stu-id="88a89-1329">The data protection system has limited support for setting a default [machine-wide policy](xref:security/data-protection/configuration/machine-wide-policy) for all apps that consume the Data Protection APIs.</span></span> <span data-ttu-id="88a89-1330">Aby uzyskać więcej informacji, zobacz <xref:security/data-protection/introduction>.</span><span class="sxs-lookup"><span data-stu-id="88a89-1330">For more information, see <xref:security/data-protection/introduction>.</span></span>

## <a name="virtual-directories"></a><span data-ttu-id="88a89-1331">Katalogi wirtualne</span><span class="sxs-lookup"><span data-stu-id="88a89-1331">Virtual Directories</span></span>

<span data-ttu-id="88a89-1332">[Katalogi wirtualne usług IIS](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) nie są obsługiwane w aplikacjach ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-1332">[IIS Virtual Directories](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) aren't supported with ASP.NET Core apps.</span></span> <span data-ttu-id="88a89-1333">Aplikacja może być hostowana jako [podaplikacja](#sub-applications).</span><span class="sxs-lookup"><span data-stu-id="88a89-1333">An app can be hosted as a [sub-application](#sub-applications).</span></span>

## <a name="sub-applications"></a><span data-ttu-id="88a89-1334">Aplikacje podrzędne</span><span class="sxs-lookup"><span data-stu-id="88a89-1334">Sub-applications</span></span>

<span data-ttu-id="88a89-1335">Aplikacja ASP.NET Core może być hostowana jako [podaplikacja usług IIS (podrzędna)](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span><span class="sxs-lookup"><span data-stu-id="88a89-1335">An ASP.NET Core app can be hosted as an [IIS sub-application (sub-app)](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span></span> <span data-ttu-id="88a89-1336">Ścieżka aplikacji podrzędnej jest częścią adresu URL aplikacji głównej.</span><span class="sxs-lookup"><span data-stu-id="88a89-1336">The sub-app's path becomes part of the root app's URL.</span></span>

<span data-ttu-id="88a89-1337">Aplikacja podrzędna nie powinna zawierać modułu ASP.NET Core jako programu obsługi.</span><span class="sxs-lookup"><span data-stu-id="88a89-1337">A sub-app shouldn't include the ASP.NET Core Module as a handler.</span></span> <span data-ttu-id="88a89-1338">Jeśli moduł zostanie dodany jako program obsługi w pliku *web.config* aplikacji podrzędnej, *wystąpi błąd wewnętrzny serwera 500,19* odwołujący się do uszkodzonego pliku konfiguracji podczas próby przeglądania aplikacji podrzędnej.</span><span class="sxs-lookup"><span data-stu-id="88a89-1338">If the module is added as a handler in a sub-app's *web.config* file, a *500.19 Internal Server Error* referencing the faulty config file is received when attempting to browse the sub-app.</span></span>

<span data-ttu-id="88a89-1339">Poniższy przykład przedstawia opublikowany plik *web.config* dla ASP.NET Core aplikacji podrzędnej:</span><span class="sxs-lookup"><span data-stu-id="88a89-1339">The following example shows a published *web.config* file for an ASP.NET Core sub-app:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <aspNetCore processPath="dotnet" 
      arguments=".\MyApp.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

<span data-ttu-id="88a89-1340">W przypadku hostowania aplikacji podrzędnej non-ASP.NET Core w aplikacji ASP.NET Core jawnie Usuń dziedziczoną procedurę obsługi w pliku *web.config* aplikacji podrzędnej:</span><span class="sxs-lookup"><span data-stu-id="88a89-1340">When hosting a non-ASP.NET Core sub-app underneath an ASP.NET Core app, explicitly remove the inherited handler in the sub-app's *web.config* file:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <handlers>
      <remove name="aspNetCore" />
    </handlers>
    <aspNetCore processPath="dotnet" 
      arguments=".\MyApp.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

<span data-ttu-id="88a89-1341">Linki do zasobów statycznych w aplikacji podrzędnej powinny używać notacji z ukośnikiem ( `~/` ).</span><span class="sxs-lookup"><span data-stu-id="88a89-1341">Static asset links within the sub-app should use tilde-slash (`~/`) notation.</span></span> <span data-ttu-id="88a89-1342">Notacja "ukośnik" wyzwala [pomocnika tagów](xref:mvc/views/tag-helpers/intro) , aby dołączyć pathbase podaplikacji do renderowanego linku względnego.</span><span class="sxs-lookup"><span data-stu-id="88a89-1342">Tilde-slash notation triggers a [Tag Helper](xref:mvc/views/tag-helpers/intro) to prepend the sub-app's pathbase to the rendered relative link.</span></span> <span data-ttu-id="88a89-1343">W przypadku aplikacji podrzędnej w `/subapp_path` programie obraz połączony z programem `src="~/image.png"` jest renderowany jako `src="/subapp_path/image.png"` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1343">For a sub-app at `/subapp_path`, an image linked with `src="~/image.png"` is rendered as `src="/subapp_path/image.png"`.</span></span> <span data-ttu-id="88a89-1344">Oprogramowanie pośredniczące aplikacji głównej nie przetwarza żądania pliku statycznego.</span><span class="sxs-lookup"><span data-stu-id="88a89-1344">The root app's Static File Middleware doesn't process the static file request.</span></span> <span data-ttu-id="88a89-1345">Żądanie jest przetwarzane przez oprogramowanie pośredniczące plików statycznych aplikacji podrzędnej.</span><span class="sxs-lookup"><span data-stu-id="88a89-1345">The request is processed by the sub-app's Static File Middleware.</span></span>

<span data-ttu-id="88a89-1346">Jeśli atrybut statycznego zasobu `src` jest ustawiony na ścieżkę bezwzględną (na przykład `src="/image.png"` ), link jest renderowany bez pathbase podaplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1346">If a static asset's `src` attribute is set to an absolute path (for example, `src="/image.png"`), the link is rendered without the sub-app's pathbase.</span></span> <span data-ttu-id="88a89-1347">Oprogramowanie pośredniczące pliku statycznego aplikacji głównej próbuje obsłużyć zasób z poziomu [głównego katalogu sieci Web](xref:fundamentals/index#web-root)aplikacji głównej, co spowoduje, że odpowiedź na *404 nie zostanie znaleziona* , chyba że statyczny zasób jest dostępny z poziomu aplikacji głównej.</span><span class="sxs-lookup"><span data-stu-id="88a89-1347">The root app's Static File Middleware attempts to serve the asset from the root app's [web root](xref:fundamentals/index#web-root), which results in a *404 - Not Found* response unless the static asset is available from the root app.</span></span>

<span data-ttu-id="88a89-1348">Aby hostować aplikację ASP.NET Core jako aplikację podrzędną w innej aplikacji ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="88a89-1348">To host an ASP.NET Core app as a sub-app under another ASP.NET Core app:</span></span>

1. <span data-ttu-id="88a89-1349">Ustanów pulę aplikacji dla aplikacji podrzędnej.</span><span class="sxs-lookup"><span data-stu-id="88a89-1349">Establish an app pool for the sub-app.</span></span> <span data-ttu-id="88a89-1350">Ustaw **wersję środowiska .NET CLR** na **Brak kodu zarządzanego** , ponieważ podstawowe środowisko uruchomieniowe języka wspólnego (CoreCLR) dla platformy .NET Core jest uruchomione w celu hostowania aplikacji w procesie roboczym, a nie na pulpicie CLR (.NET CLR).</span><span class="sxs-lookup"><span data-stu-id="88a89-1350">Set the **.NET CLR Version** to **No Managed Code** because the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process, not the desktop CLR (.NET CLR).</span></span>

1. <span data-ttu-id="88a89-1351">Dodaj lokację główną w Menedżerze usług IIS przy użyciu aplikacji podrzędnej w folderze w lokacji głównej.</span><span class="sxs-lookup"><span data-stu-id="88a89-1351">Add the root site in IIS Manager with the sub-app in a folder under the root site.</span></span>

1. <span data-ttu-id="88a89-1352">Kliknij prawym przyciskiem myszy folder subapp w Menedżerze usług IIS, a następnie wybierz polecenie **Konwertuj na aplikację** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1352">Right-click the sub-app folder in IIS Manager and select **Convert to Application** .</span></span>

1. <span data-ttu-id="88a89-1353">W oknie dialogowym **Dodawanie aplikacji** Użyj przycisku **Wybierz** dla **puli aplikacji** , aby przypisać pulę aplikacji utworzoną dla aplikacji podrzędnej.</span><span class="sxs-lookup"><span data-stu-id="88a89-1353">In the **Add Application** dialog, use the **Select** button for the **Application Pool** to assign the app pool that you created for the sub-app.</span></span> <span data-ttu-id="88a89-1354">Wybierz pozycję **OK** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1354">Select **OK** .</span></span>

<span data-ttu-id="88a89-1355">Przypisanie oddzielnej puli aplikacji do aplikacji podrzędnej jest wymagane w przypadku korzystania z modelu hostingu w procesie.</span><span class="sxs-lookup"><span data-stu-id="88a89-1355">The assignment of a separate app pool to the sub-app is a requirement when using the in-process hosting model.</span></span>

<span data-ttu-id="88a89-1356">Aby uzyskać więcej informacji na temat modelu hostingu w procesie i konfigurowania modułu ASP.NET Core, zobacz <xref:host-and-deploy/aspnet-core-module> .</span><span class="sxs-lookup"><span data-stu-id="88a89-1356">For more information on the in-process hosting model and configuring the ASP.NET Core Module, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

## <a name="configuration-of-iis-with-webconfig"></a><span data-ttu-id="88a89-1357">Konfiguracja usług IIS z web.config</span><span class="sxs-lookup"><span data-stu-id="88a89-1357">Configuration of IIS with web.config</span></span>

<span data-ttu-id="88a89-1358">Na konfigurację usług IIS wpływa `<system.webServer>` sekcja *web.config* dla scenariuszy usług IIS, które są funkcjonalne dla ASP.NET Core aplikacji za pomocą modułu ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-1358">IIS configuration is influenced by the `<system.webServer>` section of *web.config* for IIS scenarios that are functional for ASP.NET Core apps with the ASP.NET Core Module.</span></span> <span data-ttu-id="88a89-1359">Na przykład konfiguracja usług IIS jest funkcjonalna dla kompresji dynamicznej.</span><span class="sxs-lookup"><span data-stu-id="88a89-1359">For example, IIS configuration is functional for dynamic compression.</span></span> <span data-ttu-id="88a89-1360">Jeśli usługi IIS są skonfigurowane na poziomie serwera do korzystania z kompresji dynamicznej, `<urlCompression>` element w pliku *web.config* aplikacji może go wyłączyć dla aplikacji ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="88a89-1360">If IIS is configured at the server level to use dynamic compression, the `<urlCompression>` element in the app's *web.config* file can disable it for an ASP.NET Core app.</span></span>

<span data-ttu-id="88a89-1361">Aby uzyskać więcej informacji, zobacz następujące tematy:</span><span class="sxs-lookup"><span data-stu-id="88a89-1361">For more information, see the following topics:</span></span>

* [<span data-ttu-id="88a89-1362">Dokumentacja konfiguracyjna programu \<system.webServer></span><span class="sxs-lookup"><span data-stu-id="88a89-1362">Configuration reference for \<system.webServer></span></span>](/iis/configuration/system.webServer/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/iis/modules>

<span data-ttu-id="88a89-1363">Aby ustawić zmienne środowiskowe dla poszczególnych aplikacji działających w pulach izolowanych aplikacji (obsługiwanych w przypadku usług IIS 10,0 lub nowszych), zobacz sekcję *polecenieAppCmd.exe* w temacie [ \<environmentVariables> zmienne środowiskowe](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) w dokumentacji dotyczącej usług IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1363">To set environment variables for individual apps running in isolated app pools (supported for IIS 10.0 or later), see the *AppCmd.exe command* section of the [Environment Variables \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) topic in the IIS reference documentation.</span></span>

## <a name="configuration-sections-of-webconfig"></a><span data-ttu-id="88a89-1364">Sekcje konfiguracji web.config</span><span class="sxs-lookup"><span data-stu-id="88a89-1364">Configuration sections of web.config</span></span>

<span data-ttu-id="88a89-1365">Sekcje konfiguracyjne aplikacji ASP.NET 4. x w *web.config* nie są używane przez aplikacje ASP.NET Core do konfiguracji:</span><span class="sxs-lookup"><span data-stu-id="88a89-1365">Configuration sections of ASP.NET 4.x apps in *web.config* aren't used by ASP.NET Core apps for configuration:</span></span>

* `<system.web>`
* `<appSettings>`
* `<connectionStrings>`
* `<location>`

<span data-ttu-id="88a89-1366">Aplikacje ASP.NET Core są konfigurowane przy użyciu innych dostawców konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1366">ASP.NET Core apps are configured using other configuration providers.</span></span> <span data-ttu-id="88a89-1367">Aby uzyskać więcej informacji, zobacz [Konfiguracja](xref:fundamentals/configuration/index).</span><span class="sxs-lookup"><span data-stu-id="88a89-1367">For more information, see [Configuration](xref:fundamentals/configuration/index).</span></span>

## <a name="application-pools"></a><span data-ttu-id="88a89-1368">Pule aplikacji</span><span class="sxs-lookup"><span data-stu-id="88a89-1368">Application Pools</span></span>

<span data-ttu-id="88a89-1369">W przypadku hostowania wielu witryn sieci Web na serwerze zalecamy odizolowanie aplikacji od siebie, uruchamiając każdą aplikację w jej własnej puli aplikacji.</span><span class="sxs-lookup"><span data-stu-id="88a89-1369">When hosting multiple websites on a server, we recommend isolating the apps from each other by running each app in its own app pool.</span></span> <span data-ttu-id="88a89-1370">W oknie dialogowym **Dodaj witrynę sieci Web** programu IIS domyślnie zostanie wydana konfiguracja.</span><span class="sxs-lookup"><span data-stu-id="88a89-1370">The IIS **Add Website** dialog defaults to this configuration.</span></span> <span data-ttu-id="88a89-1371">Po podaniu **nazwy witryny** tekst zostanie automatycznie przeniesiony do pola tekstowego **Pula aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1371">When a **Site name** is provided, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="88a89-1372">Nowa pula aplikacji jest tworzona przy użyciu nazwy lokacji, gdy zostanie dodana lokacja.</span><span class="sxs-lookup"><span data-stu-id="88a89-1372">A new app pool is created using the site name when the site is added.</span></span>

## <a name="application-pool-no-locidentity"></a><span data-ttu-id="88a89-1373">Pula aplikacji Identity</span><span class="sxs-lookup"><span data-stu-id="88a89-1373">Application Pool Identity</span></span>

<span data-ttu-id="88a89-1374">Konto tożsamości puli aplikacji umożliwia uruchamianie aplikacji na unikatowym koncie bez konieczności tworzenia domen ani kont lokalnych oraz zarządzania nimi.</span><span class="sxs-lookup"><span data-stu-id="88a89-1374">An app pool identity account allows an app to run under a unique account without having to create and manage domains or local accounts.</span></span> <span data-ttu-id="88a89-1375">W przypadku usług IIS 8,0 lub nowszych proces roboczy administratora usług IIS tworzy konto wirtualne o nazwie nowej puli aplikacji i domyślnie uruchamia procesy robocze puli aplikacji w ramach tego konta.</span><span class="sxs-lookup"><span data-stu-id="88a89-1375">On IIS 8.0 or later, the IIS Admin Worker Process (WAS) creates a virtual account with the name of the new app pool and runs the app pool's worker processes under this account by default.</span></span> <span data-ttu-id="88a89-1376">W konsoli zarządzania usługami IIS w obszarze **Ustawienia zaawansowane** dla puli aplikacji upewnij się, że **Identity** ustawiono opcję Użyj **ApplicationPool Identity** :</span><span class="sxs-lookup"><span data-stu-id="88a89-1376">In the IIS Management Console under **Advanced Settings** for the app pool, ensure that the **Identity** is set to use **ApplicationPoolIdentity** :</span></span>

![Okno dialogowe Zaawansowane ustawienia puli aplikacji](index/_static/apppool-identity.png)

<span data-ttu-id="88a89-1378">Proces zarządzania usługami IIS tworzy Bezpieczny identyfikator z nazwą puli aplikacji w systemie zabezpieczeń systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="88a89-1378">The IIS management process creates a secure identifier with the name of the app pool in the Windows Security System.</span></span> <span data-ttu-id="88a89-1379">Zasoby mogą być zabezpieczone przy użyciu tej tożsamości.</span><span class="sxs-lookup"><span data-stu-id="88a89-1379">Resources can be secured using this identity.</span></span> <span data-ttu-id="88a89-1380">Jednak ta tożsamość nie jest kontem użytkownika rzeczywistego i nie jest wyświetlana w konsoli zarządzania użytkownikami systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="88a89-1380">However, this identity isn't a real user account and doesn't show up in the Windows User Management Console.</span></span>

<span data-ttu-id="88a89-1381">Jeśli proces roboczy usług IIS wymaga podwyższonego poziomu dostępu do aplikacji, Zmodyfikuj listę Access Control (ACL) dla katalogu zawierającego aplikację:</span><span class="sxs-lookup"><span data-stu-id="88a89-1381">If the IIS worker process requires elevated access to the app, modify the Access Control List (ACL) for the directory containing the app:</span></span>

1. <span data-ttu-id="88a89-1382">Otwórz Eksploratora Windows i przejdź do katalogu.</span><span class="sxs-lookup"><span data-stu-id="88a89-1382">Open Windows Explorer and navigate to the directory.</span></span>

1. <span data-ttu-id="88a89-1383">Kliknij prawym przyciskiem myszy katalog i wybierz polecenie **Właściwości** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1383">Right-click on the directory and select **Properties** .</span></span>

1. <span data-ttu-id="88a89-1384">Na karcie **zabezpieczenia** wybierz przycisk **Edytuj** , a następnie przycisk **Dodaj** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1384">Under the **Security** tab, select the **Edit** button and then the **Add** button.</span></span>

1. <span data-ttu-id="88a89-1385">Wybierz przycisk **lokalizacje** i upewnij się, że wybrano system.</span><span class="sxs-lookup"><span data-stu-id="88a89-1385">Select the **Locations** button and make sure the system is selected.</span></span>

1. <span data-ttu-id="88a89-1386">Wprowadź **<usług IIS puli aplikacji \\ app_pool_name>** w polu **Wprowadź nazwy obiektów do wybrania** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1386">Enter **IIS AppPool\\<app_pool_name>** in **Enter the object names to select** area.</span></span> <span data-ttu-id="88a89-1387">Wybierz przycisk **Sprawdź nazwy** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1387">Select the **Check Names** button.</span></span> <span data-ttu-id="88a89-1388">W obszarze *Domyślna pula aplikacji* Sprawdź nazwy za pomocą **usług IIS AppPool\DefaultAppPool** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1388">For the *DefaultAppPool* check the names using **IIS AppPool\DefaultAppPool** .</span></span> <span data-ttu-id="88a89-1389">Po wybraniu przycisku **Sprawdź nazwy** w obszarze nazwy obiektów zostanie wykazana wartość **Domyślna pula aplikacji** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1389">When the **Check Names** button is selected, a value of **DefaultAppPool** is indicated in the object names area.</span></span> <span data-ttu-id="88a89-1390">Nie można wprowadzić nazwy puli aplikacji bezpośrednio w obszarze nazw obiektów.</span><span class="sxs-lookup"><span data-stu-id="88a89-1390">It isn't possible to enter the app pool name directly into the object names area.</span></span> <span data-ttu-id="88a89-1391">Podczas sprawdzania nazwy obiektu Użyj **<IIS puli aplikacji \\ app_pool_name>** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1391">Use the **IIS AppPool\\<app_pool_name>** format when checking for the object name.</span></span>

   ![Okno dialogowe Wybieranie użytkowników lub grup dla folderu aplikacji: Nazwa puli aplikacji "domyślna pula" jest dołączana do "puli aplikacji IIS \" w obszarze nazw obiektów przed wybraniem pozycji" Sprawdź nazwy ".](index/_static/select-users-or-groups-1.png)

1. <span data-ttu-id="88a89-1393">Wybierz pozycję **OK** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1393">Select **OK** .</span></span>

   ![Okno dialogowe Wybieranie użytkowników lub grup dla folderu aplikacji: po wybraniu pozycji "Sprawdź nazwy" w obszarze nazwy obiektów zostanie wyświetlona nazwa obiektu "domyślna pula aplikacji".](index/_static/select-users-or-groups-2.png)

1. <span data-ttu-id="88a89-1395">&amp;Uprawnienia do wykonywania odczytu powinny być przyznawane domyślnie.</span><span class="sxs-lookup"><span data-stu-id="88a89-1395">Read &amp; execute permissions should be granted by default.</span></span> <span data-ttu-id="88a89-1396">Podaj dodatkowe uprawnienia zgodnie z wymaganiami.</span><span class="sxs-lookup"><span data-stu-id="88a89-1396">Provide additional permissions as needed.</span></span>

<span data-ttu-id="88a89-1397">Dostęp można także udzielić w wierszu polecenia przy użyciu narzędzia **icacls** .</span><span class="sxs-lookup"><span data-stu-id="88a89-1397">Access can also be granted at a command prompt using the **ICACLS** tool.</span></span> <span data-ttu-id="88a89-1398">Użycie funkcji *Domyślna pula aplikacji* jako przykładu powoduje użycie następującego polecenia:</span><span class="sxs-lookup"><span data-stu-id="88a89-1398">Using the *DefaultAppPool* as an example, the following command is used:</span></span>

```console
ICACLS C:\sites\MyWebApp /grant "IIS AppPool\DefaultAppPool":F
```

<span data-ttu-id="88a89-1399">Aby uzyskać więcej informacji, zobacz temat [icacls](/windows-server/administration/windows-commands/icacls) .</span><span class="sxs-lookup"><span data-stu-id="88a89-1399">For more information, see the [icacls](/windows-server/administration/windows-commands/icacls) topic.</span></span>

## <a name="http2-support"></a><span data-ttu-id="88a89-1400">Obsługa protokołu HTTP/2</span><span class="sxs-lookup"><span data-stu-id="88a89-1400">HTTP/2 support</span></span>

<span data-ttu-id="88a89-1401">Obsługa [protokołu HTTP/2](https://httpwg.org/specs/rfc7540.html) jest obsługiwana w przypadku wdrożeń pozaprocesowych, które spełniają następujące wymagania podstawowe:</span><span class="sxs-lookup"><span data-stu-id="88a89-1401">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is supported for out-of-process deployments that meet the following base requirements:</span></span>

* <span data-ttu-id="88a89-1402">Windows Server 2016/Windows 10 lub nowszy; Program IIS 10 lub nowszy</span><span class="sxs-lookup"><span data-stu-id="88a89-1402">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
* <span data-ttu-id="88a89-1403">Połączenia z serwerem granicznym dostępnym publicznie korzystają z protokołu HTTP/2, ale połączenie zwrotnego serwera proxy z [serwerem Kestrel](xref:fundamentals/servers/kestrel) korzysta z protokołu HTTP/1.1.</span><span class="sxs-lookup"><span data-stu-id="88a89-1403">Public-facing edge server connections use HTTP/2, but the reverse proxy connection to the [Kestrel server](xref:fundamentals/servers/kestrel) uses HTTP/1.1.</span></span>
* <span data-ttu-id="88a89-1404">Struktura docelowa: nie dotyczy wdrożeń poza procesem, ponieważ połączenie HTTP/2 jest obsługiwane całkowicie przez usługi IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1404">Target framework: Not applicable to out-of-process deployments, since the HTTP/2 connection is handled entirely by IIS.</span></span>
* <span data-ttu-id="88a89-1405">Połączenie TLS 1,2 lub nowsze</span><span class="sxs-lookup"><span data-stu-id="88a89-1405">TLS 1.2 or later connection</span></span>

<span data-ttu-id="88a89-1406">W przypadku nawiązania połączenia HTTP/2 raporty [HttpRequest. Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) `HTTP/1.1` .</span><span class="sxs-lookup"><span data-stu-id="88a89-1406">If an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/1.1`.</span></span>

<span data-ttu-id="88a89-1407">Protokół HTTP/2 jest domyślnie włączony.</span><span class="sxs-lookup"><span data-stu-id="88a89-1407">HTTP/2 is enabled by default.</span></span> <span data-ttu-id="88a89-1408">Połączenia powracają do protokołu HTTP/1.1, jeśli połączenie HTTP/2 nie zostało ustanowione.</span><span class="sxs-lookup"><span data-stu-id="88a89-1408">Connections fall back to HTTP/1.1 if an HTTP/2 connection isn't established.</span></span> <span data-ttu-id="88a89-1409">Aby uzyskać więcej informacji na temat konfiguracji protokołu HTTP/2 z wdrożeniami usług IIS, zobacz [http/2 w usługach IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span><span class="sxs-lookup"><span data-stu-id="88a89-1409">For more information on HTTP/2 configuration with IIS deployments, see [HTTP/2 on IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span></span>

## <a name="cors-preflight-requests"></a><span data-ttu-id="88a89-1410">Żądania inspekcji wstępnej CORS</span><span class="sxs-lookup"><span data-stu-id="88a89-1410">CORS preflight requests</span></span>

<span data-ttu-id="88a89-1411">*Ta sekcja dotyczy tylko ASP.NET Core aplikacji przeznaczonych dla .NET Framework.*</span><span class="sxs-lookup"><span data-stu-id="88a89-1411">*This section only applies to ASP.NET Core apps that target the .NET Framework.*</span></span>

<span data-ttu-id="88a89-1412">W przypadku aplikacji ASP.NET Core, która jest przeznaczona dla .NET Framework, żądania opcji nie są domyślnie przesyłane do aplikacji w usługach IIS.</span><span class="sxs-lookup"><span data-stu-id="88a89-1412">For an ASP.NET Core app that targets the .NET Framework, OPTIONS requests aren't passed to the app by default in IIS.</span></span> <span data-ttu-id="88a89-1413">Aby dowiedzieć się, jak skonfigurować obsługę usług IIS w *web.config* , aby przekazywać żądania dotyczące opcji, zobacz [Włączanie żądań między źródłami w ASP.NET Web API 2: jak działa mechanizm CORS](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span><span class="sxs-lookup"><span data-stu-id="88a89-1413">To learn how to configure the app's IIS handlers in *web.config* to pass OPTIONS requests, see [Enable cross-origin requests in ASP.NET Web API 2: How CORS Works](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span></span>

## <a name="deployment-resources-for-iis-administrators"></a><span data-ttu-id="88a89-1414">Zasoby wdrażania dla administratorów usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-1414">Deployment resources for IIS administrators</span></span>

* [<span data-ttu-id="88a89-1415">Dokumentacja usług IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-1415">IIS documentation</span></span>](/iis)
* [<span data-ttu-id="88a89-1416">Wprowadzenie z menedżerem usług IIS w usługach IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-1416">Getting Started with the IIS Manager in IIS</span></span>](/iis/get-started/getting-started-with-iis/getting-started-with-the-iis-manager-in-iis-7-and-iis-8)
* [<span data-ttu-id="88a89-1417">Wdrażanie aplikacji .NET Core</span><span class="sxs-lookup"><span data-stu-id="88a89-1417">.NET Core application deployment</span></span>](/dotnet/core/deploying/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/directory-structure>
* <xref:host-and-deploy/iis/modules>
* <xref:test/troubleshoot-azure-iis>
* <xref:host-and-deploy/azure-iis-errors-reference>

## <a name="additional-resources"></a><span data-ttu-id="88a89-1418">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="88a89-1418">Additional resources</span></span>

* <xref:test/troubleshoot>
* <xref:index>
* [<span data-ttu-id="88a89-1419">Oficjalna witryna programu Microsoft IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-1419">The Official Microsoft IIS Site</span></span>](https://www.iis.net/)
* [<span data-ttu-id="88a89-1420">Biblioteka zawartości technicznej systemu Windows Server</span><span class="sxs-lookup"><span data-stu-id="88a89-1420">Windows Server technical content library</span></span>](/windows-server/windows-server)
* [<span data-ttu-id="88a89-1421">Protokół HTTP/2 w usługach IIS</span><span class="sxs-lookup"><span data-stu-id="88a89-1421">HTTP/2 on IIS</span></span>](/iis/get-started/whats-new-in-iis-10/http2-on-iis)
* <xref:host-and-deploy/iis/transform-webconfig>

::: moniker-end
